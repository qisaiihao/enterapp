(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-favorite-content-favorite-content"],{"07ea":function(r,t,n){"use strict";n.r(t);var e=n("8e1d"),a=n.n(e);for(var i in e)["default"].indexOf(i)<0&&function(r){n.d(t,r,(function(){return e[r]}))}(i);t["default"]=a.a},2774:function(r,t,n){n("01a2"),n("e39c"),n("bf0f"),n("844d"),n("18f7"),n("de6c"),n("08eb"),r.exports=function(r){if("undefined"!==typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)},r.exports.__esModule=!0,r.exports["default"]=r.exports},4550:function(r,t,n){n("6a54");var e=n("8bcf");r.exports=function(r,t,n){return t=e(t),t in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r},r.exports.__esModule=!0,r.exports["default"]=r.exports},"4c62":function(r,t,n){var e=n("c86c");t=e(!1),t.push([r.i,'\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* pages/favorite-content/favorite-content.wxss */.container[data-v-27b21ce8]{padding:%?20?%;background-color:#f7f8fa;min-height:100vh}.loading-container[data-v-27b21ce8]{display:flex;justify-content:center;align-items:center;height:%?400?%;background-color:#fff;border-radius:%?16?%;margin:%?30?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05)}.loading-text[data-v-27b21ce8]{color:#999;font-size:%?28?%}.favorites-container[data-v-27b21ce8]{margin:0 %?30?% %?30?% %?30?%}\r\n/* 新增：帖子项包装器样式 */.post-item-wrapper[data-v-27b21ce8]{background:#fff;border-radius:%?16?%;margin-bottom:%?20?%;padding:%?30?%;box-shadow:0 %?2?% %?12?% rgba(0,0,0,.06)}\r\n/* 原创帖子特殊样式 */.post-item-wrapper.original-post[data-v-27b21ce8]{border:%?3?% solid #ebc88d;box-shadow:0 %?4?% %?20?% rgba(235,200,141,.3),0 %?2?% %?12?% rgba(0,0,0,.06);position:relative}\r\n/* 原创帖子光影效果 */.post-item-wrapper.original-post[data-v-27b21ce8]::before{content:"";position:absolute;top:%?-2?%;left:%?-2?%;right:%?-2?%;bottom:%?-2?%;background:linear-gradient(45deg,#ebc88d,#f4d03f,#ebc88d);border-radius:%?18?%;z-index:-1;opacity:.6;-webkit-filter:blur(%?8?%);filter:blur(%?8?%)}\r\n/* 新增：内容导航器样式 */.post-content-navigator[data-v-27b21ce8]{display:block;background:transparent}\r\n/* 新增：导航器点击效果 */.navigator-hover[data-v-27b21ce8]{opacity:.8}\r\n/* 作者信息样式 */.author-info-outside[data-v-27b21ce8]{display:flex;align-items:center;margin-bottom:%?20?%}.author-avatar[data-v-27b21ce8]{width:%?60?%;height:%?60?%;border-radius:50%;margin-right:%?15?%;background-color:#f5f5f5}.author-name[data-v-27b21ce8]{font-size:%?28?%;color:#333;font-weight:500}.post-title[data-v-27b21ce8]{font-size:%?32?%;font-weight:700;color:#333;margin-bottom:%?10?%;line-height:1.4;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}\r\n/* 诗歌作者信息 */.poem-author[data-v-27b21ce8]{font-size:%?26?%;color:#666;font-style:italic;margin-bottom:%?10?%}.post-content[data-v-27b21ce8]{font-size:%?26?%;color:#666;line-height:1.5;margin-bottom:%?15?%;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;white-space:pre-wrap}\r\n/* 图片容器样式 - 与首页保持一致 */.image-container-wrapper[data-v-27b21ce8]{position:relative;width:100%;background-color:#f0f0f0; /* 占位时的背景色，很重要 */overflow:hidden;border-radius:8px; /* 可以加个圆角，让占位块更好看 */margin:%?20?% 0 /* 图片和下方内容的间距 */}\r\n/* 让图片或Swiper填充整个占位容器 */.image-container-wrapper .post-image[data-v-27b21ce8],\r\n.image-container-wrapper .image-swiper[data-v-27b21ce8]{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.post-image[data-v-27b21ce8]{transition:-webkit-transform .3s ease;transition:transform .3s ease;transition:transform .3s ease,-webkit-transform .3s ease}.post-image[data-v-27b21ce8]:active{-webkit-transform:scale(1.05);transform:scale(1.05)}.image-swiper[data-v-27b21ce8]{width:100%;border-radius:%?12?%;overflow:hidden}\r\n/* 标签样式 - 与首页和详情页保持一致 */.post-tags[data-v-27b21ce8]{margin-top:%?30?%;margin-bottom:%?10?%;line-height:1.5}.post-tag[data-v-27b21ce8]{color:#24375f;font-size:%?26?%;margin-right:%?10?%;transition:all .2s ease;cursor:pointer}.post-tag[data-v-27b21ce8]:active{color:#1a2a4a;opacity:.8}\r\n/* 删除/操作按钮区域 */.delete-section[data-v-27b21ce8]{display:flex;justify-content:space-between;align-items:center;margin-top:%?20?%;padding-top:%?20?%;border-top:%?1?% solid #f0f0f0}.time-left[data-v-27b21ce8]{flex:1}.favorite-time[data-v-27b21ce8]{font-size:%?24?%;color:#999}.button-group[data-v-27b21ce8]{display:flex;gap:%?10?%}.remove-favorite-btn[data-v-27b21ce8]{background:#ff4757;color:#fff;border:none;border-radius:%?8?%;font-size:%?24?%;padding:%?8?% %?16?%}.remove-favorite-btn[data-v-27b21ce8]:active{background:#ff3742}\r\n/* 加载更多样式 */.loading-more[data-v-27b21ce8]{display:flex;justify-content:center;align-items:center;padding:%?30?%;color:#999;font-size:%?28?%}.no-more[data-v-27b21ce8]{display:flex;justify-content:center;align-items:center;padding:%?30?%;color:#999;font-size:%?28?%}\r\n/* 空状态样式 */.empty-container[data-v-27b21ce8]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:%?100?% %?30?%;text-align:center}.empty-icon[data-v-27b21ce8]{font-size:%?80?%;margin-bottom:%?20?%;opacity:.5}.empty-text[data-v-27b21ce8]{font-size:%?32?%;color:#666;margin-bottom:%?10?%}.empty-subtext[data-v-27b21ce8]{font-size:%?26?%;color:#999}',""]),r.exports=t},5014:function(r,t,n){n("dc8a"),n("01a2"),n("8f71"),n("bf0f"),n("9a2c"),n("aa9c"),n("2797"),n("a644"),n("a03a"),n("6a54");var e=n("4550");function a(r,t){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.push.apply(n,e)}return n}r.exports=function(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){e(r,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(n,t))}))}return r},r.exports.__esModule=!0,r.exports["default"]=r.exports},"56c9":function(r,t,n){n("9e15"),n("884b"),n("01a2"),n("e39c"),n("bf0f"),n("7a76"),n("c9b5"),n("64aa");var e=n("bdbb")["default"];r.exports=function(r,t){if("object"!==e(r)||null===r)return r;var n=r[Symbol.toPrimitive];if(void 0!==n){var a=n.call(r,t||"default");if("object"!==e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(r)},r.exports.__esModule=!0,r.exports["default"]=r.exports},"73da":function(r,t,n){"use strict";n.r(t);var e=n("78f5"),a=n("07ea");for(var i in a)["default"].indexOf(i)<0&&function(r){n.d(t,r,(function(){return a[r]}))}(i);n("b744");var o=n("828b"),s=Object(o["a"])(a["default"],e["b"],e["c"],!1,null,"27b21ce8",null,!1,e["a"],void 0);t["default"]=s.exports},"73e1":function(r,t,n){"use strict";var e=n("29d8");r.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(e)},"78f5":function(r,t,n){"use strict";n.d(t,"b",(function(){return e})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var e=function(){var r=this,t=r.$createElement,n=r._self._c||t;return n("v-uni-view",{staticClass:"container"},[r.favorites.length>0?n("v-uni-view",{staticClass:"favorites-container"},r._l(r.favorites,(function(t,e){return n("v-uni-view",{key:e,class:"post-item-wrapper "+(t.isOriginal?"original-post":"")},[n("v-uni-view",{staticClass:"author-info-outside"},[t.postAuthorAvatar?n("v-uni-image",{staticClass:"author-avatar",attrs:{src:t.postAuthorAvatar,mode:"aspectFill","data-postindex":e,"data-user-id":t.postAuthorOpenid},on:{error:function(t){arguments[0]=t=r.$handleEvent(t),r.onAvatarError.apply(void 0,arguments)},load:function(t){arguments[0]=t=r.$handleEvent(t),r.onAvatarLoad.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=r.$handleEvent(t),r.navigateToUserProfile.apply(void 0,arguments)}}}):r._e(),n("v-uni-text",{staticClass:"author-name"},[r._v(r._s(t.postAuthorName))])],1),n("v-uni-navigator",{staticClass:"post-content-navigator",attrs:{url:"/pages/post-detail/post-detail?id="+t.postId,"hover-class":"navigator-hover"}},[n("v-uni-view",{staticClass:"post-item"},[n("v-uni-view",{staticClass:"post-title"},[r._v(r._s(t.postTitle))]),t.postIsPoem&&t.postAuthor?n("v-uni-view",{staticClass:"poem-author"},[r._v(r._s(t.postAuthor))]):r._e(),t.imageUrls&&t.imageUrls.length>0?n("v-uni-view",{staticClass:"image-container-wrapper",style:t.imageStyle,attrs:{"data-src":t.imageUrls[0],"data-original-image-urls":t.originalImageUrls||t.imageUrls},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=r.$handleEvent(t),r.handlePreview.apply(void 0,arguments)}}},[1===t.imageUrls.length?[n("v-uni-image",{staticClass:"post-image",attrs:{id:"single-image-"+t.postId,src:t.imageUrls[0],mode:"aspectFill","lazy-load":!0,"data-postid":t.postId,"data-postindex":e,"data-imgindex":"0","data-type":"single"},on:{error:function(t){arguments[0]=t=r.$handleEvent(t),r.onImageError.apply(void 0,arguments)},load:function(t){arguments[0]=t=r.$handleEvent(t),r.onImageLoad.apply(void 0,arguments)}}})]:t.imageUrls.length>1?[n("v-uni-swiper",{staticClass:"image-swiper",style:"height: "+(r.swiperHeights[e]?r.swiperHeights[e]+"px":"220px")+";",attrs:{id:"swiper-"+t.postId,"indicator-dots":!0,circular:!0}},[r._l(t.imageUrls,(function(a,i){return[n("v-uni-swiper-item",[n("v-uni-image",{staticClass:"post-image",attrs:{src:a,mode:"aspectFill","lazy-load":!0,"data-src":a,"data-original-image-urls":t.originalImageUrls||t.imageUrls,"data-postid":t.postId,"data-postindex":e,"data-imgindex":i,"data-type":"multi"},on:{error:function(t){arguments[0]=t=r.$handleEvent(t),r.onImageError.apply(void 0,arguments)},load:function(t){arguments[0]=t=r.$handleEvent(t),r.onImageLoad.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=r.$handleEvent(t),r.handlePreview.apply(void 0,arguments)}}})],1)]}))],2)]:r._e()],2):r._e(),t.postContent?n("v-uni-view",{staticClass:"post-content",staticStyle:{"white-space":"pre-wrap"}},[r._v(r._s(t.postContent))]):r._e(),t.postTags&&t.postTags.length>0?n("v-uni-view",{staticClass:"post-tags"},r._l(t.postTags,(function(t,e){return n("v-uni-text",{key:e,staticClass:"post-tag",attrs:{"data-tag":t},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=r.$handleEvent(t),r.onTagClick.apply(void 0,arguments)}}},[r._v("#"+r._s(t))])})),1):r._e()],1)],1),n("v-uni-view",{staticClass:"delete-section"},[n("v-uni-view",{staticClass:"time-left"},[n("v-uni-text",{staticClass:"favorite-time"},[r._v("收藏于 "+r._s(t.formattedCreateTime||"未知时间"))])],1),n("v-uni-view",{staticClass:"button-group"},[n("v-uni-button",{staticClass:"remove-favorite-btn",attrs:{size:"mini","data-favorite-id":t._id,"data-index":e},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=r.$handleEvent(t),r.removeFavorite.apply(void 0,arguments)}}},[r._v("取消收藏")])],1)],1)],1)})),1):n("v-uni-view",{staticClass:"empty-container"},[n("v-uni-view",{staticClass:"empty-icon"},[r._v("📖")]),n("v-uni-view",{staticClass:"empty-text"},[r._v("收藏夹是空的")]),n("v-uni-view",{staticClass:"empty-subtext"},[r._v("去发现一些好诗收藏起来吧")]),n("v-uni-button",{staticStyle:{"margin-top":"20rpx",padding:"15rpx 30rpx",background:"#9ed7ee",color:"white","border-radius":"8rpx","font-size":"26rpx"},on:{click:function(t){arguments[0]=t=r.$handleEvent(t),r.manualLoad.apply(void 0,arguments)}}},[r._v("刷新")])],1),r.favorites.length>0&&!r.hasMore&&!r.isLoading?n("v-uni-view",{staticClass:"no-more"},[n("v-uni-text",[r._v("没有更多了")])],1):r._e()],1)},a=[]},"795c":function(r,t,n){"use strict";var e=n("8bdb"),a=n("db04").start,i=n("73e1");e({target:"String",proto:!0,forced:i},{padStart:function(r){return a(this,r,arguments.length>1?arguments[1]:void 0)}})},"81f6":function(r,t,n){var e=n("5014").default,a=n("d189").default,i=n("4cf1").default;n("8f71"),n("bf0f"),n("aa9c"),n("fd3c");var o=n("962f"),s=o.formatRelativeTime,l=["createTime","postCreateTime","publishTime","createdAt","updateTime"],c=function(r){return r?Array.isArray(r)?r.filter(Boolean):[r].filter(Boolean):[]},u=function(r){var t,n=i(l);try{for(n.s();!(t=n.n()).done;){var e=t.value;if(r[e])return{key:e,value:r[e]}}}catch(a){n.e(a)}finally{n.f()}return null},d=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.withTime,i=void 0===n||n,o=c(r.imageUrls);0===o.length&&o.push.apply(o,a(c(r.imageUrl)));var l=c(r.originalImageUrls);0===l.length&&l.push.apply(l,a(c(r.originalImageUrl))),0===l.length&&o.length>0&&l.push.apply(l,a(o));var d=e(e({},r),{},{imageUrls:o,originalImageUrls:l,authorName:r.authorName||"匿名用户",authorAvatar:"string"===typeof r.authorAvatar?r.authorAvatar:""});if(!d.imageStyle&&o.length>0&&(d.imageStyle="height: 0; padding-bottom: 75%;"),i)if(r.formattedCreateTime)d.formattedCreateTime=r.formattedCreateTime;else{var f=u(r);f&&(d.formattedCreateTime=s(f.value))}return d};r.exports={normalizePost:d,normalizePostList:function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Array.isArray(r)?r.map((function(r){return d(r,t)})):[]}}},"86c6":function(r,t,n){var e=n("4c62");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[r.i,e,""]]),e.locals&&(r.exports=e.locals);var a=n("967d").default;a("358e8dcb",e,!0,{sourceMap:!1,shadowMode:!1})},"8bcf":function(r,t,n){var e=n("bdbb")["default"],a=n("56c9");r.exports=function(r){var t=a(r,"string");return"symbol"===e(t)?t:String(t)},r.exports.__esModule=!0,r.exports["default"]=r.exports},"8e1d":function(r,t,n){"use strict";n("6a54");var e=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("7a76"),n("c9b5"),n("bf0f"),n("18f7"),n("de6c"),n("fd3c"),n("c223"),n("8f71");var a=e(n("2634")),i=e(n("9b1b")),o=e(n("2fdc")),s=n("962f"),l=s.formatRelativeTime,c=n("edf3"),u=c.previewImage,d=n("38db"),f=d.cloudCall,p=n("9c8b"),g=n("d6e5"),v=n("81f6"),m=v.normalizePostList,h={mixins:[g,p],data:function(){return{folderId:"",folderName:"",favorites:[],pageSize:10,swiperHeights:{},imageClampHeights:{},imgindex:0,img:""}},onLoad:function(r){var t=r.folderId,n=r.folderName||"";if(t){var e=n;try{e=decodeURIComponent(n||"")}catch(a){console.log("CatchClause",a),console.log("CatchClause",a),e=n}this.setData({folderId:t,folderName:e,favorites:[]}),uni.setNavigationBarTitle({title:e||"收藏夹"}),this.initPagination(this.loadFavorites,{pageSize:this.pageSize})}else uni.showToast({title:"参数错误：收藏夹ID为空",icon:"none"})},onShow:function(){},methods:{callCloudFunction:function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return f(r,t,Object.assign({pageTag:"favorite-content",context:this,requireAuth:!0},n))},loadFavorites:function(r){var t=this;return(0,o.default)((0,a.default)().mark((function n(){var e,o,s,l,c,u,d,f,p,g,v;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e=r.page,o=r.isRefresh,t.folderId){n.next=6;break}throw s=new Error("参数错误：收藏夹ID为空"),s.__toastShown=!0,uni.showToast({title:"参数错误：收藏夹ID为空",icon:"none"}),s;case 6:return o&&t.setData({favorites:[],swiperHeights:{},imageClampHeights:{}}),l=e*t.pageSize,1e4,c=null,u=new Promise((function(r,t){c=setTimeout((function(){var r=new Error("加载超时，请重试");r.code="LOAD_TIMEOUT",r.__toastShown=!0,uni.showToast({title:"加载超时，请重试",icon:"none"}),t(r)}),1e4)})),n.prev=11,n.next=14,Promise.race([t.callCloudFunction("getMyProfileData",{action:"getFavoritesByFolder",folderId:t.folderId,skip:l,limit:t.pageSize}),u]);case 14:if(d=n.sent,c&&clearTimeout(c),console.log("云函数调用成功，返回结果:",d),d.result&&!0===d.result.success){n.next=23;break}throw f=d.result&&d.result.message||"加载失败",uni.showToast({title:f,icon:"none"}),p=new Error(f),p.__toastShown=!0,p;case 23:return g=m(d.result.favorites||[]).map((function(r,n){var e=(0,i.default)({},r);return!e.formattedCreateTime&&e.createTime&&(e.formattedCreateTime=t.formatTime(e.createTime)),e.postCreateTime&&!e.formattedPostCreateTime&&(e.formattedPostCreateTime=t.formatTime(e.postCreateTime)),e.favoriteTime&&!e.formattedFavoriteTime&&(e.formattedFavoriteTime=t.formatTime(e.favoriteTime)),!e.postTitle&&e.title&&(e.postTitle=e.title),!e.postContent&&e.content&&(e.postContent=e.content),!e.postImageUrls&&e.imageUrls&&(e.postImageUrls=e.imageUrls),!e.postOriginalImageUrls&&e.originalImageUrls&&(e.postOriginalImageUrls=e.originalImageUrls),!e.postAuthorAvatar&&e.authorAvatar&&(e.postAuthorAvatar=e.authorAvatar),!e.postAuthorName&&e.authorName&&(e.postAuthorName=e.authorName),!e.imageStyle&&e.imageUrls&&e.imageUrls.length>0&&(e.imageStyle="height: 0; padding-bottom: 75%;"),console.log("【收藏夹】帖子".concat(n,"图片数据:"),{postId:e._id,postTitle:e.title||e.postTitle,imageUrls:e.imageUrls,originalImageUrls:e.originalImageUrls,hasImageUrls:!!(e.imageUrls&&e.imageUrls.length>0)}),e})),v=0===e||o?g:t.favorites.concat(g),t.setData({favorites:v}),n.abrupt("return",{list:g,hasMore:g.length===t.pageSize});case 29:throw n.prev=29,n.t0=n["catch"](11),c&&clearTimeout(c),console.error("加载收藏数据失败:",n.t0),n.t0&&n.t0.__toastShown||uni.showToast({title:"网络错误",icon:"none"}),n.t0;case 35:return n.prev=35,c&&clearTimeout(c),n.finish(35);case 38:case"end":return n.stop()}}),n,null,[[11,29,35,38]])})))()},manualLoad:function(){this.folderId?this.refresh():uni.showToast({title:"收藏夹ID为空",icon:"none"})},onFavoriteTap:function(r){var t=r.currentTarget.dataset.postId;uni.navigateTo({url:"/pages/post-detail/post-detail?id=".concat(t)})},onFavoriteLongPress:function(r){var t=this,n=r.currentTarget.dataset.favoriteId,e=r.currentTarget.dataset.postTitle;uni.showActionSheet({itemList:["取消收藏"],success:function(r){0===r.tapIndex&&t.removeFavorite(n,e)}})},removeFavorite:function(r){var t=this,n=r.currentTarget.dataset.favoriteId,e=r.currentTarget.dataset.index,a=this.favorites[e],i=a?a.postTitle:"未知标题";uni.showModal({title:"确认取消收藏",content:'确定要取消收藏"'.concat(i,'"吗？'),success:function(r){r.confirm&&(uni.showLoading({title:"处理中..."}),t.callCloudFunction("getMyProfileData",{action:"removeFromFavorite",favoriteId:n}).then((function(r){if(uni.hideLoading(),r.result&&r.result.success){uni.showToast({title:"取消收藏成功"});var e=t.favorites.filter((function(r){return r._id!==n}));t.setData({favorites:e})}else uni.showToast({title:r.result.message||"操作失败",icon:"none"})})).catch((function(r){uni.hideLoading(),console.error("取消收藏失败:",r),uni.showToast({title:"网络错误",icon:"none"})})))}})},onImagePreview:function(r){return u(r,{fallbackToast:!1})},handlePreview:function(r){var t=u(r,{fallbackToast:!1});return t||uni.showToast({title:"图片加载失败",icon:"none"}),t},onImageError:function(r){console.error("【收藏夹】图片加载失败",r);var t=r.detail.src;console.error("【收藏夹】失败的图片URL:",t);var n=r.currentTarget.dataset,e=n.postindex,a=n.imgindex;if(void 0!==e&&void 0!==a){var i=this.favorites[e];console.error("【收藏夹】图片加载失败的上下文:",{postId:i?i._id:"unknown",postTitle:i?i.title:"unknown",imageIndex:a,imageUrl:t,allImageUrls:i?i.imageUrls:"unknown"})}console.error("【收藏夹】图片加载失败详情:",{error:r.detail,src:t,dataset:r.currentTarget.dataset})},formatTime:function(r){return l(r)},onAvatarError:function(r){console.error("头像加载失败:",r);var t=r.currentTarget.dataset.postindex;if(void 0!==t){var n=this.favorites;n[t]&&(n[t].postAuthorAvatar="/images/avatar.png",this.setData({favorites:n}))}},onAvatarLoad:function(r){},navigateToUserProfile:function(r){var t=r.currentTarget.dataset.userId;t&&uni.navigateTo({url:"/pages/user-profile/user-profile?userId=".concat(t)})},onTagClick:function(r){var t=r.currentTarget.dataset.tag;t&&uni.navigateTo({url:"/pages/search/search?keyword=".concat(encodeURIComponent(t))})}}};t.default=h},9376:function(r,t,n){n("7a76"),n("c9b5"),r.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},r.exports.__esModule=!0,r.exports["default"]=r.exports},"962f":function(r,t,n){n("795c"),n("64aa"),n("5c47"),n("a1c1"),n("c223"),n("f7a5");var e=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(r).padStart(t,"0")},a=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd HH:mm:ss",n=r instanceof Date?r:new Date(r);if(Number.isNaN(n.getTime()))return"";var a={yyyy:String(n.getFullYear()),MM:e(n.getMonth()+1),dd:e(n.getDate()),HH:e(n.getHours()),mm:e(n.getMinutes()),ss:e(n.getSeconds())};return t.replace(/yyyy|MM|dd|HH|mm|ss/g,(function(r){return a[r]}))};r.exports={formatTimeAgo:function(r){var t=new Date,n=new Date(r),e=t.getTime()-n.getTime(),a=Math.floor(e/1e3),i=Math.floor(a/60),o=Math.floor(i/60),s=Math.floor(o/24);if(s>=7){var l=n.getFullYear(),c=("0"+(n.getMonth()+1)).slice(-2),u=("0"+n.getDate()).slice(-2);return"".concat(l,"-").concat(c,"-").concat(u)}return s>=1?"".concat(s,"天前"):o>=1?"".concat(o,"小时前"):i>=1?"".concat(i,"分钟前"):"刚刚"},formatRelativeTime:function(r){var t=Date.now(),n=r instanceof Date?r.getTime():new Date(r).getTime();if(Number.isNaN(n))return"";var e=t-n,i=Math.floor(Math.abs(e)/1e3),o=e>=0?"前":"后";if(i<60)return"刚刚";var s=Math.floor(i/60);if(s<60)return"".concat(s,"分钟").concat(o);var l=Math.floor(s/60);if(l<24)return"".concat(l,"小时").concat(o);var c=Math.floor(l/24);return c<7?"".concat(c,"天").concat(o):a(n,"yyyy-MM-dd")},formatDate:a}},"9c8b":function(r,t,n){var e=n("bdbb").default,a=n("4550").default;n("5c47"),n("a1c1"),n("c223"),n("64aa");function i(r){return"undefined"===typeof uni||"function"!==typeof uni.createSelectorQuery?null:uni.createSelectorQuery().in(r)}function o(r,t,n){if("function"!==typeof r.setData){for(var i=t.replace(/\[(.*?)\]/g,".$1").replace(/^\./,""),o=i.split("."),s=r,l=0;l<o.length-1;l+=1){var c=o[l];s[c]&&"object"===e(s[c])||(s[c]={}),s=s[c]}s[o[o.length-1]]=n}else r.setData(a({},t,n))}r.exports={data:function(){return{__galleryImageMeta:{}}},created:function(){"undefined"===typeof this.swiperHeights&&(this.swiperHeights={}),"undefined"===typeof this.imageClampHeights&&(this.imageClampHeights={}),"undefined"===typeof this.imageCache&&(this.imageCache={})},methods:{onImageLoad:function(r){if(r&&r.detail&&r.currentTarget){var t=r.currentTarget.dataset||{},n=r.detail,e=n.width,a=n.height;if(e&&a){var i=function(r){return void 0!==r.galleryKey&&null!==r.galleryKey?r.galleryKey:void 0!==r.postindex&&null!==r.postindex?r.postindex:void 0!==r.postIndex&&null!==r.postIndex?r.postIndex:void 0!==r.index&&null!==r.index?r.index:void 0!==r.postid&&null!==r.postid?r.postid:void 0!==r.postId&&null!==r.postId?r.postId:void 0!==r.imgindex?"gallery-".concat(r.imgindex):"gallery"}(t),o="undefined"!==typeof t.imgindex?t.imgindex:t.imgIndex||0,s=t.type||t.imageType||"single",l="".concat(i,"_").concat(o);this.__galleryImageMeta&&(this.__galleryImageMeta[l]={width:e,height:a}),this.imageCache&&(this.imageCache[l]={width:e,height:a});var c=Number(this.galleryMinImageRatio)||9/16,u=Number(this.galleryMaxImageRatio)||16/9;if("multi"===s&&0===Number(o)){var d=t.swiperSelector||t.gallerySelector||"#swiper-".concat(i);this.__updateSwiperHeight({key:i,selector:d,originalWidth:e,originalHeight:a,minRatio:c,maxRatio:u})}if("single"===s){var f=t.singleSelector||t.imageSelector||"#single-image-".concat(i);this.__updateClampHeight({key:i,selector:f,originalWidth:e,originalHeight:a,minRatio:c})}}}},__updateSwiperHeight:function(r){var t=this,n=r.key,e=r.selector,a=r.originalWidth,s=r.originalHeight,l=r.minRatio,c=r.maxRatio;if(e){var u=i(this);u&&u.select(e).boundingClientRect((function(r){if(r&&r.width){var e=a/s,i=function(r,t,n){return r>n?n:r<t?t:r}(e,l,c),u=r.width/i;o(t,"swiperHeights[".concat(n,"]"),u)}})).exec()}},__updateClampHeight:function(r){var t=this,n=r.key,e=r.selector,a=r.originalWidth,s=r.originalHeight,l=r.minRatio,c=a/s;if(!(c>=l)){var u=e?i(this):null;if(e&&u)u.select(e).boundingClientRect((function(r){if(r&&r.width){var e=r.width/l;o(t,"imageClampHeights.".concat(n),e)}})).exec();else if(this.galleryFallbackWidth){var d=this.galleryFallbackWidth/l;o(this,"imageClampHeights.".concat(n),d)}}}}}},b744:function(r,t,n){"use strict";var e=n("86c6"),a=n.n(e);a.a},d189:function(r,t,n){var e=n("e2db"),a=n("2774"),i=n("79b7"),o=n("9376");r.exports=function(r){return e(r)||a(r)||i(r)||o()},r.exports.__esModule=!0,r.exports["default"]=r.exports},d6e5:function(r,t,n){var e=n("dd7e").default,a=n("46c5").default,i=n("bdbb").default,o=n("5014").default;n("dc8a"),n("bf0f"),n("2797"),n("7a76"),n("c9b5");var s={page:0,hasMore:!0,isLoading:!1,isLoadingMore:!1},l=Object.keys(s);function c(r){return r.__paginationState||(r.__paginationState=o({},s)),"object"!==i(r.pagination)||null===r.pagination?r.pagination=o({},s):r.pagination=o(o({},s),r.pagination),l.forEach((function(t){"undefined"===typeof r[t]&&(r[t]=s[t])})),r.__paginationState}function u(r,t){var n=c(r);Object.assign(n,t),function(r,t){if(t&&"object"===i(t)){var n={};if(l.forEach((function(e){Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e],r.pagination&&"object"===i(r.pagination)&&(r.pagination[e]=t[e]),r[e]=t[e])})),"function"===typeof r.setData){var e={};return Object.keys(n).forEach((function(r){e[r]=n[r],e["pagination.".concat(r)]=n[r]})),void r.setData(e)}Object.assign(r,n)}}(r,t)}function d(r,t,n){var e=n.pageSize,a=n.isRefresh,i=n.fallback;if(t&&"boolean"===typeof t.hasMore)return t.hasMore;var o=r.__paginationConfig||{};if("function"===typeof o.computeHasMore)try{var s=o.computeHasMore.call(r,t,{page:r.__paginationState.page,pageSize:e,isRefresh:a});if("boolean"===typeof s)return s}catch(l){console.warn("[pagination] computeHasMore 执行失败",l)}return t&&Array.isArray(t.list)?"number"===typeof e?t.list.length>=e:t.list.length>0:t&&Array.isArray(t.items)?"number"===typeof e?t.items.length>=e:t.items.length>0:"boolean"!==typeof i||i}function f(r){return p.apply(this,arguments)}function p(){return p=a(e().mark((function r(t){var n,a,i,o,s,l,f,p,g,v,m,h,b,y,w=arguments;return e().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=w.length>1&&void 0!==w[1]?w[1]:{},a=n.isRefresh,i=n.extra,o=void 0===i?{}:i,s=n.fromPullDown,l=void 0!==s&&s,f=t.__paginationConfig,f&&"function"===typeof f.loader){r.next=5;break}return console.warn("[pagination] 尚未通过 initPagination 注册加载函数"),r.abrupt("return",null);case 5:if(c(t),p=t.__paginationState,a||!1!==p.hasMore){r.next=9;break}return r.abrupt("return",null);case 9:if(!p.isLoading&&!p.isLoadingMore){r.next=11;break}return r.abrupt("return",null);case 11:return g=a?0:p.page,v=0===g,u(t,{isLoading:v,isLoadingMore:!v}),m={page:g,pageSize:f.pageSize,isRefresh:a,isFirstPage:v,extra:o},r.prev=15,"function"===typeof f.beforeLoad&&f.beforeLoad.call(t,m),r.next=19,f.loader.call(t,m);case 19:h=r.sent,b=g+1,y=d(t,h,{pageSize:f.pageSize,isRefresh:a,fallback:!!a||p.hasMore}),u(t,{page:b,hasMore:y}),"function"===typeof f.afterLoad&&f.afterLoad.call(t,h,m),r.next=30;break;case 26:throw r.prev=26,r.t0=r["catch"](15),"function"===typeof f.onError?f.onError.call(t,r.t0,m):console.error("[pagination] 加载数据失败",r.t0),r.t0;case 30:if(r.prev=30,u(t,{isLoading:!1,isLoadingMore:!1}),a&&!1!==f.autoStopPullDown&&l&&"undefined"!==typeof uni&&"function"===typeof uni.stopPullDownRefresh)try{uni.stopPullDownRefresh()}catch(e){console.warn("[pagination] stopPullDownRefresh 调用失败",e)}return r.finish(30);case 34:return r.abrupt("return",h);case 35:case"end":return r.stop()}}),r,null,[[15,26,30,34]])}))),p.apply(this,arguments)}r.exports={data:function(){return o({pagination:o({},s)},s)},created:function(){c(this)},onReachBottom:function(){this.__paginationConfig&&this.loadNext().catch((function(){}))},onPullDownRefresh:function(){this.__paginationConfig&&this.refresh({fromPullDown:!0}).catch((function(){}))},methods:{initPagination:function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!==typeof r)throw new TypeError("[pagination] initPagination 需要传入函数类型的 loader");var n=t.pageSize,e=void 0===n?10:n,a=t.immediate,i=void 0===a||a,l=t.autoStopPullDown,c=void 0===l||l,d=t.computeHasMore,f=t.beforeLoad,p=t.afterLoad,g=t.onError;return this.__paginationConfig={loader:r,pageSize:e,immediate:i,autoStopPullDown:c,computeHasMore:d,beforeLoad:f,afterLoad:p,onError:g},u(this,o({},s)),i?this.refresh({fromPullDown:!1}):Promise.resolve()},refresh:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c(this),u(this,{page:0,hasMore:!0}),f(this,o({isRefresh:!0},r))},loadNext:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f(this,o({isRefresh:!1},r))},getPaginationState:function(){return c(this),o({},this.__paginationState)}}}},db04:function(r,t,n){"use strict";var e=n("bb80"),a=n("c435"),i=n("9e70"),o=n("f298"),s=n("862c"),l=e(o),c=e("".slice),u=Math.ceil,d=function(r){return function(t,n,e){var o,d,f=i(s(t)),p=a(n),g=f.length,v=void 0===e?" ":i(e);return p<=g||""===v?f:(o=p-g,d=l(v,u(o/v.length)),d.length>o&&(d=c(d,0,o)),r?f+d:d+f)}};r.exports={start:d(!1),end:d(!0)}},e2db:function(r,t,n){var e=n("e476");r.exports=function(r){if(Array.isArray(r))return e(r)},r.exports.__esModule=!0,r.exports["default"]=r.exports},edf3:function(r,t,n){function e(r){if(!r)return{current:"",urls:[]};if(r.currentTarget&&r.currentTarget.dataset){var t=r.currentTarget.dataset,n=t.src||t.current||t.url||Array.isArray(t.urls)&&t.urls[0]||"",e=t.originalImageUrls||t.urls||t.urlList,a=Array.isArray(e)?e.filter(Boolean):"string"===typeof e&&e?[e]:[];return{current:n,urls:a}}var i=r.current||r.src||Array.isArray(r.urls)&&r.urls[0]||Array.isArray(r.list)&&r.list[0]||"",o=Array.isArray(r.urls)?r.urls.filter(Boolean):Array.isArray(r.list)?r.list.filter(Boolean):[];return{current:i,urls:o}}function a(r){"undefined"!==typeof uni&&uni.showToast&&uni.showToast({title:r,icon:"none"})}n("8f71"),n("bf0f"),r.exports={previewImage:function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.fallbackToast,i=void 0===n||n,o=e(r);if(!o.current&&0===o.urls.length)return i&&a("图片数据缺失"),!1;var s=o.urls.length?o.urls:[o.current],l=o.current||s[0];return l&&0!==s.length?uni.previewImage({current:l,urls:s}):(i&&a("图片不可预览"),!1)}}}}]);