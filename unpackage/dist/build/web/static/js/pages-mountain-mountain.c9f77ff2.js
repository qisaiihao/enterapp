(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-mountain-mountain"],{3675:function(n,e,t){"use strict";t.r(e);var o=t("c7c4"),r=t("6ccc");for(var a in r)["default"].indexOf(a)<0&&function(n){t.d(e,n,(function(){return r[n]}))}(a);t("613d");var i=t("828b"),s=Object(i["a"])(r["default"],o["b"],o["c"],!1,null,"6d52ec14",null,!1,o["a"],void 0);e["default"]=s.exports},"44f3":function(n,e,t){"use strict";t.r(e);var o=t("8066"),r=t.n(o);for(var a in o)["default"].indexOf(a)<0&&function(n){t.d(e,n,(function(){return o[n]}))}(a);e["default"]=r.a},"613d":function(n,e,t){"use strict";var o=t("a107"),r=t.n(o);r.a},"6ccc":function(n,e,t){"use strict";t.r(e);var o=t("84aa"),r=t.n(o);for(var a in o)["default"].indexOf(a)<0&&function(n){t.d(e,n,(function(){return o[n]}))}(a);e["default"]=r.a},"7a2f":function(n,e,t){var o=t("c86c");e=o(!1),e.push([n.i,"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* components/folder-selector/folder-selector.wxss */.modal-overlay[data-v-3a05c372]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[data-v-3a05c372]{background:#fff;border-radius:%?16?%;margin:%?40?%;width:calc(100% - %?80?%);max-width:%?600?%;max-height:80vh;display:flex;flex-direction:column}.modal-header[data-v-3a05c372]{display:flex;align-items:center;justify-content:space-between;padding:%?30?% %?40?%;border-bottom:%?1?% solid #f0f0f0}.modal-title[data-v-3a05c372]{font-size:%?36?%;font-weight:500;color:#333}.close-btn[data-v-3a05c372]{font-size:%?48?%;color:#999;line-height:1;position:relative;z-index:1001}.modal-body[data-v-3a05c372]{flex:1;padding:%?20?% 0;max-height:60vh;overflow-y:auto}.loading-container[data-v-3a05c372]{display:flex;justify-content:center;align-items:center;height:%?200?%}.loading-text[data-v-3a05c372]{color:#999;font-size:%?28?%}.folders-list[data-v-3a05c372]{padding:0 %?40?%}.folder-item[data-v-3a05c372]{display:flex;align-items:center;padding:%?24?% 0;border-bottom:%?1?% solid #f8f8f8}.folder-item[data-v-3a05c372]:last-child{border-bottom:none}.folder-item.selected[data-v-3a05c372]{background:rgba(7,193,96,.1);border-radius:%?8?%;padding:%?24?% %?20?%;margin:0 %?-20?%}.folder-icon[data-v-3a05c372]{font-size:%?40?%;margin-right:%?20?%}.folder-info[data-v-3a05c372]{flex:1}.folder-name[data-v-3a05c372]{font-size:%?30?%;color:#333;font-weight:500;margin-bottom:%?4?%}.folder-count[data-v-3a05c372]{font-size:%?24?%;color:#999}.selected-icon[data-v-3a05c372]{font-size:%?32?%;color:#9ed7ee;font-weight:700}.empty-state[data-v-3a05c372]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:%?200?%;padding:%?40?%}.empty-icon[data-v-3a05c372]{font-size:%?60?%;margin-bottom:%?16?%;opacity:.5}.empty-text[data-v-3a05c372]{font-size:%?28?%;color:#666;margin-bottom:%?8?%}.empty-subtext[data-v-3a05c372]{font-size:%?24?%;color:#999}.modal-footer[data-v-3a05c372]{display:flex;gap:%?20?%;padding:%?30?% %?40?%;border-top:%?1?% solid #f0f0f0}.modal-btn[data-v-3a05c372]{flex:1;height:%?80?%;border-radius:%?8?%;font-size:%?28?%;border:none;display:flex;align-items:center;justify-content:center;position:relative;z-index:1001}.secondary-btn[data-v-3a05c372]{background:#f5f5f5;color:#666}.primary-btn[data-v-3a05c372]{background:#9ed7ee;color:#fff}.primary-btn[data-v-3a05c372]:disabled{background:#ccc;color:#999}\r\n/* åˆ›å»ºæ”¶è—å¤¹å¼¹çª—æ ·å¼ */.create-modal .modal-body[data-v-3a05c372]{padding:%?40?%}.folder-name-input[data-v-3a05c372]{width:100%;height:%?80?%;padding:0 %?20?%;border:%?2?% solid #e0e0e0;border-radius:%?8?%;font-size:%?30?%;box-sizing:border-box}.folder-name-input[data-v-3a05c372]:focus{border-color:#9ed7ee}",""]),n.exports=e},8066:function(n,e,t){"use strict";t("6a54");var o=t("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t("bf0f"),t("0c26");var r=o(t("39d8")),a=t("38db"),i=a.cloudCall,s={data:function(){return{folders:[],isLoading:!0,selectedFolderId:"",showCreateModal:!1,newFolderName:"",showClone:!1}},props:{show:{type:Boolean,default:!1},postId:{type:String,default:""}},watch:(0,r.default)({show:function(n){n&&this.loadFolders()}},"show",{handler:function(n,e){this.showClone=n},immediate:!0}),methods:{callCloudFunction:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(n,e,Object.assign({pageTag:"folder-selector",context:this,requireAuth:!0},t))},loadFolders:function(){var n=this;console.log("å¼€å§‹åŠ è½½æ”¶è—å¤¹åˆ—è¡¨..."),this.setData({isLoading:!0});var e=this.$requireOpenid&&this.$requireOpenid();e?this.callCloudFunction("getMyProfileData",{action:"getFavoriteFolders",openid:e}).then((function(e){if(console.log("folder-selectorè·å–æ”¶è—å¤¹:",e),e.result&&e.result.success){var t=e.result.folders||[];console.log("è·å–åˆ°æ”¶è—å¤¹æ•°é‡:",t.length);var o=n.selectedFolderId;o&&!t.some((function(n){return n._id===o}))&&(console.log("æ¸…ç©ºå¤±æ•ˆçš„é€‰ä¸­çŠ¶æ€"),n.setData({selectedFolderId:""})),n.setData({folders:t,isLoading:!1})}else{var r;uni.showToast({title:(null===(r=e.result)||void 0===r?void 0:r.message)||"åŠ è½½å¤±è´¥",icon:"none"}),n.setData({isLoading:!1,folders:[],selectedFolderId:""})}})).catch((function(e){console.error("è·å–æ”¶è—å¤¹å¤±è´¥:",e),uni.showToast({title:"ç½‘ç»œé”™è¯¯",icon:"none"}),n.setData({isLoading:!1,folders:[],selectedFolderId:""})})):this.setData({isLoading:!1,folders:[],selectedFolderId:""})},selectFolder:function(n){var e=n.currentTarget.dataset.folderId;this.setData({selectedFolderId:e})},confirmFavorite:function(){var n=this,e=this.selectedFolderId,o=this.postId;if(console.log("ç¡®è®¤æ”¶è—ï¼ŒpostId:",o,"folderId:",e),e){if(!o)return console.error("postId ä¸ºç©ºï¼Œæ— æ³•æ”¶è—"),void uni.showToast({title:"å‚æ•°é”™è¯¯ï¼šå¸–å­IDä¸ºç©º",icon:"none"});var r=this.$requireOpenid&&this.$requireOpenid();r&&(uni.showLoading({title:"æ”¶è—ä¸­..."}),this.callCloudFunction("getMyProfileData",{action:"addToFavorite",postId:o,folderId:e,openid:r}).then((function(e){if(uni.hideLoading(),console.log("ç¡®è®¤æ”¶è—è¿”å›ç»“æœ:",e),e&&e.result)if(e.result.success){uni.showToast({title:"æ”¶è—æˆåŠŸ"}),console.log("æ”¶è—æˆåŠŸï¼Œå¼€å§‹å…³é—­å¼¹çª—"),n.setData({selectedFolderId:""}),setTimeout((function(){n.hideModal()}),1500),n.$emit("favoriteSuccess");try{var r=getApp(),a=r&&r.globalData&&r.globalData.openid,i=t("2729"),s=i.emitFavoriteChanged;s({userId:a,postId:o,favored:!0})}catch(l){}}else console.error("æ”¶è—ä¸šåŠ¡å¤±è´¥:",e.result),uni.showToast({title:e.result.message||"æ”¶è—å¤±è´¥",icon:"none"});else console.error("æ”¶è—è¿”å›æ ¼å¼å¼‚å¸¸:",e),uni.showToast({title:"æ”¶è—å¤±è´¥ï¼šè¿”å›æ ¼å¼é”™è¯¯",icon:"none"})})).catch((function(n){uni.hideLoading(),console.error("æ”¶è—äº‘å‡½æ•°è°ƒç”¨å¤±è´¥:",n),uni.showToast({title:"ç½‘ç»œé”™è¯¯ï¼š"+(n.errMsg||"æœªçŸ¥é”™è¯¯"),icon:"none"})})))}else uni.showToast({title:"è¯·é€‰æ‹©æ”¶è—å¤¹",icon:"none"})},createFolder:function(){this.setData({showCreateModal:!0,newFolderName:""})},hideCreateModal:function(){this.setData({showCreateModal:!1,newFolderName:""})},onFolderNameInput:function(n){var e=n.detail.value;this.setData({newFolderName:e})},createNewFolder:function(){var n=this,e=this.newFolderName.trim();if(e){this.setData({newFolderName:e}),console.log("ç»„ä»¶å¼€å§‹åˆ›å»ºæ”¶è—å¤¹ï¼Œåç§°:",e);var t=this.$requireOpenid&&this.$requireOpenid();t&&(uni.showLoading({title:"åˆ›å»ºä¸­..."}),this.callCloudFunction("getMyProfileData",{action:"createFavoriteFolder",folderName:e,openid:t}).then((function(e){uni.hideLoading(),console.log("ç»„ä»¶åˆ›å»ºæ”¶è—å¤¹è¿”å›ç»“æœ:",e),e&&e.result?e.result.success?(uni.showToast({title:"åˆ›å»ºæˆåŠŸ",duration:2e3}),n.setData({showCreateModal:!1}),setTimeout((function(){n.loadFolders()}),300)):(console.error("ç»„ä»¶åˆ›å»ºæ”¶è—å¤¹ä¸šåŠ¡å¤±è´¥:",e.result),uni.showToast({title:e.result.message||"åˆ›å»ºå¤±è´¥",icon:"none",duration:3e3})):(console.error("ç»„ä»¶åˆ›å»ºæ”¶è—å¤¹è¿”å›æ ¼å¼å¼‚å¸¸:",e),uni.showToast({title:"åˆ›å»ºå¤±è´¥ï¼šè¿”å›æ ¼å¼é”™è¯¯",icon:"none",duration:3e3}))})).catch((function(n){uni.hideLoading(),console.error("ç»„ä»¶åˆ›å»ºæ”¶è—å¤¹äº‘å‡½æ•°è°ƒç”¨å¤±è´¥:",n),uni.showToast({title:"åˆ›å»ºå¤±è´¥: "+(n.errMsg||"ç½‘ç»œé”™è¯¯"),icon:"none",duration:3e3})})))}else uni.showToast({title:"è¯·è¾“å…¥æ”¶è—å¤¹åç§°",icon:"none"})},hideModal:function(){console.log("=== ç‚¹å‡»å…³é—­æŒ‰é’®ï¼Œå¼€å§‹éšè—å¼¹çª— ==="),console.log("å½“å‰çŠ¶æ€ï¼š",{show:this.show,showCreateModal:this.showCreateModal,selectedFolderId:this.selectedFolderId}),this.setData({selectedFolderId:"",showClone:!1,showCreateModal:!1,newFolderName:""}),console.log("=== å¼¹çª—å·²éšè—ï¼ŒçŠ¶æ€å·²é‡ç½® ==="),this.$emit("hide")},trueFun:function(){console.log("å ä½ï¼šå‡½æ•° true æœªå£°æ˜")}},created:function(){}};e.default=s},"84aa":function(n,e,t){"use strict";t("6a54");var o=t("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(t("39d8")),a=o(t("2634")),i=o(t("2fdc")),s=o(t("fcf3"));t("5c47"),t("8f71"),t("bf0f"),t("5ef2"),t("2797"),t("c223"),t("7a76"),t("c9b5");var l=o(t("724b")),d=o(t("71b6")),c=o(t("c4b7")),u=o(t("71b6")),f=o(t("c107")),v=t("38db"),p=v.cloudCall,g=t("9167"),h={onShow:function(){try{uni.hideTabBar({animation:!1})}catch(r){}try{this.$refs.customTabBar&&this.$refs.customTabBar.syncSelected&&this.$refs.customTabBar.syncSelected()}catch(r){}var n=uni.getStorageSync("shouldRefreshIndex"),e=uni.getStorageSync("shouldRefreshProfile"),t=uni.getStorageSync("shouldRefreshPoem"),o=uni.getStorageSync("shouldRefreshMountain");(n||e||t||o)&&(console.log("ã€mountainã€‘æ£€æµ‹åˆ°éœ€è¦åˆ·æ–°æ ‡è®°ï¼Œå¼€å§‹åˆ·æ–°å±±é¡µé¢æ•°æ®:",{shouldRefreshIndex:n,shouldRefreshProfile:e,shouldRefreshPoem:t,shouldRefreshMountain:o}),uni.removeStorageSync("shouldRefreshIndex"),uni.removeStorageSync("shouldRefreshProfile"),uni.removeStorageSync("shouldRefreshPoem"),uni.removeStorageSync("shouldRefreshMountain"),this.getIndexData())},components:{skeleton:d.default,topBar:c.default,AppTabBar:l.default},data:function(){return{postList:[],page:0,hasMore:!0,isLoading:!0,isLoadingMore:!1,lastUsedColorIndex:-1,backgroundColors:["#a4c4bd","#c9cfcf","#906161","#909388"],showPageIndicator:!1,votingInProgress:{},safeAreaTop:0}},onLoad:function(){this.debugSafeArea(),this.getIndexData()},onPullDownRefresh:function(){console.log("ã€mountainã€‘ğŸ“± ä¸‹æ‹‰åˆ·æ–°ï¼Œé‡æ–°è·å–æ•°æ®"),this.getIndexData((function(){console.log("ã€mountainã€‘âœ… ä¸‹æ‹‰åˆ·æ–°å®Œæˆï¼Œåœæ­¢åˆ·æ–°åŠ¨ç”»"),uni.stopPullDownRefresh()}))},onPageScroll:function(n){var e=this;this._scrollTimer&&clearTimeout(this._scrollTimer),this._scrollTimer=setTimeout((function(){if(e.hasMore&&!e.isLoadingMore&&!e.isLoading)try{var t=uni.getSystemInfoSync(),o=t.windowHeight;uni.createSelectorQuery().in(e).select("#post-list-container").boundingClientRect((function(t){if(t&&t.height){var r=t.height-n.scrollTop-o,a=1.5*o;r<a&&(e.showPageIndicator=!0,e.getPostList((function(){e.showPageIndicator=!1})))}})).exec()}catch(r){}}),100)},methods:{debugSafeArea:function(){try{var n=uni.getSystemInfoSync();if(console.log("ã€mountainã€‘ç³»ç»Ÿä¿¡æ¯:",{statusBarHeight:n.statusBarHeight,safeAreaInsets:n.safeAreaInsets,safeArea:n.safeArea,windowHeight:n.windowHeight,screenHeight:n.screenHeight,platform:n.platform}),n.statusBarHeight){var e=n.statusBarHeight;console.log("ã€mountainã€‘ä½¿ç”¨çŠ¶æ€æ é«˜åº¦ä½œä¸ºå®‰å…¨åŒºåŸŸ:",e),this.setData({safeAreaTop:e});try{"undefined"!==typeof document&&document.documentElement&&(document.documentElement.style.setProperty("--safe-area-inset-top",e+"px"),console.log("ã€mountainã€‘CSSå˜é‡è®¾ç½®æˆåŠŸ"))}catch(t){console.log("ã€mountainã€‘CSSå˜é‡è®¾ç½®å¤±è´¥ï¼Œä½¿ç”¨æ•°æ®ç»‘å®šæ–¹å¼:",t)}}}catch(o){console.error("ã€mountainã€‘å®‰å…¨åŒºåŸŸè°ƒè¯•å¤±è´¥:",o)}},callCloudFunction:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return p(n,e,Object.assign({pageTag:"mountain",context:this,requireAuth:!1},t))},getIndexData:function(n){var e=this;console.log("ã€mountainã€‘å¼€å§‹è·å–æ•°æ®ï¼Œcallback:",(0,s.default)(n)),this.setData({isLoading:!0,postList:[],page:0,hasMore:!0}),this.getPostList((function(){console.log("ã€mountainã€‘getPostList å®Œæˆï¼Œè®¾ç½® isLoading: false"),e.setData({isLoading:!1}),"function"===typeof n&&(console.log("ã€mountainã€‘æ‰§è¡Œå›è°ƒå‡½æ•°"),n())}))},generateRandomBackgroundColor:function(){var n=this.backgroundColors,e=this.lastUsedColorIndex;if(-1===e){var t=Math.floor(Math.random()*n.length);return this.lastUsedColorIndex=t,n[t]}var o=n.filter((function(n,t){return t!==e})),r=o[Math.floor(Math.random()*o.length)];return this.lastUsedColorIndex=n.indexOf(r),r},getPostList:function(n){var e=this;return(0,i.default)((0,a.default)().mark((function t(){var o,r,i;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("ã€mountainã€‘getPostList å¼€å§‹ï¼ŒisLoadingMore:",e.isLoadingMore,"callback:",(0,s.default)(n)),!e.isLoadingMore){t.next=5;break}return console.log("ã€mountainã€‘æ­£åœ¨åŠ è½½æ›´å¤šï¼Œè·³è¿‡è¯·æ±‚"),"function"===typeof n&&n(),t.abrupt("return");case 5:return e.setData({isLoadingMore:!0}),t.prev=6,t.next=9,e.callCloudFunction("getPostList",{skip:10*e.page,limit:10,isPoem:!0,isOriginal:!1});case 9:o=t.sent,r=o&&o.result&&o.result.posts?o.result.posts:[],console.log("ã€mountainã€‘è·å–åˆ°å¸–å­æ•°é‡:",r.length),r.forEach((function(n){n.backgroundColor=n.backgroundColor||e.generateRandomBackgroundColor(),n.textColor=n.textColor||"#222",n.isExpanded=!1,n.likeIcon=g&&g.getLikeIcon?g.getLikeIcon(n.votes||0,!!n.isVoted):""})),i=0===e.page?r:e.postList.concat(r),e.setData({postList:i,page:e.page+1,hasMore:10===r.length}),console.log("ã€mountainã€‘æ•°æ®å¤„ç†å®Œæˆ"),t.next=22;break;case 18:t.prev=18,t.t0=t["catch"](6),console.error("ã€mountainã€‘è·å–å¸–å­åˆ—è¡¨å¤±è´¥:",t.t0),uni.showToast({title:"åŠ è½½å¤±è´¥",icon:"none"});case 22:return t.prev=22,console.log("ã€mountainã€‘è®¾ç½® isLoadingMore: falseï¼Œæ‰§è¡Œå›è°ƒ"),e.setData({isLoadingMore:!1}),"function"===typeof n&&(console.log("ã€mountainã€‘æ‰§è¡Œå›è°ƒå‡½æ•°"),n()),t.finish(22);case 27:case"end":return t.stop()}}),t,null,[[6,18,22,27]])})))()},togglePostExpansion:function(n){var e=n.currentTarget.dataset.index,t=this.postList[e],o=!t.isExpanded;this.setData((0,r.default)({},"postList[".concat(e,"].isExpanded"),o))},onCommentClick:function(n){var e=n.currentTarget.dataset.postid;uni.navigateTo({url:"/pages/post-detail/post-detail?id=".concat(e)})},onLikeIconError:function(){},onVote:function(n){var e=this;return(0,i.default)((0,a.default)().mark((function t(){var o,i,s,l,d,c;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=n.currentTarget.dataset.postid,i=n.currentTarget.dataset.index,!e.votingInProgress[o]){t.next=4;break}return t.abrupt("return");case 4:return e.setData((0,r.default)({},"votingInProgress.".concat(o),!0)),s=e.postList,l=s[i].votes||0,d=!!s[i].isVoted,s[i].votes=d?l-1:l+1,s[i].isVoted=!d,s[i].likeIcon=g.getLikeIcon(s[i].votes,s[i].isVoted),e.setData({postList:s}),t.prev=12,t.next=15,e.callCloudFunction("vote",{postId:o});case 15:if(c=t.sent,c&&c.result&&c.result.success){t.next=18;break}throw new Error("vote failed");case 18:"number"===typeof c.result.votes&&c.result.votes!==s[i].votes&&e.setData((0,r.default)({},"postList[".concat(i,"].votes"),c.result.votes)),t.next=28;break;case 21:t.prev=21,t.t0=t["catch"](12),s[i].votes=l,s[i].isVoted=d,s[i].likeIcon=g.getLikeIcon(l,d),e.setData({postList:s}),uni.showToast({title:"æ“ä½œå¤±è´¥",icon:"none"});case 28:return t.prev=28,e.setData((0,r.default)({},"votingInProgress.".concat(o),!1)),t.finish(28);case 31:case"end":return t.stop()}}),t,null,[[12,21,28,31]])})))()},touchStart:function(){},touchEnd:function(){}}};e.default=h,e.default.components=Object.assign({skeleton:u.default,"folder-selector":f.default},e.default.components||{})},"982d":function(n,e,t){var o=t("7a2f");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[n.i,o,""]]),o.locals&&(n.exports=o.locals);var r=t("967d").default;r("3928eb3b",o,!0,{sourceMap:!1,shadowMode:!1})},a107:function(n,e,t){var o=t("a912");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[n.i,o,""]]),o.locals&&(n.exports=o.locals);var r=t("967d").default;r("32402590",o,!0,{sourceMap:!1,shadowMode:!1})},a912:function(n,e,t){var o=t("c86c");e=o(!1),e.push([n.i,'\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* å®šä¹‰ Huiwen-mincho å­—ä½“ */@font-face{font-family:Huiwen-mincho;src:url(/static/fonts/Huiwen-mincho.otf) format("opentype");font-weight:400;font-style:normal}.white-bg[data-v-6d52ec14]{background:#fff;min-height:100vh;padding-top:env(safe-area-inset-top,var(--safe-area-inset-top,44px)) /* æ·»åŠ çŠ¶æ€æ å®‰å…¨åŒºåŸŸï¼Œå¤‡é€‰æ–¹æ¡ˆ */}.square-mode-container[data-v-6d52ec14]{padding:%?40?%;margin-bottom:%?200?%;padding-top:%?250?%; /* å¢åŠ ä¸Šè¾¹è·ï¼š100rpx(top-baré«˜åº¦) + 150rpx(é¢å¤–é—´è·) */display:flex;flex-direction:column;align-items:center /* å±…ä¸­å¡ç‰‡ */}.empty-state[data-v-6d52ec14]{text-align:center;padding:%?100?% 0;color:#999}.empty-icon[data-v-6d52ec14]{font-size:%?80?%;margin-bottom:%?20?%}.empty-text[data-v-6d52ec14]{font-size:%?32?%;margin-bottom:%?10?%;color:#666}.empty-subtext[data-v-6d52ec14]{font-size:%?24?%;color:#999}\n/* poem.css inspired card styles */.post-item-wrapper[data-v-6d52ec14]{width:calc(100% - %?80?%); /* å“åº”å¼å®½åº¦ï¼šå±å¹•å®½åº¦å‡å»å·¦å³å„40rpxè¾¹è· */margin-left:%?40?%; /* å·¦è¾¹è· */margin-right:%?40?%; /* å³è¾¹è· */border-radius:%?30?%; /* 15px * 2 */margin-bottom:%?40?%; /* å‡å°‘é—´è·ï¼Œè®©å¡ç‰‡æ›´ç´§å‡‘ */overflow:hidden;box-shadow:0 %?8?% %?8?% rgba(0,0,0,.25); /* 0px 4px 4px * 2 */transition:-webkit-transform .3s ease;transition:transform .3s ease;transition:transform .3s ease,-webkit-transform .3s ease;border:none}\n/* èƒŒæ™¯é¢œè‰²ç°åœ¨é€šè¿‡å†…è”æ ·å¼åŠ¨æ€è®¾ç½®ï¼Œä¸å†ä½¿ç”¨å›ºå®šçš„CSSç±» */.post-item-wrapper[data-v-6d52ec14]:active{-webkit-transform:scale(.98);transform:scale(.98)}.post-content-navigator[data-v-6d52ec14]{display:block}.post-item[data-v-6d52ec14]{padding:%?30?% %?60?% %?30?% %?80?%;position:relative}\n/* è¿›ä¸€æ­¥å‡å°‘ä¸Šä¸‹paddingï¼Œæ–‡å­—å¾€å·¦ç§»åŠ¨ */\n/* Typography inspired by poem.css */.post-content[data-v-6d52ec14]{font-family:Huiwen-mincho,sans-serif;font-style:normal;font-weight:500;font-size:%?28?%; /* è°ƒå°å­—ä½“ï¼š14px * 2 */line-height:%?38?%; /* è°ƒæ•´è¡Œè·ï¼š19px * 2 */margin:%?30?% 0;width:100%;color:#fff}\n/* æ–‡å­—é¢œè‰²ç°åœ¨é€šè¿‡å†…è”æ ·å¼åŠ¨æ€è®¾ç½® */\n/* æŠ˜å æ€ï¼šå½“æ²¡æœ‰é«˜å…‰è¡Œæ—¶æ˜¾ç¤ºå‰ä¸‰è¡Œï¼Œæœ‰é«˜å…‰è¡Œæ—¶æ˜¾ç¤ºé«˜å…‰è¡Œ */.post-content.collapsed[data-v-6d52ec14]{overflow:hidden;text-overflow:ellipsis}\n/* å½“æ²¡æœ‰é«˜å…‰è¡Œæ—¶ï¼Œä½¿ç”¨ä¸‰è¡Œè£åˆ‡ */.post-content.collapsed.no-highlight[data-v-6d52ec14]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3}.post-content.expanded[data-v-6d52ec14]{display:block;overflow:visible}.comment-emoji[data-v-6d52ec14]{font-size:%?40?%}.vote-section[data-v-6d52ec14]{display:flex;justify-content:space-between;align-items:center;padding:%?25?% %?50?%}.actions-left[data-v-6d52ec14]{flex:1;display:flex;align-items:center;gap:%?20?%}.button-group[data-v-6d52ec14]{display:flex;align-items:center;gap:%?30?%}.comment-count[data-v-6d52ec14]{display:flex;align-items:center;gap:%?8?%;padding:%?10?% %?15?%}.vote-count[data-v-6d52ec14]{display:flex;align-items:center;gap:%?8?%;padding:%?10?% %?15?%;border-radius:%?20?%;background:hsla(0,0%,100%,.9);box-shadow:0 %?2?% %?8?% rgba(0,0,0,.1)}.comment-icon[data-v-6d52ec14]{width:%?80?%;height:%?80?%}.like-icon[data-v-6d52ec14]{width:%?60?%;height:%?60?%;margin-top:5px}.loading-footer[data-v-6d52ec14]{text-align:center;color:#666;padding:%?30?% 0 %?120?%}.page-indicator[data-v-6d52ec14]{position:fixed;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);background:rgba(0,0,0,.7);color:#fff;padding:%?20?% %?40?%;border-radius:%?40?%;z-index:1000;font-size:%?28?%}.page-indicator-text[data-v-6d52ec14]{text-align:center}',""]),n.exports=e},b89d:function(n,e,t){"use strict";t.d(e,"b",(function(){return o})),t.d(e,"c",(function(){return r})),t.d(e,"a",(function(){}));var o=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("v-uni-view",[n.showClone?t("v-uni-view",{staticClass:"modal-overlay"},[t("v-uni-view",{staticClass:"modal-content"},[t("v-uni-view",{staticClass:"modal-header"},[t("v-uni-view",{staticClass:"modal-title"},[n._v("é€‰æ‹©æ”¶è—å¤¹")]),t("v-uni-view",{staticClass:"close-btn",on:{click:function(e){arguments[0]=e=n.$handleEvent(e),n.hideModal.apply(void 0,arguments)}}},[n._v("Ã—")])],1),t("v-uni-view",{staticClass:"modal-body"},[n.isLoading?t("v-uni-view",{staticClass:"loading-container"},[t("v-uni-view",{staticClass:"loading-text"},[n._v("åŠ è½½ä¸­...")])],1):n.folders.length>0?t("v-uni-view",{staticClass:"folders-list"},n._l(n.folders,(function(e,o){return t("v-uni-view",{key:o,class:"folder-item "+(n.selectedFolderId===e._id?"selected":""),attrs:{"data-folder-id":e._id},on:{click:function(e){arguments[0]=e=n.$handleEvent(e),n.selectFolder.apply(void 0,arguments)}}},[t("v-uni-view",{staticClass:"folder-icon"},[n._v("ğŸ“")]),t("v-uni-view",{staticClass:"folder-info"},[t("v-uni-view",{staticClass:"folder-name"},[n._v(n._s(e.name))]),t("v-uni-view",{staticClass:"folder-count"},[n._v(n._s(e.itemCount)+" ä¸ªæ”¶è—")])],1),n.selectedFolderId===e._id?t("v-uni-view",{staticClass:"selected-icon"},[n._v("âœ“")]):n._e()],1)})),1):t("v-uni-view",{staticClass:"empty-state"},[t("v-uni-view",{staticClass:"empty-icon"},[n._v("ğŸ“")]),t("v-uni-view",{staticClass:"empty-text"},[n._v("è¿˜æ²¡æœ‰æ”¶è—å¤¹")]),t("v-uni-view",{staticClass:"empty-subtext"},[n._v("å…ˆåˆ›å»ºä¸€ä¸ªæ”¶è—å¤¹å§")])],1)],1),t("v-uni-view",{staticClass:"modal-footer"},[t("v-uni-button",{staticClass:"modal-btn secondary-btn",on:{click:function(e){arguments[0]=e=n.$handleEvent(e),n.createFolder.apply(void 0,arguments)}}},[n._v("åˆ›å»ºæ”¶è—å¤¹")]),t("v-uni-button",{staticClass:"modal-btn primary-btn",attrs:{disabled:!n.selectedFolderId},on:{click:function(e){arguments[0]=e=n.$handleEvent(e),n.confirmFavorite.apply(void 0,arguments)}}},[n._v("ç¡®è®¤æ”¶è—")])],1)],1)],1):n._e(),n.showCreateModal?t("v-uni-view",{staticClass:"modal-overlay"},[t("v-uni-view",{staticClass:"modal-content create-modal"},[t("v-uni-view",{staticClass:"modal-header"},[t("v-uni-view",{staticClass:"modal-title"},[n._v("åˆ›å»ºæ”¶è—å¤¹")]),t("v-uni-view",{staticClass:"close-btn",on:{click:[function(e){arguments[0]=e=n.$handleEvent(e),n.hideCreateModal.apply(void 0,arguments)},function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=n.$handleEvent(e),n.trueFun.apply(void 0,arguments)}]}},[n._v("Ã—")])],1),t("v-uni-view",{staticClass:"modal-body"},[t("v-uni-input",{staticClass:"folder-name-input",attrs:{placeholder:"è¯·è¾“å…¥æ”¶è—å¤¹åç§°",value:n.newFolderName,focus:!0},on:{input:function(e){arguments[0]=e=n.$handleEvent(e),n.onFolderNameInput.apply(void 0,arguments)},click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=n.$handleEvent(e),n.trueFun.apply(void 0,arguments)}}})],1),t("v-uni-view",{staticClass:"modal-footer"},[t("v-uni-button",{staticClass:"modal-btn secondary-btn",on:{click:function(e){arguments[0]=e=n.$handleEvent(e),n.hideCreateModal.apply(void 0,arguments)}}},[n._v("å–æ¶ˆ")]),t("v-uni-button",{staticClass:"modal-btn primary-btn",attrs:{disabled:!n.newFolderName},on:{click:function(e){arguments[0]=e=n.$handleEvent(e),n.createNewFolder.apply(void 0,arguments)}}},[n._v("åˆ›å»º")])],1)],1)],1):n._e()],1)},r=[]},c107:function(n,e,t){"use strict";t.r(e);var o=t("b89d"),r=t("44f3");for(var a in r)["default"].indexOf(a)<0&&function(n){t.d(e,n,(function(){return r[n]}))}(a);t("e9a0");var i=t("828b"),s=Object(i["a"])(r["default"],o["b"],o["c"],!1,null,"3a05c372",null,!1,o["a"],void 0);e["default"]=s.exports},c7c4:function(n,e,t){"use strict";t.d(e,"b",(function(){return r})),t.d(e,"c",(function(){return a})),t.d(e,"a",(function(){return o}));var o={topBar:t("c4b7").default,skeleton:t("71b6").default},r=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("v-uni-view",{staticClass:"mountain white-bg",on:{touchstart:function(e){arguments[0]=e=n.$handleEvent(e),n.touchStart.apply(void 0,arguments)},touchend:function(e){arguments[0]=e=n.$handleEvent(e),n.touchEnd.apply(void 0,arguments)}}},[t("top-bar"),n.isLoading?t("v-uni-view",[t("skeleton")],1):t("v-uni-view",{staticClass:"square-mode-container"},[0===n.postList.length?t("v-uni-view",{staticClass:"empty-state"},[t("v-uni-view",{staticClass:"empty-icon"},[n._v("â›°ï¸")]),t("v-uni-view",{staticClass:"empty-text"},[n._v("è¿™é‡Œè¿˜æ²¡æœ‰å±±è¯—")]),t("v-uni-view",{staticClass:"empty-subtext"},[n._v("å»å¹¿åœºå‘ç°å¥½è¯—å§ï½")])],1):n._e(),t("v-uni-view",{attrs:{id:"post-list-container"}},n._l(n.postList,(function(e,o){return t("v-uni-view",{key:e._id||o,staticClass:"post-item-wrapper",style:{backgroundColor:e.backgroundColor}},[t("v-uni-view",{staticClass:"post-content-navigator",attrs:{"data-index":o},on:{click:function(e){arguments[0]=e=n.$handleEvent(e),n.togglePostExpansion.apply(void 0,arguments)}}},[t("v-uni-view",{staticClass:"post-item"},[e.content?t("v-uni-view",{class:"post-content "+(e.isExpanded?"expanded":"collapsed")+(e.isExpanded||e.highlightLines&&0!==e.highlightLines.length?"":" no-highlight"),style:{color:e.textColor,whiteSpace:"pre-wrap"}},[e.isExpanded?[n._v(n._s(e.content))]:[e.highlightLines&&e.highlightLines.length>0?n._l(e.highlightLines,(function(e,o){return t("v-uni-text",{key:"line-"+o,staticStyle:{"font-weight":"700",display:"block"}},[n._v(n._s(e))])})):[n._v(n._s(e.content))]]],2):n._e()],1)],1),e.isExpanded?t("v-uni-view",{staticClass:"vote-section",style:{backgroundColor:e.backgroundColor}},[t("v-uni-view",{staticClass:"actions-left"},[t("v-uni-view",{staticClass:"like-icon-container",attrs:{"data-postid":e._id,"data-index":o},on:{click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=n.$handleEvent(e),n.onVote.apply(void 0,arguments)}}},[t("v-uni-image",{staticClass:"like-icon",attrs:{src:e.likeIcon||"/static/images/seed.png",mode:"aspectFit"},on:{error:function(e){arguments[0]=e=n.$handleEvent(e),n.onLikeIconError.apply(void 0,arguments)}}})],1),t("v-uni-view",{staticClass:"comment-count",attrs:{"data-postid":e._id},on:{click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=n.$handleEvent(e),n.onCommentClick.apply(void 0,arguments)}}},[t("v-uni-text",{staticClass:"comment-emoji"},[n._v("ğŸ’¬")])],1)],1),t("v-uni-view",{staticClass:"button-group"})],1):n._e()],1)})),1),t("v-uni-view",{staticClass:"loading-footer"},[!n.hasMore&&n.postList.length>0?[t("v-uni-text",[n._v("â€”â€” åˆ°åº•å•¦ â€”â€”")])]:n._e()],2)],1),n.showPageIndicator?t("v-uni-view",{staticClass:"page-indicator"}):n._e(),t("app-tab-bar",{ref:"customTabBar"})],1)},a=[]},e9a0:function(n,e,t){"use strict";var o=t("982d"),r=t.n(o);r.a}}]);