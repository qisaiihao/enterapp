(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-my-likes-my-likes"],{"1f29":function(t,n,e){"use strict";e.r(n);var r=e("5b86"),i=e.n(r);for(var a in r)["default"].indexOf(a)<0&&function(t){e.d(n,t,(function(){return r[t]}))}(a);n["default"]=i.a},"2b90":function(t,n,e){var r=e("bdbb").default,i=e("4550").default;e("5c47"),e("a1c1"),e("c223"),e("64aa");function a(t){return"undefined"===typeof uni||"function"!==typeof uni.createSelectorQuery?null:uni.createSelectorQuery().in(t)}function o(t,n,e){if("function"!==typeof t.setData){for(var a=n.replace(/\[(.*?)\]/g,".$1").replace(/^\./,""),o=a.split("."),s=t,l=0;l<o.length-1;l+=1){var d=o[l];s[d]&&"object"===r(s[d])||(s[d]={}),s=s[d]}s[o[o.length-1]]=e}else t.setData(i({},n,e))}t.exports={data:function(){return{__galleryImageMeta:{}}},created:function(){"undefined"===typeof this.swiperHeights&&(this.swiperHeights={}),"undefined"===typeof this.imageClampHeights&&(this.imageClampHeights={}),"undefined"===typeof this.imageCache&&(this.imageCache={})},methods:{onImageLoad:function(t){if(t&&t.detail&&t.currentTarget){var n=t.currentTarget.dataset||{},e=t.detail,r=e.width,i=e.height;if(r&&i){var a=function(t){return void 0!==t.galleryKey&&null!==t.galleryKey?t.galleryKey:void 0!==t.postindex&&null!==t.postindex?t.postindex:void 0!==t.postIndex&&null!==t.postIndex?t.postIndex:void 0!==t.index&&null!==t.index?t.index:void 0!==t.postid&&null!==t.postid?t.postid:void 0!==t.postId&&null!==t.postId?t.postId:void 0!==t.imgindex?"gallery-".concat(t.imgindex):"gallery"}(n),o="undefined"!==typeof n.imgindex?n.imgindex:n.imgIndex||0,s=n.type||n.imageType||"single",l="".concat(a,"_").concat(o);this.__galleryImageMeta&&(this.__galleryImageMeta[l]={width:r,height:i}),this.imageCache&&(this.imageCache[l]={width:r,height:i});var d=Number(this.galleryMinImageRatio)||9/16,c=Number(this.galleryMaxImageRatio)||16/9;if("multi"===s&&0===Number(o)){var g=n.swiperSelector||n.gallerySelector||"#swiper-".concat(a);this.__updateSwiperHeight({key:a,selector:g,originalWidth:r,originalHeight:i,minRatio:d,maxRatio:c})}if("single"===s){var u=n.singleSelector||n.imageSelector||"#single-image-".concat(a);this.__updateClampHeight({key:a,selector:u,originalWidth:r,originalHeight:i,minRatio:d})}}}},__updateSwiperHeight:function(t){var n=this,e=t.key,r=t.selector,i=t.originalWidth,s=t.originalHeight,l=t.minRatio,d=t.maxRatio;if(r){var c=a(this);c&&c.select(r).boundingClientRect((function(t){if(t&&t.width){var r=i/s,a=function(t,n,e){return t>e?e:t<n?n:t}(r,l,d),c=t.width/a;o(n,"swiperHeights[".concat(e,"]"),c)}})).exec()}},__updateClampHeight:function(t){var n=this,e=t.key,r=t.selector,i=t.originalWidth,s=t.originalHeight,l=t.minRatio,d=i/s;if(!(d>=l)){var c=r?a(this):null;if(r&&c)c.select(r).boundingClientRect((function(t){if(t&&t.width){var r=t.width/l;o(n,"imageClampHeights.".concat(e),r)}})).exec();else if(this.galleryFallbackWidth){var g=this.galleryFallbackWidth/l;o(this,"imageClampHeights.".concat(e),g)}}}}}},3192:function(t,n,e){"use strict";var r=e("f723"),i=e.n(r);i.a},"47a7":function(t,n,e){"use strict";e.r(n);var r=e("fec1"),i=e("1f29");for(var a in i)["default"].indexOf(a)<0&&function(t){e.d(n,t,(function(){return i[t]}))}(a);e("3192");var o=e("828b"),s=Object(o["a"])(i["default"],r["b"],r["c"],!1,null,"2d45613c",null,!1,r["a"],void 0);n["default"]=s.exports},"5b86":function(t,n,e){"use strict";e("6a54");var r=e("f5bd").default;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,e("7a76"),e("c9b5"),e("c223");var i=r(e("2634")),a=r(e("2fdc")),o=(getApp(),e("8e86")),s=o.previewImage,l=e("fcd5"),d=l.normalizePostList,c=e("11ca"),g=c.cloudCall,u=e("2b90"),f=e("0efe"),p={mixins:[f,u],data:function(){return{likedPosts:[],swiperHeights:{},imageClampHeights:{},imgindex:0,img:""}},onLoad:function(t){this.initPagination(this.loadLikedPosts,{pageSize:5})},methods:{callCloudFunction:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return g(t,n,Object.assign({pageTag:"my-likes",context:this,requireAuth:!0},e))},loadLikedPosts:function(t){var n=this;return(0,a.default)((0,i.default)().mark((function e(){var r,a,o,s,l,c,g,u;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.page,a=t.isRefresh,o=5*r,console.log("【my-likes】请求分页参数",{page:r,PAGE_SIZE:5,skip:o,limit:5}),a&&n.setData({swiperHeights:{},imageClampHeights:{}}),e.prev=4,e.next=7,n.callCloudFunction("getMyLikedPosts",{skip:o,limit:5});case 7:if(s=e.sent,s.result&&!0===s.result.success){e.next=14;break}throw l=s.result&&s.result.message||"数据加载失败",uni.showToast({title:l,icon:"none"}),c=new Error(l),c.__toastShown=!0,c;case 14:return g=d(s.result.posts||[]),console.log("【my-likes】本次返回帖子数量:",g.length),u=0===r||a?g:n.likedPosts.concat(g),console.log("【my-likes】更新后 likedPosts 长度:",u.length,"hasMore:",5===g.length,"page:",r+1),n.setData({likedPosts:u}),e.abrupt("return",{list:g,hasMore:5===g.length});case 22:throw e.prev=22,e.t0=e["catch"](4),console.error("Failed to fetch liked posts",e.t0),e.t0&&e.t0.__toastShown||uni.showToast({title:"网络错误",icon:"none"}),e.t0;case 27:case"end":return e.stop()}}),e,null,[[4,22]])})))()},navigateToPost:function(t){var n=t.currentTarget.dataset.id;uni.navigateTo({url:"/pages/post-detail/post-detail?id=".concat(n)})},handlePreview:function(t){var n=s(t);!1===n&&console.warn("【my-likes】图片预览失败，缺少必要数据")},onImageError:function(t){console.error("图片加载失败",t);var n=t.detail.src;console.error("失败的图片URL:",n);var e=t.currentTarget.dataset,r=e.postindex,i=e.imgindex;if(void 0!==r&&void 0!==i){var a=this.likedPosts[r];console.error("图片加载失败的上下文:",{postId:a?a._id:"unknown",postTitle:a?a.title:"unknown",imageIndex:i,imageUrl:n})}console.error("图片加载失败详情:",{error:t.detail,src:n,dataset:t.currentTarget.dataset})},onAvatarError:function(t){console.error("头像加载失败",t)}}};n.default=p},"78ab":function(t,n,e){var r=e("c86c");n=r(!1),n.push([t.i,"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* pages/my-likes/my-likes.wxss */.container[data-v-2d45613c]{padding:%?20?%;background-color:#f7f8fa;min-height:100vh}.header[data-v-2d45613c]{padding:%?20?% 0;margin-bottom:%?20?%}.header-title[data-v-2d45613c]{font-size:%?36?%;font-weight:700;color:#333}.loading-indicator[data-v-2d45613c]{display:flex;justify-content:center;align-items:center;height:%?400?%;background-color:#fff;border-radius:%?16?%;margin:%?30?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05)}.loading-indicator uni-text[data-v-2d45613c]{font-size:%?28?%;color:#999}.post-list[data-v-2d45613c]{margin-bottom:%?20?%}.post-item[data-v-2d45613c]{width:100%;padding:%?30?%;margin-bottom:%?20?%;background-color:#fff;border-radius:%?16?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05);box-sizing:border-box;transition:-webkit-transform .2s ease;transition:transform .2s ease;transition:transform .2s ease,-webkit-transform .2s ease}.post-item[data-v-2d45613c]:active{-webkit-transform:scale(.98);transform:scale(.98)}.author-info[data-v-2d45613c]{display:flex;align-items:center;margin-bottom:%?15?%}.author-avatar[data-v-2d45613c]{width:%?60?%;height:%?60?%;border-radius:50%;margin-right:%?15?%;background-color:#f5f5f5}.author-name[data-v-2d45613c]{font-size:%?28?%;color:#333;font-weight:500}.post-title[data-v-2d45613c]{font-size:%?32?%;font-weight:700;color:#333;margin-bottom:%?10?%;line-height:1.4;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical}.post-content-preview[data-v-2d45613c]{font-size:%?26?%;color:#666;line-height:1.5;margin-bottom:%?15?%;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical}.image-container[data-v-2d45613c]{position:relative;width:100%;margin:%?15?% 0}.post-image[data-v-2d45613c]{width:100%;height:auto;display:block;transition:-webkit-transform .3s ease;transition:transform .3s ease;transition:transform .3s ease,-webkit-transform .3s ease}.post-image[data-v-2d45613c]:active{-webkit-transform:scale(1.05);transform:scale(1.05)}.image-count-indicator[data-v-2d45613c]{position:absolute;top:%?15?%;right:%?15?%;background-color:rgba(0,0,0,.6);color:#fff;padding:%?6?% %?12?%;border-radius:%?16?%;font-size:%?22?%;z-index:10;-webkit-backdrop-filter:blur(%?10?%);backdrop-filter:blur(%?10?%)}.image-count-text[data-v-2d45613c]{font-size:%?22?%;color:#fff}.post-meta[data-v-2d45613c]{margin-top:%?15?%}.post-time[data-v-2d45613c]{font-size:%?24?%;color:#999;opacity:.8}.empty-tip[data-v-2d45613c]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:%?100?% %?40?%;text-align:center}.empty-icon[data-v-2d45613c]{font-size:%?120?%;margin-bottom:%?30?%;opacity:.6}.empty-text[data-v-2d45613c]{font-size:%?32?%;color:#666;margin-bottom:%?15?%}.empty-subtext[data-v-2d45613c]{font-size:%?28?%;color:#999}\r\n/* 多图轮播白色背景 */.swiper-bg-white[data-v-2d45613c]{background:#fff!important}",""]),t.exports=n},f723:function(t,n,e){var r=e("78ab");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var i=e("967d").default;i("7fbeb610",r,!0,{sourceMap:!1,shadowMode:!1})},fec1:function(t,n,e){"use strict";e.d(n,"b",(function(){return r})),e.d(n,"c",(function(){return i})),e.d(n,"a",(function(){}));var r=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-uni-view",{staticClass:"container"},[e("v-uni-view",{staticClass:"header"},[e("v-uni-text",{staticClass:"header-title"},[t._v("我的点赞")])],1),t.isLoading&&0===t.likedPosts.length?e("v-uni-view",{staticClass:"loading-indicator"},[e("v-uni-text",[t._v("加载中...")])],1):e("v-uni-view",[t.likedPosts.length>0?e("v-uni-view",{staticClass:"post-list"},[t._l(t.likedPosts,(function(n,r){return e("v-uni-view",{key:r,staticClass:"post-item",attrs:{"data-id":n._id},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.navigateToPost.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"author-info"},[e("v-uni-image",{staticClass:"author-avatar",attrs:{src:n.authorAvatar||"/static/images/icons/avatar.png",mode:"aspectFill"},on:{error:function(n){arguments[0]=n=t.$handleEvent(n),t.onAvatarError.apply(void 0,arguments)}}}),e("v-uni-text",{staticClass:"author-name"},[t._v(t._s(n.authorName))])],1),e("v-uni-view",{staticClass:"post-title"},[t._v(t._s(n.title))]),e("v-uni-view",{staticClass:"post-content-preview"},[t._v(t._s(n.content))]),n.imageUrl||n.imageUrls&&n.imageUrls.length>0?e("v-uni-view",{staticClass:"image-container",attrs:{id:"image-container-"+r}},[n.imageUrls&&1===n.imageUrls.length?[e("v-uni-image",{style:"width: 100%; height: "+(t.imageClampHeights[n._id]?t.imageClampHeights[n._id]+"px":"auto")+"; object-fit: "+(t.imageClampHeights[n._id]?"cover":"contain")+"; background-color: #f0f0f0;",attrs:{id:"single-image-"+n._id,src:n.imageUrls[0],mode:t.imageClampHeights[n._id]?"aspectFill":"widthFix","data-postid":n._id,"data-type":"single","data-src":n.imageUrls[0],"data-original-image-urls":n.originalImageUrls||n.imageUrls,"lazy-load":!0},on:{load:function(n){arguments[0]=n=t.$handleEvent(n),t.onImageLoad.apply(void 0,arguments)},error:function(n){arguments[0]=n=t.$handleEvent(n),t.onImageError.apply(void 0,arguments)},click:function(n){n.stopPropagation(),n.preventDefault(),arguments[0]=n=t.$handleEvent(n),t.handlePreview.apply(void 0,arguments)}}})]:n.imageUrls&&n.imageUrls.length>1?[e("v-uni-swiper",{staticClass:"image-swiper",style:"width: 100%; height: "+(t.swiperHeights[r]?t.swiperHeights[r]+"px":"220px")+";",attrs:{id:"swiper-"+n._id,"indicator-dots":!0,circular:!0}},[t._l(n.imageUrls,(function(i,a){return[e("v-uni-swiper-item",[e("v-uni-image",{staticStyle:{width:"100%",height:"100%","object-fit":"cover","background-color":"#f0f0f0"},attrs:{src:i,mode:"aspectFill","data-postid":n._id,"data-postindex":r,"data-imgindex":a,"data-type":"multi","data-src":i,"data-original-image-urls":n.originalImageUrls||n.imageUrls,"lazy-load":!0},on:{load:function(n){arguments[0]=n=t.$handleEvent(n),t.onImageLoad.apply(void 0,arguments)},error:function(n){arguments[0]=n=t.$handleEvent(n),t.onImageError.apply(void 0,arguments)},click:function(n){n.stopPropagation(),n.preventDefault(),arguments[0]=n=t.$handleEvent(n),t.handlePreview.apply(void 0,arguments)}}})],1)]}))],2)]:t._e()],2):t._e(),e("v-uni-view",{staticClass:"post-meta"},[e("v-uni-text",{staticClass:"post-time"},[t._v(t._s(n.formattedCreateTime))])],1)],1)})),t.isLoading&&t.likedPosts.length>0?e("v-uni-view",{staticClass:"loading-indicator"},[e("v-uni-text",[t._v("加载中...")])],1):t._e()],2):e("v-uni-view",{staticClass:"empty-tip"},[e("v-uni-view",{staticClass:"empty-icon"},[t._v("👍")]),e("v-uni-view",{staticClass:"empty-text"},[t._v("你还没有点赞任何帖子哦～")]),e("v-uni-view",{staticClass:"empty-subtext"},[t._v("去首页发现精彩内容吧！")])],1)],1)],1)},i=[]}}]);