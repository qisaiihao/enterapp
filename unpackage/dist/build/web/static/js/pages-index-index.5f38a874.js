(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-index"],{"1b25":function(n,t,e){var a=e("5892");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);var o=e("967d").default;o("7e3b12a0",a,!0,{sourceMap:!1,shadowMode:!1})},"1d0b":function(n,t,e){var a=e("d189").default,o=e("dd7e").default,i=e("46c5").default,s=e("883d").default,r=e("4db6").default;e("c1a3"),e("bf0f"),e("18f7"),e("de6c"),e("4626"),e("5ac7"),e("f7a5"),e("fd3c"),e("aa9c"),e("08eb");var c=function(){"use strict";function n(){s(this,n),this.cache=new Map,this.isH5="undefined"!==typeof window,this.isMiniProgram="undefined"!==typeof wx&&wx.cloud}return r(n,[{key:"loadImage",value:function(){var n=i(o().mark((function n(t){var e,a,i,s,r,c=arguments;return o().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e=c.length>1&&void 0!==c[1]?c[1]:{},a=e.useCache,i=void 0===a||a,s=e.timeout,void 0===s?1e4:s,r=e.fallbackToOriginal,void 0===r||r,!i||!this.cache.has(t)){n.next=4;break}return n.abrupt("return",{success:!0,url:this.cache.get(t),fromCache:!0});case 4:if(!this.isH5){n.next=8;break}return n.abrupt("return",this.loadImageH5(t,e));case 8:if(!this.isMiniProgram){n.next=12;break}return n.abrupt("return",this.loadImageMiniProgram(t,e));case 12:return n.abrupt("return",this.loadImageNative(t,e));case 13:case"end":return n.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}()},{key:"loadImageH5",value:function(){var n=i(o().mark((function n(t,e){var a,i,s;return o().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.fallbackToOriginal,i=void 0===a||a,!this.isCloudStorageUrl(t)){n.next=5;break}return console.log("ğŸ” [H5] æ£€æµ‹åˆ°è…¾è®¯äº‘å­˜å‚¨URLï¼Œç›´æ¥ä½¿ç”¨:",t),this.cache.set(t,t),n.abrupt("return",{success:!0,url:t,fromCache:!1,strategy:"direct"});case 5:return n.prev=5,n.next=8,this.downloadFileWithTimeout(t,e.timeout);case 8:if(s=n.sent,!s.success){n.next=12;break}return this.cache.set(t,s.tempFilePath),n.abrupt("return",{success:!0,url:s.tempFilePath,fromCache:!1,strategy:"download"});case 12:n.next=17;break;case 14:n.prev=14,n.t0=n["catch"](5),console.warn("ğŸ” [H5] downloadFileå¤±è´¥:",n.t0);case 17:if(!i){n.next=21;break}return console.log("ğŸ” [H5] ä½¿ç”¨é™çº§æ–¹æ¡ˆï¼Œç›´æ¥ä½¿ç”¨åŸURL:",t),this.cache.set(t,t),n.abrupt("return",{success:!0,url:t,fromCache:!1,strategy:"fallback"});case 21:return n.abrupt("return",{success:!1,error:"H5ç¯å¢ƒä¸‹å›¾ç‰‡åŠ è½½å¤±è´¥",url:t});case 22:case"end":return n.stop()}}),n,this,[[5,14]])})));return function(t,e){return n.apply(this,arguments)}}()},{key:"loadImageMiniProgram",value:function(){var n=i(o().mark((function n(t,e){var a;return o().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.downloadFileWithTimeout(t,e.timeout);case 3:if(a=n.sent,!a.success){n.next=7;break}return this.cache.set(t,a.tempFilePath),n.abrupt("return",{success:!0,url:a.tempFilePath,fromCache:!1,strategy:"download"});case 7:n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](0),console.error("å°ç¨‹åºç¯å¢ƒå›¾ç‰‡åŠ è½½å¤±è´¥:",n.t0);case 12:return n.abrupt("return",{success:!1,error:"å°ç¨‹åºç¯å¢ƒä¸‹å›¾ç‰‡åŠ è½½å¤±è´¥",url:t});case 13:case"end":return n.stop()}}),n,this,[[0,9]])})));return function(t,e){return n.apply(this,arguments)}}()},{key:"loadImageNative",value:function(){var n=i(o().mark((function n(t,e){var a;return o().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.downloadFileWithTimeout(t,e.timeout);case 3:if(a=n.sent,!a.success){n.next=7;break}return this.cache.set(t,a.tempFilePath),n.abrupt("return",{success:!0,url:a.tempFilePath,fromCache:!1,strategy:"download"});case 7:n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](0),console.error("åŸç”Ÿç¯å¢ƒå›¾ç‰‡åŠ è½½å¤±è´¥:",n.t0);case 12:return n.abrupt("return",{success:!1,error:"åŸç”Ÿç¯å¢ƒä¸‹å›¾ç‰‡åŠ è½½å¤±è´¥",url:t});case 13:case"end":return n.stop()}}),n,this,[[0,9]])})));return function(t,e){return n.apply(this,arguments)}}()},{key:"downloadFileWithTimeout",value:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;return new Promise((function(e){var a=setTimeout((function(){e({success:!1,error:"ä¸‹è½½è¶…æ—¶"})}),t);uni.downloadFile({url:n,success:function(n){clearTimeout(a),200===n.statusCode?e({success:!0,tempFilePath:n.tempFilePath}):e({success:!1,error:"HTTP ".concat(n.statusCode)})},fail:function(n){clearTimeout(a),e({success:!1,error:n.errMsg||"ä¸‹è½½å¤±è´¥"})}})}))}},{key:"isCloudStorageUrl",value:function(n){return n.includes("tcb.qcloud.la")||n.includes("cloudbase")||n.includes("cloud://")}},{key:"loadImages",value:function(){var n=i(o().mark((function n(t){var e,i,s,r,c,l,d,u=this,g=arguments;return o().wrap((function(n){while(1)switch(n.prev=n.next){case 0:e=g.length>1&&void 0!==g[1]?g[1]:{},i=e.maxConcurrent,s=void 0===i?3:i,r=[],c=0;case 4:if(!(c<t.length)){n.next=13;break}return l=t.slice(c,c+s),n.next=8,Promise.all(l.map((function(n){return u.loadImage(n,e)})));case 8:d=n.sent,r.push.apply(r,a(d));case 10:c+=s,n.next=4;break;case 13:return n.abrupt("return",r);case 14:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()},{key:"clearCache",value:function(){this.cache.clear()}},{key:"getCacheStats",value:function(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}}]),n}(),l=new c;n.exports=l},"2cf2":function(n,t,e){"use strict";e("6a54");var a=e("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(e("b7c7")),i=a(e("9b1b")),s=a(e("39d8"));e("bf0f"),e("f3f7"),e("18f7"),e("de6c"),e("5c47"),e("bd06"),e("f7a5"),e("fd3c"),e("8f71"),e("c223"),e("aa77");var r=a(e("8cb3")),c=a(e("8cb3")),l=e("b99c"),d=e("f806"),u=e("fe58"),g=e("df61"),v=g.togglePostLike,f=e("a7cb"),p=e("05f6"),h=e("8e86"),m=h.previewImage,b=e("fcd5"),w=b.normalizePostList,k=e("11ca"),y=k.cloudCall,x=e("2b90"),C={components:{skeleton:r.default},mixins:[x],data:function(){return{postList:[],votingInProgress:{},page:0,hasMore:!0,isLoading:!1,isLoadingMore:!1,swiperHeights:{},imageClampHeights:{},displayMode:"square",imageCache:{},visiblePosts:new Set,unreadMessageCount:0,currentPage:"home",showPageIndicator:!1,pageIndicatorText:"",discoverPostList:[],discoverPage:0,discoverHasMore:!0,discoverShownPostIds:[],discoverRefreshTime:0,touchStartX:0,touchStartY:0,touchEndX:0,touchEndY:0,selected:0,img:""}},onLoad:function(n){this.setData({displayMode:"square"}),this.pageLoadStartTime=Date.now(),this.waitForLoginThenInit()},onShow:function(){var n=e("d87a"),t=n.updateTabBarStatus;t(this,0);try{var a=uni.getStorageSync("shouldRefreshIndex");a&&(console.log("ã€indexã€‘æ£€æµ‹åˆ°å‘å¸ƒæ ‡è®°ï¼Œåˆ·æ–°æ•°æ®"),uni.removeStorageSync("shouldRefreshIndex"),this.refreshIndexData())}catch(o){console.log("CatchClause",o),console.log("CatchClause",o),console.error("æ£€æŸ¥åˆ·æ–°æ ‡è®°å¤±è´¥:",o)}this.syncLikeStatusFromCache(),this.checkUnreadMessageCount()},onPullDownRefresh:function(){var n=this;console.log("ğŸ” [é¦–é¡µ] ä¸‹æ‹‰åˆ·æ–°è§¦å‘ï¼Œå½“å‰é¡µé¢:",this.currentPage),l.remove("index_postList_cache"),"home"===this.currentPage?(console.log("ğŸ” [é¦–é¡µ] æ‰§è¡Œä¸»é¡µåˆ·æ–°"),this.setData({postList:[],swiperHeights:{},page:0,hasMore:!0},(function(){console.log("ğŸ” [é¦–é¡µ] çŠ¶æ€é‡ç½®å®Œæˆï¼Œå¼€å§‹è·å–æ•°æ®"),n.getPostList((function(){console.log("âœ… [é¦–é¡µ] ä¸‹æ‹‰åˆ·æ–°å®Œæˆ"),uni.stopPullDownRefresh()}))}))):"discover"===this.currentPage&&(console.log("ğŸ” [é¦–é¡µ] æ‰§è¡Œå‘ç°é¡µåˆ·æ–°"),this.refreshDiscoverPosts(),uni.stopPullDownRefresh())},onPageScroll:function(n){var t=this;this.scrollTimer&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout((function(){if("home"===t.currentPage)if(!t.hasMore||t.isLoading||t.isLoadingMore)console.log("ã€é¦–é¡µã€‘æ»šåŠ¨æ£€æµ‹è¢«é˜»æ­¢:",{hasMore:t.hasMore,isLoading:t.isLoading,isLoadingMore:t.isLoadingMore});else{var e=uni.getWindowInfo(),a=e.windowHeight;console.log("ã€é¦–é¡µã€‘æ»šåŠ¨æ£€æµ‹ - scrollTop:",n.scrollTop,"windowHeight:",a),uni.createSelectorQuery().in(t).select("#post-list-container").boundingClientRect((function(e){if(e&&e.height>0){var o=e.height,i=n.scrollTop,s=o-i-a,r=1.5*a;console.log("ã€é¦–é¡µã€‘æ»šåŠ¨è®¡ç®—:",{scrollHeight:o,scrollTop:i,windowHeight:a,distanceToBottom:s,preloadThreshold:r}),s<r&&(console.log("ã€é¦–é¡µã€‘è§¦å‘é¢„åŠ è½½"),t.getPostList())}else console.log("ã€é¦–é¡µã€‘å®¹å™¨é«˜åº¦è·å–å¤±è´¥")})).exec()}}),100)},methods:{waitForLoginThenInit:function(){var n=this,t=Date.now();(function e(){try{var a=getApp(),o=a&&a.globalData&&a.globalData._loginProcessCompleted,i=a&&a.globalData&&a.globalData.openid;if(o&&i)return console.log("ğŸ” [é¦–é¡µ] æ£€æµ‹åˆ°ç™»å½•å®Œæˆä¸”å·²è·å– openidï¼Œå¼€å§‹æ‹‰å–æ•°æ®"),void n.getIndexData()}catch(s){console.log("ğŸ” [é¦–é¡µ] ç™»å½•æ£€æµ‹å¼‚å¸¸ï¼ˆå¿½ç•¥ç»§ç»­ç­‰å¾…ï¼‰",s)}if(Date.now()-t>=5e3)return console.log("â±ï¸ [é¦–é¡µ] ç™»å½•ç­‰å¾…è¶…æ—¶ï¼Œå…œåº•ç›´æ¥æ‹‰å–æ•°æ®"),void n.getIndexData();setTimeout(e,100)})()},getIndexData:function(){var n=l.get("index_postList_cache");if(n)return console.log("Index: ä½¿ç”¨ç¼“å­˜æ•°æ®"),void this.setData({postList:n,page:Math.ceil(n.length/5),isLoading:!1});this.getPostList()},refreshData:function(){var n=this;l.remove("index_postList_cache"),this.setData({postList:[],swiperHeights:{},imageClampHeights:{},page:0,hasMore:!0},(function(){n.getPostList()}))},handlePreview:function(n){console.log("ã€å›¾ç‰‡é¢„è§ˆã€‘handlePreviewäº‹ä»¶è§¦å‘");var t=n&&n.currentTarget?n.currentTarget.dataset:{};console.log("ã€å›¾ç‰‡é¢„è§ˆã€‘event.currentTarget.dataset:",t);var e=m(n);return e||console.error("ã€å›¾ç‰‡é¢„è§ˆã€‘é¢„è§ˆæ¡ä»¶ä¸æ»¡è¶³",t),e},onVote:function(n){var t=this;console.log("ã€ç‚¹èµã€‘onVoteäº‹ä»¶è§¦å‘",n.currentTarget.dataset);var e=n.currentTarget.dataset.postid,a=n.currentTarget.dataset.index;if(console.log("ã€ç‚¹èµã€‘postId:",e,"index:",a),this.votingInProgress[e])console.log("ã€ç‚¹èµã€‘æ­£åœ¨æŠ•ç¥¨ä¸­ï¼Œè·³è¿‡");else{this.setData((0,s.default)({},"votingInProgress.".concat(e),!0));var o=this.postList,i=o[a].votes,r=o[a].isVoted;console.log("ã€ç‚¹èµã€‘åŸå§‹çŠ¶æ€ - votes:",i,"isVoted:",r),o[a].votes=r?i-1:i+1,o[a].isVoted=!r,o[a].likeIcon=u.getLikeIcon(o[a].votes,o[a].isVoted),console.log("ã€ç‚¹èµã€‘æ›´æ–°åçŠ¶æ€ - votes:",o[a].votes,"isVoted:",o[a].isVoted),console.log("ã€ç‚¹èµã€‘æ–°çš„likeIcon:",o[a].likeIcon),this.setData({postList:o}),v(e,{pageTag:"index",context:this,currentVotes:i,currentIsLiked:r,requireAuth:!0}).then((function(n){if(console.log("ã€ç‚¹èµã€‘æœåŠ¡è¿”å›ç»“æœ:",n),n.success)return o[a].votes=n.votes,o[a].isVoted=n.isLiked,o[a].likeIcon=n.likeIcon,t.setData({postList:o}),void console.log("ã€ç‚¹èµã€‘æœåŠ¡è°ƒç”¨æˆåŠŸï¼Œæ•°æ®å·²åŒæ­¥");var e=n.rollback||{votes:i,isLiked:r,likeIcon:u.getLikeIcon(i,r)};console.warn("ã€ç‚¹èµã€‘æœåŠ¡è¿”å›å¤±è´¥ï¼Œå›æ»šUI"),o[a].votes=e.votes,o[a].isVoted=e.isLiked,o[a].likeIcon=e.likeIcon,t.setData({postList:o})})).catch((function(n){console.error("ã€ç‚¹èµã€‘è°ƒç”¨ likeService å¤±è´¥:",n),o[a].votes=i,o[a].isVoted=r,o[a].likeIcon=u.getLikeIcon(i,r),t.setData({postList:o})})).finally((function(){console.log("ã€ç‚¹èµã€‘æœåŠ¡è°ƒç”¨å®Œæˆ"),t.setData((0,s.default)({},"votingInProgress.".concat(e),!1))}))}},updatePostCommentCount:function(n,t){var e=this.postList,a=e.findIndex((function(t){return t._id===n}));a>-1&&this.setData((0,s.default)({},"postList[".concat(a,"].commentCount"),t))},onImageError:function(n){console.error("å›¾ç‰‡åŠ è½½å¤±è´¥",n.detail)},onAvatarError:function(n){console.error("å¤´åƒåŠ è½½å¤±è´¥",n.detail)},onAvatarLoad:function(n){console.log("å¤´åƒåŠ è½½æˆåŠŸ",n.detail)},onLikeIconError:function(n){console.error("ç‚¹èµå›¾æ ‡åŠ è½½å¤±è´¥",n.detail,"å›¾æ ‡è·¯å¾„:",n.currentTarget.dataset.src)},preloadImages:function(n){var t=n.filter((function(n){return n.imageUrls&&n.imageUrls.length>0})).map((function(n){return n.imageUrls[0]})).slice(0,3);t.length>0&&d.preloadImages(t,(function(n,t){t&&console.log("å›¾ç‰‡é¢„åŠ è½½æˆåŠŸ:",n)}))},preloadUserData:function(n){if(n&&0!==n.length){var t=this.getCurrentUserId();t&&(f.preloadAvatarsFromPosts(n),p.preloadFollowStatusFromPosts(n,t))}},getCurrentUserId:function(){return this.openid||uni.getStorageSync("openid")||uni.getStorageSync("userOpenId")},navigateToUserProfile:function(n){console.log("ã€å¤´åƒç‚¹å‡»ã€‘äº‹ä»¶è§¦å‘",n),console.log("ã€å¤´åƒç‚¹å‡»ã€‘dataset:",n.currentTarget.dataset);var t=n.currentTarget.dataset.userId;if(console.log("ã€å¤´åƒç‚¹å‡»ã€‘æå–çš„userId:",t),t){var e=this.openid;t===e?(console.log("ã€å¤´åƒç‚¹å‡»ã€‘ç‚¹å‡»çš„æ˜¯è‡ªå·±å¤´åƒï¼Œåˆ‡æ¢åˆ°æˆ‘çš„é¡µé¢"),uni.switchTab({url:"/pages/profile/profile"})):(console.log("ã€å¤´åƒç‚¹å‡»ã€‘ç‚¹å‡»çš„æ˜¯ä»–äººå¤´åƒï¼Œè·³è½¬åˆ°ç”¨æˆ·ä¸»é¡µ"),uni.navigateTo({url:"/pages/user-profile/user-profile?userId=".concat(t),success:function(){console.log("ã€å¤´åƒç‚¹å‡»ã€‘è·³è½¬æˆåŠŸ")},fail:function(n){console.error("ã€å¤´åƒç‚¹å‡»ã€‘è·³è½¬å¤±è´¥:",n),uni.showToast({title:"è·³è½¬å¤±è´¥",icon:"none"})}}))}else console.error("ã€å¤´åƒç‚¹å‡»ã€‘userIdä¸ºç©ºï¼Œæ— æ³•è·³è½¬"),uni.showToast({title:"ç”¨æˆ·ä¿¡æ¯è·å–å¤±è´¥",icon:"none"})},getPostList:function(n){var t=this;if(console.log("ğŸ” [é¦–é¡µ] getPostList å¼€å§‹è°ƒç”¨"),console.log("ğŸ” [é¦–é¡µ] å½“å‰çŠ¶æ€:",{isLoading:this.isLoading,isLoadingMore:this.isLoadingMore,hasMore:this.hasMore,page:this.page,postListLength:this.postList.length}),this.isLoading||this.isLoadingMore||!this.hasMore)return console.log("ã€é¦–é¡µã€‘getPostListè¢«é˜»æ­¢ï¼šæ­£åœ¨åŠ è½½ä¸­æˆ–æ²¡æœ‰æ›´å¤šæ•°æ®"),void("function"===typeof n&&n());var e=5*this.page,a=0===this.page;console.log("ğŸ” [é¦–é¡µ] è¯·æ±‚å‚æ•°:",{skip:e,page:this.page,isFirstLoad:a,PAGE_SIZE:5}),a?this.setData({isLoading:!0}):this.setData({isLoadingMore:!0});Date.now();this.$tcb.callFunction({name:"getPostList",data:{skip:e,limit:5}}).then((function(n){if(console.log("âœ… [é¦–é¡µ] äº‘å‡½æ•°è°ƒç”¨æˆåŠŸï¼ŒåŸå§‹å“åº”:",n),n.result&&n.result.success){var e=n.result.posts||[];console.log("âœ… [é¦–é¡µ] è·å–åˆ°å¸–å­æ•°é‡:",e.length),console.log("âœ… [é¦–é¡µ] å®Œæ•´å“åº”æ•°æ®:",n.result),e=w(e).map((function(n){return(0,i.default)((0,i.default)({},n),{},{likeIcon:u.getLikeIcon(n.votes||0,n.isVoted||!1)})})),setTimeout((function(){t.preloadUserData(e)}),500);var o=e.length,s=t.postList,r=s.concat(e),c={postList:r,page:t.page+1,hasMore:5===o};console.log("âœ… [é¦–é¡µ] æ›´æ–°æ•°æ®:",{newPostListLength:r.length,currentPage:t.page,newPage:t.page+1,hasMore:c.hasMore,newPostsCount:o}),t.setData(c),a&&(l.set("index_postList_cache",r),t.preloadImages(e))}else 0===t.page?uni.showToast({title:"åŠ è½½å¤±è´¥",icon:"none"}):t.setData({hasMore:!1})})).catch((function(n){console.error("ã€é¦–é¡µã€‘getPostListäº‘å‡½æ•°è°ƒç”¨å¤±è´¥:",n),a?uni.showToast({title:"ç½‘ç»œé”™è¯¯",icon:"none"}):console.log("ã€é¦–é¡µã€‘åŠ è½½æ›´å¤šæ—¶ç½‘ç»œé”™è¯¯ï¼Œé™é»˜å¤„ç†")})).finally((function(){a?t.setData({isLoading:!1}):t.setData({isLoadingMore:!1}),"function"===typeof n&&n()}))},checkUnreadMessageCount:function(){var n=this;this.$tcb.callFunction({name:"getUnreadMessageCount"}).then((function(t){t.result&&t.result.success&&n.setData({unreadMessageCount:t.result.count||0})})).catch((function(n){console.error("è·å–æœªè¯»æ¶ˆæ¯æ•°é‡å¤±è´¥:",n)}))},syncLikeStatusFromCache:function(){console.log("ã€é¦–é¡µã€‘åŒæ­¥ç‚¹èµçŠ¶æ€ä»ç¼“å­˜");var n=l.get("index_postList_cache");if(n&&Array.isArray(n)&&this.postList.length>0){console.log("ã€é¦–é¡µã€‘å‘ç°ç¼“å­˜æ•°æ®ï¼Œå¼€å§‹åŒæ­¥ç‚¹èµçŠ¶æ€");var t=!1,e=this.postList.map((function(e){var a=n.find((function(n){return n._id===e._id}));return!a||a.votes===e.votes&&a.isVoted===e.isVoted&&a.likeIcon===e.likeIcon?e:(console.log("ã€é¦–é¡µã€‘åŒæ­¥å¸–å­ ".concat(e._id," çš„ç‚¹èµçŠ¶æ€:"),{votes:"".concat(e.votes," -> ").concat(a.votes),isVoted:"".concat(e.isVoted," -> ").concat(a.isVoted)}),t=!0,(0,i.default)((0,i.default)({},e),{},{votes:a.votes,isVoted:a.isVoted,likeIcon:a.likeIcon}))}));t?(console.log("ã€é¦–é¡µã€‘ç‚¹èµçŠ¶æ€å·²åŒæ­¥ï¼Œæ›´æ–°UI"),this.setData({postList:e})):console.log("ã€é¦–é¡µã€‘ç‚¹èµçŠ¶æ€æ— éœ€åŒæ­¥")}else console.log("ã€é¦–é¡µã€‘æ— ç¼“å­˜æ•°æ®æˆ–å½“å‰æ— å¸–å­ï¼Œè·³è¿‡åŒæ­¥")},navigateToMessages:function(){uni.navigateTo({url:"/pages/messages/messages",success:function(){console.log("è·³è½¬åˆ°æ¶ˆæ¯é¡µé¢æˆåŠŸ")},fail:function(n){console.error("è·³è½¬åˆ°æ¶ˆæ¯é¡µé¢å¤±è´¥:",n),uni.showToast({title:"è·³è½¬å¤±è´¥",icon:"none"})}})},onTagClick:function(n){var t=n.currentTarget.dataset.tag;console.log("ç‚¹å‡»æ ‡ç­¾:",t),uni.navigateTo({url:"/pages/tag-filter/tag-filter?tag=".concat(encodeURIComponent(t)),success:function(){console.log("è·³è½¬åˆ°æ ‡ç­¾ç­›é€‰é¡µé¢æˆåŠŸ")},fail:function(n){console.error("è·³è½¬åˆ°æ ‡ç­¾ç­›é€‰é¡µé¢å¤±è´¥:",n),uni.showToast({title:"è·³è½¬å¤±è´¥",icon:"none"})}})},onCommentClick:function(n){var t=n.currentTarget.dataset.postid;console.log("ç‚¹å‡»è¯„è®ºï¼Œè·³è½¬åˆ°è¯¦æƒ…é¡µ:",t),uni.navigateTo({url:"/pages/post-detail/post-detail?id=".concat(t),success:function(){console.log("è·³è½¬åˆ°è¯¦æƒ…é¡µæˆåŠŸ")},fail:function(n){console.error("è·³è½¬åˆ°è¯¦æƒ…é¡µå¤±è´¥:",n),uni.showToast({title:"è·³è½¬å¤±è´¥",icon:"none"})}})},navigateToSearch:function(){console.log("ç‚¹å‡»æœç´¢æ¡†ï¼Œè·³è½¬åˆ°æœç´¢é¡µé¢"),uni.navigateTo({url:"/pages/search/search",success:function(){console.log("è·³è½¬åˆ°æœç´¢é¡µé¢æˆåŠŸ")},fail:function(n){console.error("è·³è½¬åˆ°æœç´¢é¡µé¢å¤±è´¥:",n),uni.showToast({title:"è·³è½¬å¤±è´¥",icon:"none"})}})},touchStart:function(n){this.setData({touchStartX:n.touches[0].clientX,touchStartY:n.touches[0].clientY})},touchEnd:function(n){var t=n.changedTouches[0].clientX,e=n.changedTouches[0].clientY,a=this.touchStartX-t,o=this.touchStartY-e,i=Math.sqrt(a*a+o*o),s=Math.abs(180*Math.atan2(Math.abs(o),Math.abs(a))/Math.PI);i>80&&Math.abs(a)>50&&s<45&&(a>0?(console.log("å·¦æ»‘åˆ‡æ¢å›ä¸»é¡µ"),this.switchToHome()):(console.log("å³æ»‘åˆ‡æ¢åˆ°å‘ç°é¡µ"),this.switchToDiscover()))},switchToDiscover:function(){var n=this;"discover"!==this.currentPage?(console.log("åˆ‡æ¢åˆ°å‘ç°é¡µ"),this.setData({currentPage:"discover",showPageIndicator:!0,pageIndicatorText:"å‘ç°é¡µ"}),0===this.discoverPostList.length?(console.log("å¼€å§‹åŠ è½½å‘ç°é¡µæ•°æ®"),this.loadDiscoverPosts()):console.log("å‘ç°é¡µå·²æœ‰æ•°æ®ï¼Œç›´æ¥åˆ‡æ¢"),setTimeout((function(){n.setData({showPageIndicator:!1})}),3e3)):console.log("å·²ç»åœ¨å‘ç°é¡µï¼Œæ— éœ€åˆ‡æ¢")},switchToHome:function(){var n=this;"home"!==this.currentPage?(console.log("åˆ‡æ¢å›ä¸»é¡µ"),this.setData({currentPage:"home",showPageIndicator:!0,pageIndicatorText:"ä¸»é¡µ"}),setTimeout((function(){n.setData({showPageIndicator:!1})}),3e3)):console.log("å·²ç»åœ¨ä¸»é¡µï¼Œæ— éœ€åˆ‡æ¢")},loadDiscoverPosts:function(){console.log("å¼€å§‹åŠ è½½å‘ç°é¡µæ¨èæ•°æ®"),this.loadRecommendationPosts()},loadRecommendationPosts:function(){var n=this;console.log("ä½¿ç”¨æ¨èç®—æ³•åŠ è½½å‘ç°é¡µæ•°æ®"),this.$tcb.callFunction({name:"getRecommendationFeed",data:{personalizedLimit:3,hotLimit:2,skip:0,excludePostIds:this.discoverShownPostIds}}).then((function(t){if(console.log("è·å–æ¨èæ•°æ®ç»“æœ:",t),t.result&&t.result.success){var e=t.result.posts||[];console.log("è·å–åˆ°æ¨èå¸–å­æ•°é‡: ".concat(e.length," (ä¸ªæ€§åŒ–: ").concat(t.result.personalizedCount,", æŒ‰æ ‡ç­¾: ").concat(t.result.tagBasedCount,", çƒ­é—¨: ").concat(t.result.hotCount,", æœ€æ–°: ").concat(t.result.latestCount,")"));var a=w(e).map((function(n){return(0,i.default)((0,i.default)({},n),{},{likeIcon:u.getLikeIcon(n.votes||0,n.isVoted||!1)})})),s=a.map((function(n){return n._id})),r=[].concat((0,o.default)(n.discoverShownPostIds),(0,o.default)(s));n.setData({discoverPostList:a,discoverPage:1,discoverHasMore:!1,discoverShownPostIds:r,discoverRefreshTime:Date.now()}),console.log("å‘ç°é¡µæ¨èæ•°æ®è®¾ç½®å®Œæˆï¼Œå¸–å­æ•°é‡:",a.length)}else console.error("è·å–æ¨èæ•°æ®å¤±è´¥:",t),uni.showToast({title:"æ¨èåŠ è½½å¤±è´¥",icon:"none"})})).catch((function(n){console.error("æ¨èæ•°æ®è¯·æ±‚å¤±è´¥:",n),uni.showToast({title:"ç½‘ç»œé”™è¯¯",icon:"none"})}))},refreshDiscoverPosts:function(){console.log("åˆ·æ–°å‘ç°é¡µæ¨è"),this.setData({discoverPostList:[],discoverPage:0,discoverHasMore:!0,discoverShownPostIds:[],discoverRefreshTime:0}),this.loadRecommendationPosts()},refreshIndexData:function(){console.log("ã€indexã€‘å¼€å§‹åˆ·æ–°å¹¿åœºé¡µæ•°æ®"),l.clear("index_postList_cache"),this.setData({postList:[],page:0,hasMore:!0,isLoading:!1}),this.getIndexData()},callCloudFunction:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return y(n,t,Object.assign({pageTag:"index",context:this},e))}}};t.default=C,t.default.components=Object.assign({skeleton:c.default},t.default.components||{})},"4d97":function(n,t,e){"use strict";e.r(t);var a=e("aee5"),o=e.n(a);for(var i in a)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return a[n]}))}(i);t["default"]=o.a},"515a":function(n,t,e){"use strict";var a=e("b52c"),o=e.n(a);o.a},"52d1":function(n,t,e){"use strict";e.d(t,"b",(function(){return a})),e.d(t,"c",(function(){return o})),e.d(t,"a",(function(){}));var a=function(){var n=this.$createElement,t=this._self._c||n;return t("v-uni-view",{staticClass:"skeleton-wrapper"},[t("v-uni-view",{staticClass:"skeleton-poem-card"},[t("v-uni-view",{staticClass:"skeleton-original-badge skeleton-animate"}),t("v-uni-view",{staticClass:"skeleton-author-info"},[t("v-uni-view",{staticClass:"skeleton-avatar skeleton-animate"}),t("v-uni-view",{staticClass:"skeleton-name skeleton-animate"})],1),t("v-uni-view",{staticClass:"skeleton-title skeleton-animate"}),t("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate"}),t("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate"}),t("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate",staticStyle:{width:"70%"}})],1),t("v-uni-view",{staticClass:"skeleton-poem-card skeleton-secondary"},[t("v-uni-view",{staticClass:"skeleton-author-info"},[t("v-uni-view",{staticClass:"skeleton-avatar skeleton-animate"}),t("v-uni-view",{staticClass:"skeleton-name skeleton-animate"})],1),t("v-uni-view",{staticClass:"skeleton-title skeleton-animate"}),t("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate"}),t("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate",staticStyle:{width:"80%"}})],1)],1)},o=[]},5892:function(n,t,e){var a=e("c86c");t=a(!1),t.push([n.i,'\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* index.wxss */.page-indicator[data-v-32d84941]{position:fixed;top:%?100?%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);background:rgba(0,0,0,.7);color:#fff;padding:%?20?% %?40?%;border-radius:%?50?%;font-size:%?28?%;z-index:9999;-webkit-animation:pageIndicatorFadeIn-data-v-32d84941 .3s ease-in-out;animation:pageIndicatorFadeIn-data-v-32d84941 .3s ease-in-out}.page-indicator-text[data-v-32d84941]{text-align:center;font-weight:500}@-webkit-keyframes pageIndicatorFadeIn-data-v-32d84941{0%{opacity:0;-webkit-transform:translateX(-50%) translateY(%?-20?%);transform:translateX(-50%) translateY(%?-20?%)}100%{opacity:1;-webkit-transform:translateX(-50%) translateY(0);transform:translateX(-50%) translateY(0)}}@keyframes pageIndicatorFadeIn-data-v-32d84941{0%{opacity:0;-webkit-transform:translateX(-50%) translateY(%?-20?%);transform:translateX(-50%) translateY(%?-20?%)}100%{opacity:1;-webkit-transform:translateX(-50%) translateY(0);transform:translateX(-50%) translateY(0)}}.container[data-v-32d84941]{padding:%?20?%;background-color:#f7f8fa;min-height:100vh;padding-bottom:%?100?%; /* ä¸ºåº•éƒ¨tabBarç•™å‡ºç©ºé—´ */position:relative /* ä¸ºæ¶ˆæ¯å›¾æ ‡å®šä½åšå‡†å¤‡ */}\n/* æ¶ˆæ¯å›¾æ ‡å®¹å™¨ */.message-icon-container[data-v-32d84941]{position:fixed;right:%?40?%;bottom:%?280?%; /* ç§»åˆ°å‘å¸ƒæŒ‰é’®ä¸Šé¢ */width:%?80?%;height:%?80?%;background:hsla(0,0%,100%,.9);backdrop-filter:blur(%?20?%);-webkit-backdrop-filter:blur(%?20?%);border-radius:50%;display:flex;justify-content:center;align-items:center;box-shadow:0 %?4?% %?16?% rgba(0,0,0,.1);border:%?1?% solid hsla(0,0%,100%,.3);z-index:1000;transition:all .2s ease}.message-icon-container[data-v-32d84941]:active{-webkit-transform:scale(.95);transform:scale(.95);background:hsla(0,0%,100%,.8)}.message-icon[data-v-32d84941]{font-size:%?36?%;color:#333}\n/* æœªè¯»æ¶ˆæ¯çº¢ç‚¹ */.unread-dot[data-v-32d84941]{position:absolute;top:%?8?%;right:%?8?%;width:%?16?%;height:%?16?%;background-color:#ff4757;border-radius:50%;border:%?2?% solid #fff;-webkit-animation:pulse-data-v-32d84941 2s infinite;animation:pulse-data-v-32d84941 2s infinite}\n/* çº¢ç‚¹è„‰å†²åŠ¨ç”» */@-webkit-keyframes pulse-data-v-32d84941{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}50%{-webkit-transform:scale(1.2);transform:scale(1.2);opacity:.8}100%{-webkit-transform:scale(1);transform:scale(1);opacity:1}}@keyframes pulse-data-v-32d84941{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}50%{-webkit-transform:scale(1.2);transform:scale(1.2);opacity:.8}100%{-webkit-transform:scale(1);transform:scale(1);opacity:1}}\n/* æœç´¢æ¡†å®¹å™¨ */.search-box-container[data-v-32d84941]{margin-bottom:%?20?%}\n/* æœç´¢æ¡†æ ·å¼ */.search-box[data-v-32d84941]{background-color:#fff;border-radius:%?16?%;padding:%?24?% %?30?%;display:flex;align-items:center;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05);border:%?1?% solid rgba(0,0,0,.05);transition:all .2s ease}.search-box[data-v-32d84941]:active{-webkit-transform:scale(.98);transform:scale(.98);background-color:#f8f9fa}.search-icon[data-v-32d84941]{font-size:%?32?%;margin-right:%?20?%;color:#999}.search-placeholder[data-v-32d84941]{font-size:%?28?%;color:#999;flex:1}\n/* è¯»è¯—æ¨¡å¼å®¹å™¨ */.poem-mode-container[data-v-32d84941]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:linear-gradient(135deg,#667eea,#764ba2);z-index:100;overflow:hidden}\n/* æ»‘åŠ¨æŒ‡ç¤ºå™¨ */.swipe-indicator[data-v-32d84941]{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);color:hsla(0,0%,100%,.8);font-size:%?28?%;padding:%?20?% %?30?%;background:rgba(0,0,0,.3);border-radius:%?50?%;-webkit-backdrop-filter:blur(%?10?%);backdrop-filter:blur(%?10?%)}.swipe-indicator.left[data-v-32d84941]{left:%?30?%}.swipe-indicator.right[data-v-32d84941]{right:%?30?%}\n/* å¸–å­ç´¢å¼•æŒ‡ç¤ºå™¨ */.post-indicator[data-v-32d84941]{position:absolute;bottom:%?60?%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);color:hsla(0,0%,100%,.9);font-size:%?24?%;padding:%?12?% %?24?%;background:rgba(0,0,0,.4);border-radius:%?30?%;-webkit-backdrop-filter:blur(%?10?%);backdrop-filter:blur(%?10?%)}\n/* åˆ—è¡¨æ¨¡å¼å®¹å™¨ */.list-mode-container[data-v-32d84941],\n.list-content[data-v-32d84941]{display:block}\n/* å¹¿åœºæ¨¡å¼å®¹å™¨ */.square-mode-container[data-v-32d84941]{display:block}\n/* æ–°å¢ï¼šå¸–å­é¡¹åŒ…è£…å™¨æ ·å¼ */.post-item-wrapper[data-v-32d84941]{background:#fff;border-radius:%?16?%;margin-bottom:%?20?%;padding:%?30?%;box-shadow:0 %?2?% %?12?% rgba(0,0,0,.06)}\n/* åŸåˆ›å¸–å­ç‰¹æ®Šæ ·å¼ */.post-item-wrapper.original-post[data-v-32d84941]{border:%?3?% solid #ebc88d;box-shadow:0 %?4?% %?20?% rgba(235,200,141,.3),0 %?2?% %?12?% rgba(0,0,0,.06);position:relative}\n/* åŸåˆ›å¸–å­å…‰å½±æ•ˆæœ */.post-item-wrapper.original-post[data-v-32d84941]::before{content:"";position:absolute;top:%?-2?%;left:%?-2?%;right:%?-2?%;bottom:%?-2?%;background:linear-gradient(45deg,#ebc88d,#f4d03f,#ebc88d);border-radius:%?18?%;z-index:-1;opacity:.6;-webkit-filter:blur(%?8?%);filter:blur(%?8?%)}\n/* æ–°å¢ï¼šå†…å®¹å¯¼èˆªå™¨æ ·å¼ */.post-content-navigator[data-v-32d84941]{display:block;background:transparent}\n/* æ–°å¢ï¼šå¯¼èˆªå™¨ç‚¹å‡»æ•ˆæœ */.navigator-hover[data-v-32d84941]{background-color:rgba(0,0,0,.02)}\n/* æ–°å¢ï¼šç‚¹èµæŒ‰é’®å®¹å™¨æ ·å¼ */.like-icon-container[data-v-32d84941]{padding:%?10?%;border-radius:50%;transition:all .2s ease}\n/* æ–°å¢ï¼šç‚¹èµæŒ‰é’®ç‚¹å‡»æ•ˆæœ */.like-icon-container[data-v-32d84941]:active{-webkit-transform:scale(.9);transform:scale(.9);background-color:hsla(0,100%,71%,.1)}\n/* æ–°å¢ï¼šç‚¹èµå›¾æ ‡æ ·å¼ */.like-icon[data-v-32d84941]{width:%?40?%;height:%?40?%;transition:all .2s ease}.author-info[data-v-32d84941]{display:flex;align-items:center;margin-bottom:%?15?%}.author-avatar[data-v-32d84941]{width:%?60?%;height:%?60?%;border-radius:50%;margin-right:%?15?%;background-color:#f5f5f5}.author-name[data-v-32d84941]{font-size:%?28?%;color:#333;font-weight:500}\n/* æ–°å¢ï¼šå›¾ç‰‡å®¹å™¨å ä½æ ·å¼ */.image-container-wrapper[data-v-32d84941]{position:relative;width:100%;background-color:#f0f0f0; /* å ä½æ—¶çš„èƒŒæ™¯è‰²ï¼Œå¾ˆé‡è¦ */overflow:hidden;border-radius:8px; /* å¯ä»¥åŠ ä¸ªåœ†è§’ï¼Œè®©å ä½å—æ›´å¥½çœ‹ */margin:%?20?% 0 /* å›¾ç‰‡å’Œä¸‹æ–¹å†…å®¹çš„é—´è· */}\n/* æ–°å¢ï¼šè®©å›¾ç‰‡æˆ–Swiperå¡«å……æ•´ä¸ªå ä½å®¹å™¨ */.image-container-wrapper .post-image[data-v-32d84941],\n.image-container-wrapper .image-swiper[data-v-32d84941]{position:absolute;top:0;left:0;width:100%;height:100%}\n/* å¤šå›¾å®¹å™¨ */.multi-image-container[data-v-32d84941]{width:100%;position:relative}\n/* å•å›¾å®¹å™¨ */.single-image-container[data-v-32d84941]{width:100%;position:relative}\n/* å¤šå¼ å›¾ç‰‡çš„swiperæ ·å¼ */.image-swiper[data-v-32d84941]{width:100%;background-color:#fff\n    /* é«˜åº¦ç”± style ç»‘å®šåŠ¨æ€è®¾ç½® */}.swiper-item[data-v-32d84941]{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.post-image[data-v-32d84941]{width:100%;height:100%;display:block;object-fit:contain}.post-image[data-v-32d84941]:active{-webkit-transform:scale(1.05);transform:scale(1.05)}.post-image.single-image[data-v-32d84941]{width:100%;height:auto;display:block;background-color:#f5f5f5}\n/* å›¾ç‰‡æ•°é‡æŒ‡ç¤ºå™¨ */.image-count-indicator[data-v-32d84941]{position:absolute;top:%?20?%;right:%?20?%;background-color:rgba(0,0,0,.6);color:#fff;padding:%?8?% %?16?%;border-radius:%?20?%;font-size:%?24?%;z-index:10;-webkit-backdrop-filter:blur(%?10?%);backdrop-filter:blur(%?10?%)}\n/* å¡ç‰‡é¡¹æ ·å¼ */.post-item-wrapper[data-v-32d84941]{margin-bottom:%?20?%}\n/* å¤–éƒ¨ä½œè€…ä¿¡æ¯æ ·å¼ */.author-info-outside[data-v-32d84941]{display:flex;align-items:center;padding:%?20?% %?30?% %?10?% %?30?%;background:#fff;border-radius:%?16?% %?16?% 0 0;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05)}.author-info-outside .author-avatar[data-v-32d84941]{width:%?60?%;height:%?60?%;border-radius:50%;margin-right:%?15?%;background-color:#f5f5f5;cursor:pointer}.author-info-outside .author-name[data-v-32d84941]{font-size:%?28?%;color:#333;font-weight:500}.post-item[data-v-32d84941]{width:100%;background:#fff;border-radius:0 0 %?16?% %?16?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05);box-sizing:border-box;padding:%?20?% %?30?% %?30?% %?30?%}\n/* å®šä¹‰ç‚¹å‡»æ—¶çš„æ ·å¼ - æ•´ä¸ªå¡ç‰‡ç¼©å° */.post-card-active[data-v-32d84941]{-webkit-transform:scale(.98);transform:scale(.98)}.post-title[data-v-32d84941]{font-size:%?36?%;font-weight:700;color:#333;margin-bottom:%?15?%;line-height:1.4;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical}\n/* è¯—æ­Œä½œè€…æ ·å¼ */.poem-author[data-v-32d84941]{font-size:%?32?%;color:#000;text-align:center;margin:%?5?% 0 %?15?% 0;letter-spacing:%?2?%}.post-content[data-v-32d84941]{font-size:%?28?%;color:#666;line-height:1.6;margin-top:%?15?%;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical}.add-button[data-v-32d84941]{position:fixed;right:%?40?%;bottom:%?160?%;width:%?80?%; /* ä»100rpxè°ƒæ•´ä¸º80rpx */height:%?80?%; /* ä»100rpxè°ƒæ•´ä¸º80rpx */background:rgba(135,206,235,.8); /* æ”¹ä¸ºæ·¡è“è‰² */backdrop-filter:blur(%?20?%);-webkit-backdrop-filter:blur(%?20?%);border-radius:50%;display:flex;justify-content:center;align-items:center;color:#fff;font-size:%?48?%; /* ç›¸åº”è°ƒæ•´å­—ä½“å¤§å° */box-shadow:0 %?8?% %?32?% rgba(0,0,0,.1);border:%?1?% solid hsla(0,0%,100%,.2);z-index:100;transition:-webkit-transform .2s ease;transition:transform .2s ease;transition:transform .2s ease,-webkit-transform .2s ease}.add-button[data-v-32d84941]:active{-webkit-transform:scale(.9);transform:scale(.9)}.vote-section[data-v-32d84941]{display:flex;justify-content:space-between;align-items:center;margin-top:%?20?%;padding-top:%?20?%;border-top:%?1?% solid #f0f0f0}.vote-count[data-v-32d84941],\n.comment-count[data-v-32d84941]{display:flex;align-items:center;font-size:%?28?%;color:#999;margin-left:%?10?%;transition:color .2s ease}.vote-count[data-v-32d84941]{margin-left:%?10?%}.vote-count.voted[data-v-32d84941]{color:#ff4757}.actions-left[data-v-32d84941]{display:flex;align-items:center}.action-emoji[data-v-32d84941]{font-size:%?28?%;margin-right:%?8?%}.action-text[data-v-32d84941]{font-size:%?28?%;color:inherit}.button-group[data-v-32d84941]{display:flex;align-items:center}.like-icon-container[data-v-32d84941]{display:flex;align-items:center;justify-content:center;padding:%?8?%;border-radius:%?8?%;margin-left:%?20?%;transition:all .2s ease}.like-icon-container[data-v-32d84941]:active{-webkit-transform:scale(.95);transform:scale(.95)}.like-icon[data-v-32d84941]{width:%?48?%;height:%?48?%}\n/* ç©ºçŠ¶æ€æ ·å¼ */.empty-state[data-v-32d84941]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:%?100?% %?40?%;text-align:center}.empty-icon[data-v-32d84941]{font-size:%?120?%;margin-bottom:%?30?%;opacity:.6}.empty-text[data-v-32d84941]{font-size:%?32?%;color:#666;margin-bottom:%?15?%}.empty-subtext[data-v-32d84941]{font-size:%?28?%;color:#999}\n/* åŠ è½½æ›´å¤šæ ·å¼ */.loading-more[data-v-32d84941]{display:flex;justify-content:center;align-items:center;padding:%?40?%}.loading-text[data-v-32d84941]{font-size:%?28?%;color:#999}\n/* åº•éƒ¨åŠ è½½çŠ¶æ€æ ·å¼ */.loading-footer[data-v-32d84941]{text-align:center;padding:%?20?% 0;color:#999;font-size:14px}\n/* æ ‡ç­¾æ ·å¼ */.post-tags[data-v-32d84941]{margin-top:%?30?%;margin-bottom:%?10?%;line-height:1.5}.post-tag[data-v-32d84941]{color:#24375f;font-size:%?26?%;margin-right:%?10?%;transition:all .2s ease;cursor:pointer}.post-tag[data-v-32d84941]:active{color:#1a2a4a;opacity:.8}\n/* å‘ç°é¡µæ¨èç›¸å…³æ ·å¼ */.discover-end-tip[data-v-32d84941]{display:flex;flex-direction:column;align-items:center;padding:%?40?% %?20?%;color:#999}.end-text[data-v-32d84941]{font-size:%?28?%;margin-bottom:%?20?%}.refresh-tip[data-v-32d84941]{background:rgba(255,193,7,.1);border:%?2?% solid rgba(255,193,7,.3);border-radius:%?20?%;padding:%?16?% %?24?%}.refresh-text[data-v-32d84941]{font-size:%?24?%;color:#ffc107;font-weight:500}',""]),n.exports=t},"8cb3":function(n,t,e){"use strict";e.r(t);var a=e("52d1"),o=e("4d97");for(var i in o)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return o[n]}))}(i);e("515a");var s=e("828b"),r=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,"a51e8920",null,!1,a["a"],void 0);t["default"]=r.exports},9066:function(n,t,e){"use strict";e.r(t);var a=e("c455"),o=e("da71");for(var i in o)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return o[n]}))}(i);e("b1b0");var s=e("828b"),r=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,"32d84941",null,!1,a["a"],void 0);t["default"]=r.exports},aee5:function(n,t,e){"use strict";e("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={data:function(){return{}},props:{},methods:{},created:function(){}}},b1b0:function(n,t,e){"use strict";var a=e("1b25"),o=e.n(a);o.a},b52c:function(n,t,e){var a=e("ee16");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);var o=e("967d").default;o("77236fde",a,!0,{sourceMap:!1,shadowMode:!1})},c455:function(n,t,e){"use strict";e.d(t,"b",(function(){return o})),e.d(t,"c",(function(){return i})),e.d(t,"a",(function(){return a}));var a={skeleton:e("8cb3").default},o=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("v-uni-view",[e("v-uni-view",{staticClass:"container",on:{touchstart:function(t){arguments[0]=t=n.$handleEvent(t),n.touchStart.apply(void 0,arguments)},touchend:function(t){arguments[0]=t=n.$handleEvent(t),n.touchEnd.apply(void 0,arguments)}}},[n.showPageIndicator?e("v-uni-view",{staticClass:"page-indicator"},[e("v-uni-view",{staticClass:"page-indicator-text"},[n._v(n._s(n.pageIndicatorText))])],1):n._e(),e("v-uni-view",{staticClass:"message-icon-container",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.navigateToMessages.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"message-icon"},[n._v("âœ‰ï¸")]),n.unreadMessageCount>0?e("v-uni-view",{staticClass:"unread-dot"}):n._e()],1),e("v-uni-view",{staticClass:"search-box-container"},[e("v-uni-view",{staticClass:"search-box",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.navigateToSearch.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"search-icon"},[n._v("ğŸ”")]),e("v-uni-view",{staticClass:"search-placeholder"},[n._v("æœç´¢å¸–å­...")])],1)],1),n.isLoading?e("v-uni-view",[e("skeleton")],1):e("v-uni-view",{staticClass:"square-mode-container"},[0!==n.postList.length||n.isLoading?n._e():e("v-uni-view",{staticClass:"empty-state"},[e("v-uni-view",{staticClass:"empty-icon"},[n._v("ğŸ“")]),e("v-uni-view",{staticClass:"empty-text"},[n._v("è¿˜æ²¡æœ‰å¸–å­å“¦ï½")]),e("v-uni-view",{staticClass:"empty-subtext"},[n._v("å¿«æ¥å‘å¸ƒç¬¬ä¸€æ¡å¸–å­å§ï¼")])],1),e("v-uni-view",{attrs:{id:"post-list-container"}},["home"===n.currentPage?e("v-uni-view",n._l(n.postList,(function(t,a){return e("v-uni-view",{key:a,class:"post-item-wrapper "+(t.isOriginal?"original-post":"")},[e("v-uni-view",{staticClass:"author-info-outside"},[t.authorAvatar?e("v-uni-image",{staticClass:"author-avatar",attrs:{src:t.authorAvatar,mode:"aspectFill","data-postindex":a,"data-user-id":t._openid},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onAvatarError.apply(void 0,arguments)},load:function(t){arguments[0]=t=n.$handleEvent(t),n.onAvatarLoad.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.navigateToUserProfile.apply(void 0,arguments)}}}):n._e(),e("v-uni-text",{staticClass:"author-name"},[n._v(n._s(t.authorName))])],1),e("v-uni-navigator",{staticClass:"post-content-navigator",attrs:{url:"/pages/post-detail/post-detail?id="+t._id,"hover-class":"navigator-hover"}},[e("v-uni-view",{staticClass:"post-item"},[e("v-uni-view",{staticClass:"post-title"},[n._v(n._s(t.title))]),t.isPoem&&t.author?e("v-uni-view",{staticClass:"poem-author"},[n._v(n._s(t.author))]):n._e(),t.imageUrls&&t.imageUrls.length>0?e("v-uni-view",{staticClass:"image-container-wrapper",style:t.imageStyle,attrs:{"data-src":t.imageUrls[0],"data-original-image-urls":t.originalImageUrls||t.imageUrls},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.handlePreview.apply(void 0,arguments)}}},[1===t.imageUrls.length?[e("v-uni-image",{staticClass:"post-image",attrs:{src:t.imageUrls[0],mode:"aspectFill","lazy-load":!0,"data-src":t.imageUrls[0],"data-original-image-urls":t.originalImageUrls||t.imageUrls},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onImageError.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.handlePreview.apply(void 0,arguments)}}})]:t.imageUrls.length>1?[e("v-uni-swiper",{staticClass:"image-swiper",attrs:{"indicator-dots":!0,circular:!0}},[n._l(t.imageUrls,(function(a,o){return[e("v-uni-swiper-item",[e("v-uni-image",{staticClass:"post-image",attrs:{src:a,mode:"aspectFill","lazy-load":!0,"data-src":a,"data-original-image-urls":t.originalImageUrls||t.imageUrls},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onImageError.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.handlePreview.apply(void 0,arguments)}}})],1)]}))],2)]:n._e()],2):n._e(),t.content?e("v-uni-view",{staticClass:"post-content",staticStyle:{"white-space":"pre-wrap"}},[n._v(n._s(t.content))]):n._e(),t.tags&&t.tags.length>0?e("v-uni-view",{staticClass:"post-tags"},n._l(t.tags,(function(t,a){return e("v-uni-text",{key:a,staticClass:"post-tag",attrs:{"data-tag":t},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.onTagClick.apply(void 0,arguments)}}},[n._v("#"+n._s(t))])})),1):n._e()],1)],1),e("v-uni-view",{staticClass:"vote-section"},[e("v-uni-view",{staticClass:"actions-left"}),e("v-uni-view",{staticClass:"button-group"},[e("v-uni-view",{staticClass:"comment-count",attrs:{"data-postid":t._id},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.onCommentClick.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"action-emoji"},[n._v("ğŸ’¬")]),e("v-uni-text",{staticClass:"action-text"},[n._v(n._s(t.commentCount||0))])],1),e("v-uni-view",{staticClass:"like-icon-container",attrs:{"data-postid":t._id,"data-index":a},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.onVote.apply(void 0,arguments)}}},[e("v-uni-image",{staticClass:"like-icon",attrs:{src:t.likeIcon||"/static/images/seed.png",mode:"aspectFit"},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onLikeIconError.apply(void 0,arguments)}}})],1),e("v-uni-view",{class:"vote-count "+(t.isVoted?"voted":"")},[e("v-uni-text",{staticClass:"action-text"},[n._v(n._s(t.votes||0))])],1)],1)],1)],1)})),1):"discover"===n.currentPage?e("v-uni-view",[0!==n.discoverPostList.length||n.isLoading?n._e():e("v-uni-view",{staticClass:"empty-state"},[e("v-uni-view",{staticClass:"empty-icon"},[n._v("ğŸ”")]),e("v-uni-view",{staticClass:"empty-text"},[n._v("å‘ç°é¡µæš‚æ— å†…å®¹")]),e("v-uni-view",{staticClass:"empty-subtext"},[n._v("æ¨èç®—æ³•æ­£åœ¨å­¦ä¹ ä¸­...")])],1),n._l(n.discoverPostList,(function(t,a){return e("v-uni-view",{key:a,class:"post-item-wrapper "+(t.isOriginal?"original-post":"")},[e("v-uni-view",{staticClass:"author-info-outside"},[t.authorAvatar?e("v-uni-image",{staticClass:"author-avatar",attrs:{src:t.authorAvatar,mode:"aspectFill","data-postindex":a,"data-user-id":t._openid},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onAvatarError.apply(void 0,arguments)},load:function(t){arguments[0]=t=n.$handleEvent(t),n.onAvatarLoad.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.navigateToUserProfile.apply(void 0,arguments)}}}):n._e(),e("v-uni-text",{staticClass:"author-name"},[n._v(n._s(t.authorName))])],1),e("v-uni-navigator",{staticClass:"post-content-navigator",attrs:{url:"/pages/post-detail/post-detail?id="+t._id,"hover-class":"navigator-hover"}},[e("v-uni-view",{staticClass:"post-item"},[e("v-uni-view",{staticClass:"post-title"},[n._v(n._s(t.title))]),t.isPoem&&t.author?e("v-uni-view",{staticClass:"poem-author"},[n._v(n._s(t.author))]):n._e(),t.imageUrls&&t.imageUrls.length>0?e("v-uni-view",{staticClass:"image-container-wrapper",style:t.imageStyle,attrs:{"data-src":t.imageUrls[0],"data-original-image-urls":t.originalImageUrls||t.imageUrls},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.handlePreview.apply(void 0,arguments)}}},[1===t.imageUrls.length?[e("v-uni-image",{staticClass:"post-image",attrs:{src:t.imageUrls[0],mode:"aspectFill","lazy-load":!0,"data-src":t.imageUrls[0],"data-original-image-urls":t.originalImageUrls||t.imageUrls},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onImageError.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.handlePreview.apply(void 0,arguments)}}})]:t.imageUrls.length>1?[e("v-uni-swiper",{staticClass:"image-swiper",attrs:{"indicator-dots":!0,circular:!0}},[n._l(t.imageUrls,(function(a,o){return[e("v-uni-swiper-item",[e("v-uni-image",{staticClass:"post-image",attrs:{src:a,mode:"aspectFill","lazy-load":!0,"data-src":a,"data-original-image-urls":t.originalImageUrls||t.imageUrls},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onImageError.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.handlePreview.apply(void 0,arguments)}}})],1)]}))],2)]:n._e()],2):n._e(),t.content?e("v-uni-view",{staticClass:"post-content",staticStyle:{"white-space":"pre-wrap"}},[n._v(n._s(t.content))]):n._e(),t.tags&&t.tags.length>0?e("v-uni-view",{staticClass:"post-tags"},n._l(t.tags,(function(t,a){return e("v-uni-text",{key:a,staticClass:"post-tag",attrs:{"data-tag":t},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.onTagClick.apply(void 0,arguments)}}},[n._v("#"+n._s(t))])})),1):n._e()],1)],1),e("v-uni-view",{staticClass:"vote-section"},[e("v-uni-view",{staticClass:"actions-left"}),e("v-uni-view",{staticClass:"button-group"},[e("v-uni-view",{staticClass:"comment-count",attrs:{"data-postid":t._id},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.onCommentClick.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"action-emoji"},[n._v("ğŸ’¬")]),e("v-uni-text",{staticClass:"action-text"},[n._v(n._s(t.commentCount||0))])],1),e("v-uni-view",{staticClass:"like-icon-container",attrs:{"data-postid":t._id,"data-index":a},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.onVote.apply(void 0,arguments)}}},[e("v-uni-image",{staticClass:"like-icon",attrs:{src:t.likeIcon||"/static/images/seed.png",mode:"aspectFit"},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onLikeIconError.apply(void 0,arguments)}}})],1),e("v-uni-view",{class:"vote-count "+(t.isVoted?"voted":"")},[e("v-uni-text",{staticClass:"action-text"},[n._v(n._s(t.votes||0))])],1)],1)],1)],1)}))],2):n._e()],1),e("v-uni-view",{staticClass:"loading-footer"},[n.isLoadingMore?[e("v-uni-text",[n._v("æ­£åœ¨åŠ è½½...")])]:"home"===n.currentPage&&!n.hasMore&&n.postList.length>0?[e("v-uni-text",[n._v("--- æˆ‘æ˜¯æœ‰åº•çº¿çš„ ---")])]:"discover"===n.currentPage&&!n.discoverHasMore&&n.discoverPostList.length>0?[e("v-uni-view",{staticClass:"discover-end-tip"},[e("v-uni-text",{staticClass:"end-text"},[n._v("--- æ²¡æœ‰æ›´å¤šäº† ---")]),e("v-uni-view",{staticClass:"refresh-tip"},[e("v-uni-text",{staticClass:"refresh-text"},[n._v("ä¸‹æ‹‰åˆ·æ–°è·å–æ–°çš„æ¨è")])],1)],1)]:n._e()],2)],1),e("v-uni-navigator",{staticClass:"add-button",attrs:{url:"/pages/add/add"}},[e("v-uni-view",[n._v("+")])],1)],1)],1)},i=[]},d87a:function(n,t,e){"use strict";e("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentTabBarStatus=function(n){try{if("function"===typeof n.getTabBar&&n.getTabBar()){var t,e=n.getTabBar();return(null===(t=e.data)||void 0===t?void 0:t.selected)||null}}catch(i){console.log("æ— æ³•ä»åŸç”ŸgetTabBarè·å–çŠ¶æ€")}try{var a,o=null===(a=n.$refs)||void 0===a?void 0:a.customTabBar;if(o&&o.data)return o.data.selected||null}catch(i){console.log("æ— æ³•ä»è‡ªå®šä¹‰ç»„ä»¶è·å–çŠ¶æ€")}try{return uni.getStorageSync("currentTabIndex")||null}catch(i){console.log("æ— æ³•ä»å­˜å‚¨è·å–çŠ¶æ€")}return null},t.isTabBarSupported=function(){try{return!("undefined"===typeof wx||!wx.getTabBar)||!("undefined"===typeof uni||!uni.getTabBar)}catch(n){return!1}},t.updateTabBarStatus=function(n,t){try{if("function"===typeof n.getTabBar&&n.getTabBar())return n.getTabBar().setData({selected:t}),console.log("TabBarçŠ¶æ€æ›´æ–°æˆåŠŸ (åŸç”ŸAPI): selected=".concat(t)),!0}catch(e){console.log("åŸç”ŸgetTabBar APIä¸å¯ç”¨:",e.message)}try{return uni.setStorageSync("currentTabIndex",t),console.log("TabBarçŠ¶æ€å·²ä¿å­˜åˆ°å­˜å‚¨: selected=".concat(t)),!0}catch(e){console.log("å­˜å‚¨æœºåˆ¶ä¸å¯ç”¨:",e.message)}return console.warn("åŸç”ŸgetTabBar APIä¸å¯ç”¨ï¼Œå½“å‰å¹³å°å¯èƒ½ä¸æ”¯æŒgetTabBar()"),!1}},da71:function(n,t,e){"use strict";e.r(t);var a=e("2cf2"),o=e.n(a);for(var i in a)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return a[n]}))}(i);t["default"]=o.a},df61:function(n,t,e){var a=e("dd7e").default,o=e("46c5").default;e("64aa"),e("bf0f"),e("7a76"),e("c9b5");var i=e("11ca"),s=i.cloudCall,r=e("fe58"),c=null;try{c=e("b99c")}catch(p){console.warn("[likeService] dataCache ä¸å¯ç”¨ï¼Œè·³è¿‡ç¼“å­˜åŒæ­¥")}function l(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=Number(n);return Number.isFinite(e)?e:t}function d(n,t,e){if("function"===typeof n)try{return n(t,e)}catch(p){console.warn("[likeService] likeIcon resolver æ‰§è¡Œå¤±è´¥",p)}return r.getLikeIcon(t,e)}function u(n){var t=n.votes,e=n.isLiked,a=n.icon;return{votes:t,isLiked:e,likeIcon:a}}function g(n){if("undefined"!==typeof uni&&"function"===typeof uni.showToast)try{uni.showToast({title:n||"æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•",icon:"none"})}catch(p){console.warn("[likeService] showToast è°ƒç”¨å¤±è´¥",p)}}function v(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.pageTag,e=void 0===t?"like-service":t,a=n.context,o=void 0===a?null:a,i=n.currentVotes,s=void 0===i?0:i,c=n.currentIsLiked,d=void 0!==c&&c,u=n.likeIconResolver,g=void 0===u?r.getLikeIcon:u,v=n.requireAuth,f=void 0===v||v,p=n.retry,h=void 0===p?0:p,m=n.updateCache,b=void 0===m||m,w=n.showErrorToast,k=void 0===w||w,y=n.cloudOptions,x=void 0===y?{}:y;return{pageTag:e,context:o,currentVotes:l(s,0),currentIsLiked:Boolean(d),likeIconResolver:g,requireAuth:f,retry:h,updateCache:b,showErrorToast:k,cloudOptions:x}}function f(){return f=o(a().mark((function n(t){var e,o,i,r,f,p,h,m,b,w,k,y,x,C,I,P,T,L,_,D,M,S,U,E=arguments;return a().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e=E.length>1&&void 0!==E[1]?E[1]:{},t){n.next=3;break}return n.abrupt("return",Promise.reject(new Error("[likeService] postId ä¸èƒ½ä¸ºç©º")));case 3:return o=v(e),i=o.pageTag,r=o.context,f=o.currentVotes,p=o.currentIsLiked,h=o.likeIconResolver,m=o.requireAuth,b=o.retry,w=o.updateCache,k=o.showErrorToast,y=o.cloudOptions,x=l(f,0),C=Boolean(p),I=d(h,x,C),P=u({votes:x,isLiked:C,icon:I}),n.prev=8,n.next=11,s("vote",{postId:t},Object.assign({pageTag:"likeService:".concat(i),context:r,requireAuth:m,retry:b},y));case 11:T=n.sent,n.next=19;break;case 14:return n.prev=14,n.t0=n["catch"](8),console.error("[likeService] è°ƒç”¨äº‘å‡½æ•°å¤±è´¥",n.t0),k&&g(n.t0&&n.t0.message),n.abrupt("return",{success:!1,error:n.t0,rollback:P});case 19:if(L=T&&T.result?T.result:T,_=L&&!0===L.success,_){n.next=26;break}return D=L&&L.message?L.message:"æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•",console.warn("[likeService] äº‘å‡½æ•°è¿”å›å¤±è´¥ç»“æœ",L),k&&g(D),n.abrupt("return",{success:!1,error:L,rollback:P});case 26:if(M=l(L.votes,x),S=Boolean(L.isLiked),U=d(h,M,S),w&&c&&"function"===typeof c.updatePostLikeInCache)try{c.updatePostLikeInCache(t,M,S,U)}catch(a){console.warn("[likeService] åŒæ­¥ç¼“å­˜å¤±è´¥",a)}return n.abrupt("return",{success:!0,votes:M,isLiked:S,likeIcon:U,response:L});case 31:case"end":return n.stop()}}),n,null,[[8,14]])}))),f.apply(this,arguments)}n.exports={togglePostLike:function(n){return f.apply(this,arguments)}}},ee16:function(n,t,e){var a=e("c86c");t=a(!1),t.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* components/skeleton/skeleton.wxss */.skeleton-wrapper[data-v-a51e8920]{width:100%;height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:%?20?%;box-sizing:border-box}\n/* è¯»è¯—é¡µéª¨æ¶å±å¡ç‰‡æ ·å¼ - åŒ¹é…è¯»è¯—é¡µè®¾è®¡ */.skeleton-poem-card[data-v-a51e8920]{width:calc(100% - %?40?%);height:calc(100% - %?80?%);display:flex;flex-direction:column;padding:%?40?% %?20?%;box-sizing:border-box;background:hsla(0,0%,100%,.95);margin:%?40?% %?20?%;border-radius:%?24?%;box-shadow:0 %?8?% %?32?% rgba(0,0,0,.1);position:relative}\n/* ç¬¬äºŒä¸ªå¡ç‰‡é€æ˜åº¦é™ä½ */.skeleton-poem-card.skeleton-secondary[data-v-a51e8920]{opacity:.6;position:absolute;top:%?20?%;left:%?20?%;right:%?20?%;bottom:%?20?%;z-index:-1;-webkit-transform:scale(.95);transform:scale(.95)}\n/* åŸåˆ›æ ‡è¯†éª¨æ¶ */.skeleton-original-badge[data-v-a51e8920]{position:absolute;top:%?20?%;right:%?20?%;width:%?80?%;height:%?40?%;border-radius:%?20?%}\n/* ä½œè€…ä¿¡æ¯éª¨æ¶ */.skeleton-author-info[data-v-a51e8920]{display:flex;align-items:center;margin-bottom:%?15?%;padding-bottom:%?10?%}.skeleton-avatar[data-v-a51e8920]{width:%?80?%;height:%?80?%;border-radius:50%;margin-right:%?20?%}.skeleton-name[data-v-a51e8920]{width:%?200?%;height:%?32?%;border-radius:%?16?%}\n/* å±…ä¸­æ ‡é¢˜éª¨æ¶ */.skeleton-title[data-v-a51e8920]{width:60%;height:%?40?%;margin:0 auto %?20?% auto; /* å±…ä¸­å¹¶å¢åŠ ä¸‹è¾¹è· */border-radius:%?20?%;text-align:center}\n/* å¤§å†…å®¹åŒºåŸŸéª¨æ¶ */.skeleton-content-large[data-v-a51e8920]{width:100%;height:%?40?%;margin-bottom:%?20?%;border-radius:%?20?%}.skeleton-animate[data-v-a51e8920]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0 50%,#f0f0f0 75%);background-size:200% 100%;-webkit-animation:skeleton-loading-data-v-a51e8920 1.5s infinite linear;animation:skeleton-loading-data-v-a51e8920 1.5s infinite linear}@-webkit-keyframes skeleton-loading-data-v-a51e8920{0%{background-position:200% 0}100%{background-position:-200% 0}}@keyframes skeleton-loading-data-v-a51e8920{0%{background-position:200% 0}100%{background-position:-200% 0}}",""]),n.exports=t},f806:function(n,t,e){var a=e("dd7e").default,o=e("4cf1").default,i=e("46c5").default,s=e("883d").default,r=e("4db6").default;e("c1a3"),e("bf0f"),e("18f7"),e("de6c"),e("f7a5");var c=e("1d0b"),l=function(){"use strict";function n(){s(this,n),this.cache=new Map,this.preloadQueue=[],this.maxPreloadCount=3,this.isH5="undefined"!==typeof window}return r(n,[{key:"preloadImages",value:function(){var n=i(a().mark((function n(t,e){var i,s,r,l,d;return a().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(Array.isArray(t)&&0!==t.length){n.next=2;break}return n.abrupt("return");case 2:i=t.slice(0,this.maxPreloadCount),s=o(i),n.prev=4,s.s();case 6:if((r=s.n()).done){n.next=24;break}if(l=r.value,!this.cache.has(l)){n.next=11;break}return e&&e(l,!0),n.abrupt("continue",22);case 11:return n.prev=11,n.next=14,c.loadImage(l,{useCache:!0,fallbackToOriginal:!0});case 14:d=n.sent,d.success?(this.cache.set(l,d.url),e&&e(l,!0)):(console.error("å›¾ç‰‡é¢„åŠ è½½å¤±è´¥:",l,d.error),e&&e(l,!1)),n.next=22;break;case 18:n.prev=18,n.t0=n["catch"](11),console.error("å›¾ç‰‡é¢„åŠ è½½å¼‚å¸¸:",l,n.t0),e&&e(l,!1);case 22:n.next=6;break;case 24:n.next=29;break;case 26:n.prev=26,n.t1=n["catch"](4),s.e(n.t1);case 29:return n.prev=29,s.f(),n.finish(29);case 32:case"end":return n.stop()}}),n,this,[[4,26,29,32],[11,18]])})));return function(t,e){return n.apply(this,arguments)}}()},{key:"getCachedImage",value:function(n){return this.cache.get(n)||n}},{key:"clearCache",value:function(){this.cache.clear()}},{key:"getCacheSize",value:function(){return this.cache.size}}]),n}(),d=new l;n.exports=d},fcd5:function(n,t,e){var a=e("5014").default,o=e("d189").default,i=e("4cf1").default;e("8f71"),e("bf0f"),e("aa9c"),e("fd3c");var s=e("139b"),r=s.formatRelativeTime,c=["createTime","postCreateTime","publishTime","createdAt","updateTime"],l=function(n){return n?Array.isArray(n)?n.filter(Boolean):[n].filter(Boolean):[]},d=function(n){var t,e=i(c);try{for(e.s();!(t=e.n()).done;){var a=t.value;if(n[a])return{key:a,value:n[a]}}}catch(o){e.e(o)}finally{e.f()}return null},u=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.withTime,i=void 0===e||e,s=l(n.imageUrls);0===s.length&&s.push.apply(s,o(l(n.imageUrl)));var c=l(n.originalImageUrls);0===c.length&&c.push.apply(c,o(l(n.originalImageUrl))),0===c.length&&s.length>0&&c.push.apply(c,o(s));var u=a(a({},n),{},{imageUrls:s,originalImageUrls:c,authorName:n.authorName||"åŒ¿åç”¨æˆ·",authorAvatar:"string"===typeof n.authorAvatar?n.authorAvatar:""});if(!u.imageStyle&&s.length>0&&(u.imageStyle="height: 0; padding-bottom: 75%;"),i)if(n.formattedCreateTime)u.formattedCreateTime=n.formattedCreateTime;else{var g=d(n);g&&(u.formattedCreateTime=r(g.value))}return u};n.exports={normalizePost:u,normalizePostList:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Array.isArray(n)?n.map((function(n){return u(n,t)})):[]}}},fe58:function(n,t){n.exports={getLikeIcon:function(n,t){var e="";return e=n<=3?t?"seedplus.png":"seed.png":n<=7?t?"leafplus.png":"leaf.png":n<=15?t?"flowerplus .png":"flower.png":t?"peachplus.png":"peach.png","/static/images/"+e},getLikeIconDescription:function(n){return n<=3?"ç§å­":n<=7?"å¶å­":n<=15?"èŠ±":"æœå®"}}}}]);