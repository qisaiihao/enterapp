(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-preview-preview"],{8227:function(t,e,i){var a=i("c86c");e=a(!1),e.push([t.i,".white-bg[data-v-b625919e]{background:#fff;min-height:100vh;position:relative}.square-mode-container[data-v-b625919e]{padding:%?40?%;margin-bottom:%?160?%; /* 为底部按钮留出空间 */padding-top:%?100?% /* 增加顶部边距，与屏幕顶部保持距离 */}\n\n/* 底部按钮组 */.bottom-buttons[data-v-b625919e]{position:fixed;bottom:0;left:0;right:0;background:#fff;padding:%?30?% %?40?% %?60?% %?40?%;display:flex;justify-content:space-around;align-items:center;z-index:1000}.button-item[data-v-b625919e]{display:flex;align-items:center;justify-content:center;padding:%?20?%;min-width:%?120?%;transition:all .2s ease}.button-item[data-v-b625919e]:active{-webkit-transform:scale(.9);transform:scale(.9);opacity:.8}.button-icon[data-v-b625919e]{width:%?80?%;height:%?80?%}.empty-state[data-v-b625919e]{text-align:center;padding:%?100?% 0;color:#999}.empty-icon[data-v-b625919e]{font-size:%?80?%;margin-bottom:%?20?%}.empty-text[data-v-b625919e]{font-size:%?32?%;color:#666}.post-item-wrapper[data-v-b625919e]{border-radius:%?40?%;overflow:hidden;border:%?1?% solid #e9ecef;box-shadow:0 %?12?% %?15?% rgba(0,0,0,.2);transition:-webkit-transform .3s ease;transition:transform .3s ease;transition:transform .3s ease,-webkit-transform .3s ease}.post-item-wrapper[data-v-b625919e]:active{-webkit-transform:scale(.98);transform:scale(.98)}.post-content-navigator[data-v-b625919e]{display:block;cursor:pointer}.post-item[data-v-b625919e]{padding:%?40?% %?50?%;position:relative}.post-content[data-v-b625919e]{font-size:%?32?%;line-height:1.6;margin:%?30?% 0;width:100%}\n\n/* 折叠态：多端兼容的三行裁切 */.post-content.collapsed[data-v-b625919e]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;overflow:hidden;text-overflow:ellipsis}.post-content.expanded[data-v-b625919e]{display:block;overflow:visible}.user-signature[data-v-b625919e]{position:absolute;bottom:%?-25?%;right:%?60?%;z-index:10;pointer-events:none}.signature-image[data-v-b625919e]{width:%?180?%;height:%?90?%;opacity:.8;-webkit-filter:drop-shadow(0 %?2?% %?4?% rgba(0,0,0,.1));filter:drop-shadow(0 %?2?% %?4?% rgba(0,0,0,.1));display:block;background:transparent}\n\n/* 标题输入区域样式 */.title-input-section[data-v-b625919e]{margin-top:%?30?%;padding:0 %?20?%}.title-input-wrapper[data-v-b625919e]{background:#fff;border-bottom:%?2?% solid #333;padding:0 0 %?0?% 0;position:relative;width:80%;margin-right:auto}.title-input[data-v-b625919e]{width:100%;height:%?60?%;border:none;font-size:%?28?%;background:transparent;outline:none;color:#333;line-height:1}.title-input[data-v-b625919e]:focus{border-bottom:none}\n\n/* 作者输入区域样式 */.author-input-section[data-v-b625919e]{margin-top:%?40?%;padding:0 %?20?%}.author-input-wrapper[data-v-b625919e]{background:#fff;border-bottom:%?2?% solid #333;padding:0 0 %?8?% 0;position:relative;width:80%;margin-right:auto}.author-input[data-v-b625919e]{width:100%;height:%?60?%;border:none;font-size:%?28?%;background:transparent;outline:none;color:#333;line-height:1}.author-input[data-v-b625919e]:focus{border-bottom:none}\n\n/* 适配从发布页浮动按钮的层级 */.preview-page[data-v-b625919e]{position:relative;z-index:1}\n\n/* 诗歌帖子的样式（与poem-square完全一致） */.post-item-wrapper[data-v-b625919e]{border-radius:%?40?%;margin-bottom:%?60?%;overflow:hidden;border:%?1?% solid #e9ecef;box-shadow:0 %?12?% %?15?% rgba(0,0,0,.2);transition:-webkit-transform .3s ease;transition:transform .3s ease;transition:transform .3s ease,-webkit-transform .3s ease}.post-item-wrapper[data-v-b625919e]:active{-webkit-transform:scale(.98);transform:scale(.98)}.post-content-navigator[data-v-b625919e]{display:block}.post-item[data-v-b625919e]{padding:%?40?% %?50?%;position:relative}.post-content[data-v-b625919e]{font-size:%?32?%;line-height:1.6;margin:%?30?% 0;width:100%}\n\n/* 折叠态：多端兼容的三行裁切 */.post-content.collapsed[data-v-b625919e]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;overflow:hidden;text-overflow:ellipsis}.post-content.expanded[data-v-b625919e]{display:block;overflow:visible}.comment-emoji[data-v-b625919e]{font-size:%?40?%}.vote-section[data-v-b625919e]{display:flex;justify-content:space-between;align-items:center;padding:%?25?% %?50?%}.actions-left[data-v-b625919e]{flex:1;display:flex;align-items:center;gap:%?20?%}.button-group[data-v-b625919e]{display:flex;align-items:center;gap:%?30?%}.comment-count[data-v-b625919e]{display:flex;align-items:center;gap:%?8?%;padding:%?10?% %?15?%}.vote-count[data-v-b625919e]{display:flex;align-items:center;gap:%?8?%;padding:%?10?% %?15?%;border-radius:%?20?%;background:hsla(0,0%,100%,.9);box-shadow:0 %?2?% %?8?% rgba(0,0,0,.1)}.comment-icon[data-v-b625919e]{width:%?80?%;height:%?80?%}.like-icon[data-v-b625919e]{width:%?60?%;height:%?60?%;margin-top:5px}\n\n/* 用户签名样式 */.user-signature[data-v-b625919e]{position:absolute;bottom:%?-25?%; /* 从15rpx往下移动40rpx */right:%?60?%;z-index:10;pointer-events:none /* 防止签名影响点击事件 */}.signature-image[data-v-b625919e]{width:%?180?%;height:%?90?%;opacity:.8; /* 稍微透明，不抢夺主要内容的注意力 */-webkit-filter:drop-shadow(0 %?2?% %?4?% rgba(0,0,0,.1));filter:drop-shadow(0 %?2?% %?4?% rgba(0,0,0,.1)); /* 添加轻微阴影 */display:block; /* 确保图片正确显示 */background:transparent /* 确保背景透明 */}\n\n/* 普通帖子和讨论帖子的样式（从index页面复制） */.post-item-wrapper.normal-mode[data-v-b625919e]{background:#fff;margin-bottom:%?20?%;padding:0;box-shadow:none;border-radius:0;border-bottom:%?1?% solid #f0f0f0}.author-info-outside[data-v-b625919e]{display:flex;align-items:center;padding:%?20?% %?40?% %?10?% %?40?%;background:#fff}.author-info-outside .author-avatar[data-v-b625919e]{width:%?60?%;height:%?60?%;border-radius:50%;margin-right:%?15?%;background-color:#f5f5f5}.author-info-outside .author-name[data-v-b625919e]{font-size:%?28?%;color:#333;font-weight:500}.post-item[data-v-b625919e]{width:100%;background:#fff;box-shadow:none;box-sizing:border-box;padding:%?20?% %?40?% %?30?% %?40?%}.post-title[data-v-b625919e]{font-size:%?36?%;font-weight:700;color:#333;margin-bottom:%?15?%;line-height:1.4;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical}.poem-author[data-v-b625919e]{font-size:%?32?%;color:#000;text-align:center;margin:%?5?% 0 %?15?% 0;letter-spacing:%?2?%}.post-content[data-v-b625919e]{font-size:%?28?%;color:#666;line-height:1.6;margin-top:%?15?%;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical}.vote-section[data-v-b625919e]{display:flex;justify-content:space-between;align-items:center;margin-top:%?-8?%;padding:0 %?60?% 0 %?60?%}.actions-left[data-v-b625919e]{display:flex;align-items:center}.button-group[data-v-b625919e]{display:flex;align-items:center}.comment-count[data-v-b625919e]{display:flex;align-items:center;font-size:%?28?%;color:#999;margin-left:%?10?%;transition:color .2s ease}.action-emoji[data-v-b625919e]{font-size:%?28?%;margin-right:%?8?%}.action-text[data-v-b625919e]{font-size:%?28?%;color:inherit}.like-icon-container[data-v-b625919e]{display:flex;align-items:center;justify-content:center;padding:%?8?%;border-radius:%?8?%;margin-left:%?20?%;transition:all .2s ease}.like-icon-container[data-v-b625919e]:active{-webkit-transform:scale(.95);transform:scale(.95)}.like-icon[data-v-b625919e]{width:%?48?%;height:%?48?%}.vote-count[data-v-b625919e]{display:flex;align-items:center;font-size:%?28?%;color:#999;margin-left:%?10?%;transition:color .2s ease}.image-container-wrapper[data-v-b625919e]{position:relative;width:100%;background-color:#f0f0f0;overflow:hidden;border-radius:8px;margin:%?20?% 0}.image-container-wrapper .post-image[data-v-b625919e],\n.image-container-wrapper .image-swiper[data-v-b625919e]{position:absolute;top:0;left:0;width:100%;height:100%}.image-swiper[data-v-b625919e]{width:100%;background-color:#fff}.swiper-item[data-v-b625919e]{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.post-image[data-v-b625919e]{width:100%;height:100%;display:block;object-fit:contain}.post-tags[data-v-b625919e]{margin-top:%?30?%;margin-bottom:%?10?%;line-height:1.5}.post-tag[data-v-b625919e]{color:#24375f;font-size:%?26?%;margin-right:%?10?%;transition:all .2s ease}.post-tag[data-v-b625919e]:active{color:#1a2a4a;opacity:.8}",""]),t.exports=e},"850c":function(t,e,i){"use strict";i("6a54");var a=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("3efd"),i("f7a5"),i("0c26"),i("fd3c"),i("8f71"),i("bf0f"),i("7a76"),i("c9b5");var o=a(i("9b1b")),n={data:function(){return{post:null,backgroundColors:["#a4c4bd","#c9cfcf","#906161","#909388"],lastUsedColorIndex:-1}},onLoad:function(){var t=this;try{var e=this.getOpenerEventChannel&&this.getOpenerEventChannel();e&&e.on&&e.on("preview-data",(function(e){var i,a=e.post;t.post=a,console.log("【Preview】收到数据:",a),console.log("【Preview】publishMode:",null===(i=a.editData)||void 0===i?void 0:i.publishMode),a.editData&&"poem"===a.editData.publishMode&&(a.editData.selectedBackgroundColor?(a.backgroundColor=a.editData.selectedBackgroundColor,console.log("【Preview】使用选择的背景色:",a.backgroundColor)):(a.backgroundColor="#a4c4bd",console.log("【Preview】使用默认背景色")),a.textColor="#222"),t.post.isExpanded=!1}))}catch(o){}if(!this.post)try{var i,a=uni.getStorageSync("preview_post");if(a)this.post=a,console.log("【Preview】从缓存获取数据:",a),console.log("【Preview】缓存publishMode:",null===(i=a.editData)||void 0===i?void 0:i.publishMode),a.editData&&"poem"===a.editData.publishMode&&(a.editData.selectedBackgroundColor?(this.post.backgroundColor=a.editData.selectedBackgroundColor,console.log("【Preview】缓存使用选择的背景色:",this.post.backgroundColor)):(this.post.backgroundColor="#a4c4bd",console.log("【Preview】缓存使用默认背景色")),this.post.textColor="#222")}catch(n){}this.post||(this.post={content:"（预览为空）",textColor:"#000",backgroundColor:"#fff"}),this.post&&"undefined"===typeof this.post.isExpanded&&(this.post.isExpanded=!1),this.post&&this.post.editData&&this.post.editData.author&&(this.post.author=this.post.editData.author),this.post&&this.post.editData&&(console.log("【Preview】最终editData:",this.post.editData),console.log("【Preview】publishMode最终值:",this.post.editData.publishMode),console.log("【Preview】是否应该显示诗歌模式:","poem"===this.post.editData.publishMode),console.log("【Preview】最终背景色:",this.post.backgroundColor))},methods:{togglePostExpansion:function(){this.post&&(this.post.isExpanded=!this.post.isExpanded)},onTitleInput:function(t){this.post&&(this.post.title=t.detail.value)},onAuthorInput:function(t){this.post&&(this.post.author=t.detail.value)},getCurrentUserName:function(){try{var t=uni.getStorageSync("userInfo");return t?t.nickName:"匿名用户"}catch(e){return"匿名用户"}},goToPublish:function(){this.publishFromAddPage()},goBack:function(){uni.navigateBack()},deletePost:function(){uni.showModal({title:"确认删除",content:"确定要删除这个帖子吗？",confirmText:"删除",cancelText:"取消",confirmColor:"#ff4757",success:function(t){if(t.confirm){try{uni.removeStorageSync("preview_post")}catch(e){console.error("清除预览数据失败:",e)}uni.navigateBack(),uni.showToast({title:"已删除",icon:"success"})}}})},saveDraft:function(){if(this.post)try{var t=(0,o.default)((0,o.default)({},this.post),{},{saveTime:(new Date).getTime(),isDraft:!0}),e=[];try{var i=uni.getStorageSync("drafts");i&&Array.isArray(i)&&(e=i)}catch(a){console.log("获取草稿列表失败，创建新列表")}e.unshift(t),e.length>10&&(e=e.slice(0,10)),uni.setStorageSync("drafts",e),uni.showToast({title:"草稿已保存",icon:"success"}),setTimeout((function(){uni.navigateBack()}),1500)}catch(a){console.error("保存草稿失败:",a),uni.showToast({title:"保存失败",icon:"none"})}else uni.showToast({title:"没有内容可保存",icon:"none"})},publishFromAddPage:function(){var t=getCurrentPages(),e=t[t.length-2];if(e&&e.$vm){var i=e.$vm;if(!i)return console.error("【preview】addPage.$vm为空或undefined"),void uni.showToast({title:"发布数据获取失败",icon:"none"});console.log("【preview】获取到的addData信息:",{hasAddData:!!i,content:i.content,imageList:i.imageList,publishMode:i.publishMode,isOriginal:i.isOriginal,selectedTags:i.selectedTags,author:i.author});var a=this.post&&this.post.title&&this.post.title.trim(),n=i.content&&i.content.trim(),s=i.imageList&&Array.isArray(i.imageList)&&i.imageList.length>0;if(a||n||s)if(!a||n){if("poem"===i.publishMode&&!i.isOriginal){var r=this.post&&this.post.author&&this.post.author.trim();if(!r)return void uni.showToast({title:"非原创诗歌必须填写作者",icon:"none"})}var l=(0,o.default)((0,o.default)({},i),{},{title:this.post.title||"",author:this.post.author||"",content:i.content||"",imageList:i.imageList||[]});this.executePublish(l)}else uni.showToast({title:"请输入正文内容",icon:"none"});else uni.showToast({title:"请至少上传图片或输入内容",icon:"none"})}else uni.showToast({title:"获取发布数据失败",icon:"none"})},executePublish:function(t){if(uni.showLoading({title:"发布中..."}),"poem"!==t.publishMode||t.isOriginal){var e=t.imageList&&Array.isArray(t.imageList)&&t.imageList.length>0;e?this.uploadImagesAndSubmit(t):this.submitTextOnly(t)}else this.checkDuplicatePoem(t)},checkDuplicatePoem:function(t){var e=this,a=i("38db"),o=a.cloudCall;o("checkDuplicatePoem",{title:t.title.trim(),author:t.author.trim(),isOriginal:t.isOriginal},{pageTag:"preview",context:this,requireAuth:!0}).then((function(i){uni.hideLoading(),i.result&&i.result.success?i.result.isDuplicate?e.showDuplicateConfirmDialog(i.result.duplicateCount,t):e.proceedWithPublish(t):uni.showToast({title:"检查失败，请重试",icon:"none"})})).catch((function(t){uni.hideLoading(),console.error("检查重复失败:",t),uni.showToast({title:"网络错误，请重试",icon:"none"})}))},showDuplicateConfirmDialog:function(t,e){var i=this;uni.showModal({title:"发现重复诗歌",content:"已有 ".concat(t," 篇相同的诗歌发布，是否继续发布？"),confirmText:"继续发布",cancelText:"取消发布",success:function(t){t.confirm?i.proceedWithPublish(e):console.log("用户取消发布重复诗歌")}})},proceedWithPublish:function(t){uni.showLoading({title:"发布中..."});var e=t.imageList&&Array.isArray(t.imageList)&&t.imageList.length>0;e?this.uploadImagesAndSubmit(t):this.submitTextOnly(t)},uploadImagesAndSubmit:function(t){var e=this,a=i("38db");a.cloudCall;setTimeout((function(){e.submitToDatabase(t,[])}),1e3)},submitTextOnly:function(t){this.submitToDatabase(t,[])},submitToDatabase:function(t,e){var a=this,o=i("38db"),n=o.cloudCall,s="";if("poem"===t.publishMode)if(t.isOriginal){var r=uni.getStorageSync("userInfo"),l=r?r.nickName:"匿名用户";s=t.author&&t.author.trim()?t.author.trim():l}else s=t.author&&t.author.trim()?t.author.trim():"";var c={title:t.title,content:t.content,createTime:new Date,votes:0,isPoem:"poem"===t.publishMode,isOriginal:t.isOriginal,author:s,tags:t.selectedTags||[]};if(e.length>0){var u=e.map((function(t){return t.compressedUrl})),d=e.map((function(t){return t.originalUrl}));c.imageUrl=u[0],c.imageUrls=u,c.originalImageUrl=d[0],c.originalImageUrls=d}n("contentCheck",{title:t.title,content:t.content,fileIDs:e.map((function(t){return t.compressedUrl})).filter((function(t){return t})),originalFileIDs:e.map((function(t){return t.originalUrl})).filter((function(t){return t})),publishMode:t.publishMode,isOriginal:t.isOriginal,isDiscussion:t.isDiscussion||!1,author:t.author,tags:t.selectedTags||[]},{pageTag:"preview",context:this,requireAuth:!0}).then((function(t){var e;t&&t.result&&0===t.result.code?a.publishSuccess({_id:t.result.postId}):a.publishFail(new Error((null===(e=t.result)||void 0===e?void 0:e.msg)||"云函数返回失败"))})).catch((function(t){console.error("数据库提交失败:",t),a.publishFail(t)}))},publishSuccess:function(t){uni.hideLoading(),uni.showToast({title:"发布成功！"});try{var e=i("2729"),a=e.emitPostCreated;a(),console.log("【Preview】已触发 POST_CREATED 事件")}catch(s){console.error("触发POST_CREATED事件失败:",s)}try{uni.setStorageSync("shouldRefreshIndex",!0),uni.setStorageSync("shouldRefreshProfile",!0),uni.setStorageSync("shouldRefreshPoem",!0),uni.setStorageSync("shouldRefreshMountain",!0)}catch(s){console.error("设置刷新标记失败:",s)}try{var o=getCurrentPages(),n=o[o.length-2];n&&n.$vm&&n.$vm.clearDraft&&n.$vm.clearDraft()}catch(s){console.error("清除草稿失败:",s)}uni.switchTab({url:"/pages/index/index"})},publishFail:function(t){uni.hideLoading(),console.error("发布失败:",t);var e="发布失败";t&&t.message?e="发布失败: ".concat(t.message):t&&t.errMsg&&(e="发布失败: ".concat(t.errMsg)),uni.showModal({title:"发布失败",content:e,showCancel:!1,confirmText:"确定"})}}};e.default=n},"8af8":function(t,e,i){"use strict";var a=i("e29c"),o=i.n(a);o.a},"967d":function(t,e,i){"use strict";function a(t,e){for(var i=[],a={},o=0;o<e.length;o++){var n=e[o],s=n[0],r=n[1],l=n[2],c=n[3],u={id:t+":"+o,css:r,media:l,sourceMap:c};a[s]?a[s].parts.push(u):i.push(a[s]={id:s,parts:[u]})}return i}i.r(e),i.d(e,"default",(function(){return v}));var o="undefined"!==typeof document;if("undefined"!==typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var n={},s=o&&(document.head||document.getElementsByTagName("head")[0]),r=null,l=0,c=!1,u=function(){},d=null,p="undefined"!==typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function v(t,e,i,o){c=i,d=o||{};var s=a(t,e);return g(s),function(e){for(var i=[],o=0;o<s.length;o++){var r=s[o],l=n[r.id];l.refs--,i.push(l)}e?(s=a(t,e),g(s)):s=[];for(o=0;o<i.length;o++){l=i[o];if(0===l.refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete n[l.id]}}}}function g(t){for(var e=0;e<t.length;e++){var i=t[e],a=n[i.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](i.parts[o]);for(;o<i.parts.length;o++)a.parts.push(f(i.parts[o]));a.parts.length>i.parts.length&&(a.parts.length=i.parts.length)}else{var s=[];for(o=0;o<i.parts.length;o++)s.push(f(i.parts[o]));n[i.id]={id:i.id,refs:1,parts:s}}}}function h(){var t=document.createElement("style");return t.type="text/css",s.appendChild(t),t}function f(t){var e,i,a=document.querySelector('style[data-vue-ssr-id~="'+t.id+'"]');if(a){if(c)return u;a.parentNode.removeChild(a)}if(p){var o=l++;a=r||(r=h()),e=b.bind(null,a,o,!1),i=b.bind(null,a,o,!0)}else a=h(),e=w.bind(null,a),i=function(){a.parentNode.removeChild(a)};return e(t),function(a){if(a){if(a.css===t.css&&a.media===t.media&&a.sourceMap===t.sourceMap)return;e(t=a)}else i()}}var m=function(){var t=[];return function(e,i){return t[e]=i,t.filter(Boolean).join("\n")}}();function b(t,e,i,a){var o=i?"":E(a.css);if(t.styleSheet)t.styleSheet.cssText=m(e,o);else{var n=document.createTextNode(o),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(n,s[e]):t.appendChild(n)}}function w(t,e){var i=E(e.css),a=e.media,o=e.sourceMap;if(a&&t.setAttribute("media",a),d.ssrId&&t.setAttribute("data-vue-ssr-id",e.id),o&&(i+="\n/*# sourceURL="+o.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),t.styleSheet)t.styleSheet.cssText=i;else{while(t.firstChild)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var y=/%\?([+-]?\d+(\.\d+)?)\?%/g,x=/\.\?%PAGE\?%/g,C=/\?%PAGE\?%\[data-v-[a-z0-9]{8}\]/g,k=/uni-page-body\[data-v-[a-z0-9]{8}\]/g,D=/var\(--status-bar-height\)/gi,T=/var\(--window-top\)/gi,_=/var\(--window-bottom\)/gi,P=/var\(--window-left\)/gi,S=/var\(--window-right\)/gi;function E(t){var e=function(){var t="function"===typeof getApp&&getApp();return t&&t.$route&&t.$route.meta&&t.$route.meta.name||""}();if("undefined"!==typeof uni&&!uni.canIUse("css.var")){var i=function(){var t="function"===typeof getApp&&getApp();if(t&&t.$route&&t.$route.meta&&t.$route.meta.name)return{top:t.$route.meta.windowTop,bottom:t.$route.meta.isTabBar?50:0};return{top:0,bottom:0}}();t=t.replace(D,"0px").replace(T,i.top+"px").replace(_,i.bottom+"px").replace(P,"0px").replace(S,"0px")}return t.replace(C,e).replace(x,"").replace(k,"body."+e+" uni-page-body").replace(/\{[\s\S]+?\}|@media.+?\{/g,(function(t){return"undefined"===typeof uni?t:t.replace(y,(function(t,e){return uni.upx2px(e)+"px"}))}))}},a5a9:function(t,e,i){"use strict";i.r(e);var a=i("b174"),o=i("a843");for(var n in o)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(n);i("8af8");var s=i("828b"),r=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,"b625919e",null,!1,a["a"],void 0);e["default"]=r.exports},a843:function(t,e,i){"use strict";i.r(e);var a=i("850c"),o=i.n(a);for(var n in a)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(n);e["default"]=o.a},b174:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"preview-page white-bg"},[i("v-uni-view",{staticClass:"square-mode-container"},[t.post?i("v-uni-view",{attrs:{id:"post-list-container"}},[t.post.editData&&"poem"===t.post.editData.publishMode?i("v-uni-view",{staticClass:"post-item-wrapper",style:{backgroundColor:t.post.backgroundColor}},[i("v-uni-view",{staticClass:"post-content-navigator",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.togglePostExpansion.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"post-item",style:{backgroundColor:t.post.backgroundColor}},[i("v-uni-view",{class:"post-content "+(t.post.isExpanded?"expanded":"collapsed"),style:{color:t.post.textColor||"#222",whiteSpace:"pre-wrap"}},[t.post.isExpanded?[t._v(t._s(t.post.content))]:[t.post.highlightLines&&t.post.highlightLines.length>0?t._l(t.post.highlightLines,(function(e,a){return i("v-uni-text",{key:"line-"+a,staticStyle:{"font-weight":"700",display:"block"}},[t._v(t._s(e))])})):[t._v(t._s(t.post.content))]]],2),t.post.isExpanded&&t.post.authorSignature?i("v-uni-view",{staticClass:"user-signature"},[i("v-uni-image",{staticClass:"signature-image",attrs:{src:t.post.authorSignature,mode:"aspectFit"},on:{error:function(e){arguments[0]=e=t.$handleEvent(e),t.onSignatureError.apply(void 0,arguments)},load:function(e){arguments[0]=e=t.$handleEvent(e),t.onSignatureLoad.apply(void 0,arguments)}}})],1):t._e()],1)],1),t.post.isExpanded?i("v-uni-view",{staticClass:"vote-section",style:{backgroundColor:t.post.backgroundColor}},[i("v-uni-view",{staticClass:"actions-left"},[i("v-uni-view",{staticClass:"like-icon-container",on:{click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.onVote.apply(void 0,arguments)}}},[i("v-uni-image",{staticClass:"like-icon",attrs:{src:t.post.likeIcon||"/static/images/seed.png",mode:"aspectFit"},on:{error:function(e){arguments[0]=e=t.$handleEvent(e),t.onLikeIconError.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"comment-count",on:{click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.onCommentClick.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"comment-emoji"},[t._v("💬")])],1)],1),i("v-uni-view",{staticClass:"button-group"})],1):t._e()],1):i("v-uni-view",{staticClass:"post-item-wrapper normal-mode"},[i("v-uni-view",{staticClass:"author-info-outside"},[i("v-uni-image",{staticClass:"author-avatar",attrs:{src:"/static/images/avatar.png",mode:"aspectFill"}}),i("v-uni-text",{staticClass:"author-name"},[t._v(t._s(t.getCurrentUserName()))])],1),i("v-uni-view",{staticClass:"post-item"},[t.post.title?i("v-uni-view",{staticClass:"post-title"},[t._v(t._s(t.post.title))]):t._e(),t.post.editData&&"poem"===t.post.editData.publishMode&&t.post.author?i("v-uni-view",{staticClass:"poem-author"},[t._v(t._s(t.post.author))]):t._e(),t.post.imageUrls&&t.post.imageUrls.length>0?i("v-uni-view",{staticClass:"image-container-wrapper"},[1===t.post.imageUrls.length?[i("v-uni-image",{staticClass:"post-image",attrs:{src:t.post.imageUrls[0],mode:"aspectFill"}})]:t.post.imageUrls.length>1?[i("v-uni-swiper",{staticClass:"image-swiper",attrs:{"indicator-dots":!0,circular:!0}},[t._l(t.post.imageUrls,(function(t,e){return[i("v-uni-swiper-item",[i("v-uni-image",{staticClass:"post-image",attrs:{src:t,mode:"aspectFill"}})],1)]}))],2)]:t._e()],2):t._e(),t.post.content?i("v-uni-view",{staticClass:"post-content",staticStyle:{"white-space":"pre-wrap"}},[t._v(t._s(t.post.content))]):t._e(),t.post.editData&&t.post.editData.selectedTags&&t.post.editData.selectedTags.length>0?i("v-uni-view",{staticClass:"post-tags"},t._l(t.post.editData.selectedTags,(function(e,a){return i("v-uni-text",{key:a,staticClass:"post-tag"},[t._v("#"+t._s(e))])})),1):t._e()],1),i("v-uni-view",{staticClass:"vote-section"},[i("v-uni-view",{staticClass:"actions-left"}),i("v-uni-view",{staticClass:"button-group"},[i("v-uni-view",{staticClass:"comment-count"},[i("v-uni-text",{staticClass:"action-emoji"},[t._v("💬")]),i("v-uni-text",{staticClass:"action-text"},[t._v("0")])],1),i("v-uni-view",{staticClass:"like-icon-container"},[i("v-uni-image",{staticClass:"like-icon",attrs:{src:"/static/images/seed.png",mode:"aspectFit"}})],1),i("v-uni-view",{staticClass:"vote-count"},[i("v-uni-text",{staticClass:"action-text"},[t._v("0")])],1)],1)],1)],1),i("v-uni-view",{staticClass:"title-input-section"},[i("v-uni-view",{staticClass:"title-input-wrapper"},[i("v-uni-input",{staticClass:"title-input",attrs:{placeholder:"想个标题...",maxlength:"50",value:t.post.title},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onTitleInput.apply(void 0,arguments)}}})],1)],1),t.post.editData&&"poem"===t.post.editData.publishMode?i("v-uni-view",{staticClass:"author-input-section"},[i("v-uni-view",{staticClass:"author-input-wrapper"},[i("v-uni-input",{staticClass:"author-input",attrs:{placeholder:t.post.editData.isOriginal?"作者（默认使用昵称）":"作者（必填）",maxlength:"20",value:t.post.author},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onAuthorInput.apply(void 0,arguments)}}})],1)],1):t._e()],1):i("v-uni-view",{staticClass:"empty-state"},[i("v-uni-view",{staticClass:"empty-icon"},[t._v("🕐")]),i("v-uni-view",{staticClass:"empty-text"},[t._v("正在准备预览…")])],1)],1),i("v-uni-view",{staticClass:"bottom-buttons"},[i("v-uni-view",{staticClass:"button-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goBack.apply(void 0,arguments)}}},[i("v-uni-image",{staticClass:"button-icon",attrs:{src:"/static/images/返回编辑.png",mode:"aspectFit"}})],1),i("v-uni-view",{staticClass:"button-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deletePost.apply(void 0,arguments)}}},[i("v-uni-image",{staticClass:"button-icon",attrs:{src:"/static/images/删除.png",mode:"aspectFit"}})],1),i("v-uni-view",{staticClass:"button-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveDraft.apply(void 0,arguments)}}},[i("v-uni-image",{staticClass:"button-icon",attrs:{src:"/static/images/存草稿.png",mode:"aspectFit"}})],1),i("v-uni-view",{staticClass:"button-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goToPublish.apply(void 0,arguments)}}},[i("v-uni-image",{staticClass:"button-icon",attrs:{src:"/static/images/发布.png",mode:"aspectFit"}})],1)],1)],1)},o=[]},c86c:function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i=t[1]||"",a=t[3];if(!a)return i;if(e&&"function"===typeof btoa){var o=function(t){var e=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(e);return"/*# ".concat(i," */")}(a),n=a.sources.map((function(t){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(t," */")}));return[i].concat(n).concat([o]).join("\n")}return[i].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,a){"string"===typeof t&&(t=[[null,t,""]]);var o={};if(a)for(var n=0;n<this.length;n++){var s=this[n][0];null!=s&&(o[s]=!0)}for(var r=0;r<t.length;r++){var l=[].concat(t[r]);a&&o[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),e.push(l))}},e}},e29c:function(t,e,i){var a=i("8227");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=i("967d").default;o("f1c7131c",a,!0,{sourceMap:!1,shadowMode:!1})}}]);