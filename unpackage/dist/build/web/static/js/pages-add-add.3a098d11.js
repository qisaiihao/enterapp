(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-add-add"],{"1d6a":function(n,t,e){var a=e("8f2e");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);var i=e("967d").default;i("988d678c",a,!0,{sourceMap:!1,shadowMode:!1})},"1f0e":function(n,t,e){"use strict";e.d(t,"b",(function(){return a})),e.d(t,"c",(function(){return i})),e.d(t,"a",(function(){}));var a=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("v-uni-view",{staticClass:"container",style:"padding-bottom: calc(120rpx + "+n.keyboardHeight+"px);"},[n.imageList.length>0?e("v-uni-view",{staticClass:"image-section"},[e("v-uni-scroll-view",{staticClass:"image-preview-scroll",attrs:{"scroll-x":!0,"show-scrollbar":!1}},[e("v-uni-view",{staticClass:"image-preview-container"},[n._l(n.imageList,(function(t,a){return e("v-uni-view",{key:a,staticClass:"image-preview-item"},[e("v-uni-image",{staticClass:"preview-image",attrs:{src:t.previewUrl,mode:"aspectFill"},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onImageError.apply(void 0,arguments)}}}),e("v-uni-view",{staticClass:"image-remove-btn",attrs:{"data-index":a},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.removeImage.apply(void 0,arguments)}}},[n._v("√ó")])],1)})),n.imageList.length<n.maxImageCount?e("v-uni-view",{staticClass:"add-image-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.handleChooseImage.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"add-icon"},[n._v("+")])],1):n._e()],2)],1)],1):n._e(),e("v-uni-view",{staticClass:"content-section"},[e("v-uni-view",{staticClass:"title-input-wrapper"},[e("v-uni-input",{staticClass:"title-input",attrs:{placeholder:"Ê†áÈ¢ò",maxlength:"50",value:n.title},on:{input:function(t){arguments[0]=t=n.$handleEvent(t),n.onTitleInput.apply(void 0,arguments)}}})],1),"poem"===n.publishMode?e("v-uni-view",{staticClass:"author-input-wrapper"},[e("v-uni-input",{staticClass:"author-input",attrs:{placeholder:n.isOriginal?"‰ΩúËÄÖÔºàÂèØÈÄâÔºå‰∏çÂ°´ÈªòËÆ§‰ΩøÁî®ÊÇ®ÁöÑÊòµÁß∞Ôºâ":"‰ΩúËÄÖÔºàÂøÖÂ°´Ôºâ",maxlength:"20",value:n.author},on:{input:function(t){arguments[0]=t=n.$handleEvent(t),n.onAuthorInput.apply(void 0,arguments)}}})],1):n._e(),e("v-uni-view",{staticClass:"content-input-wrapper"},[e("v-uni-textarea",{staticClass:"content-textarea",attrs:{placeholder:"Ê≠§Âàª‰Ω†ÊÉ≥Ë¶ÅÂàÜ‰∫´...",maxlength:"1500",value:n.content,"show-confirm-bar":!1,"adjust-position":!1},on:{input:function(t){arguments[0]=t=n.$handleEvent(t),n.onContentInput.apply(void 0,arguments)},focus:function(t){arguments[0]=t=n.$handleEvent(t),n.onTextareaFocus.apply(void 0,arguments)},blur:function(t){arguments[0]=t=n.$handleEvent(t),n.onTextareaBlur.apply(void 0,arguments)},click:function(t){arguments[0]=t=n.$handleEvent(t),n.onTextareaTap.apply(void 0,arguments)}}}),n.content.length>1400?e("v-uni-view",{staticClass:"char-count"},[n._v(n._s(n.content.length)+"/1500")]):n._e()],1)],1),n.showPoemSubmenu?e("v-uni-view",{staticClass:"poem-submenu"},[e("v-uni-view",{staticClass:"submenu-item",attrs:{"data-original":!0},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.selectPoemMode.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"submenu-icon"},[n._v("‚ú®")]),e("v-uni-view",{staticClass:"submenu-text"},[n._v("ÂéüÂàõ")])],1),e("v-uni-view",{staticClass:"submenu-item",attrs:{"data-original":!1},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.selectPoemMode.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"submenu-icon"},[n._v("üìñ")]),e("v-uni-view",{staticClass:"submenu-text"},[n._v("ÈùûÂéüÂàõ")])],1)],1):n._e(),e("v-uni-view",{staticClass:"toolbar",style:"bottom: "+n.keyboardHeight+"px;"},[e("v-uni-view",{staticClass:"toolbar-item",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.handleChooseImage.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"toolbar-icon"},[n._v("üì∑")]),e("v-uni-view",{staticClass:"toolbar-text"},[n._v("ÂõæÁâá")])],1),e("v-uni-view",{staticClass:"toolbar-item",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.toggleTagSelector.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"toolbar-icon"},[n._v("#")]),e("v-uni-view",{staticClass:"toolbar-text"},[n._v("Ê†áÁ≠æ")])],1),e("v-uni-view",{staticClass:"toolbar-item",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.switchMode.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"toolbar-icon"},[n._v(n._s("normal"===n.publishMode?"üìù":"üé≠"))]),e("v-uni-view",{staticClass:"toolbar-text"},[n._v(n._s("normal"===n.publishMode?"ÂÜôËØó":"ÊôÆÈÄö"))])],1),e("v-uni-view",{class:"publish-btn "+(n.canPublish?"active":""),on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.submitPost.apply(void 0,arguments)}}},[n._v("ÂèëÂ∏É")])],1),n.showTagSelector?e("v-uni-view",{staticClass:"tag-section",style:"bottom: calc(120rpx + "+n.keyboardHeight+"px);"},[e("v-uni-view",{staticClass:"tag-header"},[e("v-uni-text",{staticClass:"tag-title"},[n._v("Ê∑ªÂä†Ê†áÁ≠æ")]),e("v-uni-text",{staticClass:"tag-count"},[n._v(n._s(n.selectedTags.length)+"/5")]),e("v-uni-text",{staticClass:"tag-toggle",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.toggleTagSelector.apply(void 0,arguments)}}},[n._v("Êî∂Ëµ∑")])],1),n.selectedTags.length>0?e("v-uni-view",{staticClass:"selected-tags"},n._l(n.selectedTags,(function(t,a){return e("v-uni-view",{key:a,staticClass:"selected-tag"},[e("v-uni-text",[n._v(n._s(t))]),e("v-uni-text",{staticClass:"remove-tag",attrs:{"data-tag":t},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.removeTag.apply(void 0,arguments)}}},[n._v("√ó")])],1)})),1):n._e(),n.showTagSelector?e("v-uni-view",{staticClass:"tag-selector"},[e("v-uni-view",{staticClass:"category-selector"},[e("v-uni-scroll-view",{staticClass:"category-scroll",attrs:{"scroll-x":!0,"show-scrollbar":!1}},[e("v-uni-view",{staticClass:"category-list"},n._l(n.tagCategories,(function(t,a){return e("v-uni-view",{key:a,class:"category-item "+(n.currentCategoryIndex===a?"active":""),attrs:{"data-index":a},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.switchCategory.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"category-icon"},[n._v(n._s(t.icon))]),e("v-uni-text",{staticClass:"category-name"},[n._v(n._s(t.name))])],1)})),1)],1)],1),e("v-uni-view",{staticClass:"current-category-tags"},n._l(n.tagCategories[n.currentCategoryIndex].tags,(function(t,a){return e("v-uni-view",{key:a,class:"preset-tag "+(n.selectedTags.includes(t)?"selected":""),attrs:{"data-tag":t},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.selectTag.apply(void 0,arguments)}}},[n._v(n._s(t))])})),1),e("v-uni-view",{staticClass:"custom-tag-input"},[e("v-uni-input",{attrs:{placeholder:"ËæìÂÖ•Ëá™ÂÆö‰πâÊ†áÁ≠æ",value:n.customTag,maxlength:"10"},on:{input:function(t){arguments[0]=t=n.$handleEvent(t),n.onCustomTagInput.apply(void 0,arguments)}}}),e("v-uni-button",{attrs:{size:"mini"},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.addCustomTag.apply(void 0,arguments)}}},[n._v("Ê∑ªÂä†")])],1),n.showMatchedTags&&n.matchedTags.length>0?e("v-uni-view",{staticClass:"matched-tags"},[e("v-uni-view",{staticClass:"matched-tags-title"},[n._v("Êé®ËçêÊ†áÁ≠æÔºö")]),e("v-uni-view",{staticClass:"matched-tags-list"},n._l(n.matchedTags,(function(t,a){return e("v-uni-view",{key:a,staticClass:"matched-tag",attrs:{"data-tag":t},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.selectMatchedTag.apply(void 0,arguments)}}},[n._v(n._s(t))])})),1)],1):n._e()],1):n._e()],1):n._e()],1)},i=[]},"50d0":function(n,t,e){"use strict";e.r(t);var a=e("1f0e"),i=e("979d");for(var o in i)["default"].indexOf(o)<0&&function(n){e.d(t,n,(function(){return i[n]}))}(o);e("b14c");var s=e("828b"),l=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"1b829688",null,!1,a["a"],void 0);t["default"]=l.exports},"6e3f":function(n,t,e){"use strict";e("6a54");var a=e("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(e("b7c7")),o=a(e("fcf3"));e("bf0f"),e("7a76"),e("c9b5"),e("4626"),e("5ac7"),e("0c26"),e("fd3c"),e("18f7"),e("de6c"),e("dc89"),e("2425"),e("c223"),e("dd2b"),e("8f71"),e("5ef2"),e("aa9c"),e("f7a5");var s=e("11ca"),l=s.cloudCall,r={data:function(){return{title:"",content:"",imageList:[],maxImageCount:9,publishMode:"normal",isOriginal:!1,showPoemSubmenu:!1,canPublish:!1,selectedTags:[],customTag:"",showTagSelector:!1,currentCategoryIndex:0,allExistingTags:[],matchedTags:[],showMatchedTags:!1,isPublished:!1,isTemporaryHide:!1,author:"",keyboardHeight:0,tagCategories:[{name:"ÂÜÖÂÆπ‰∏ªÈ¢ò",icon:"üìù",tags:["Áà±ÊÉÖ","‰∫≤ÊÉÖ","ÂèãÊÉÖ","‰π°ÊÑÅ","ÊÄùÂøµ","Â≠§Áã¨","ÂíèÁâ©","Â±±Ê∞¥","Áî∞Âõ≠","Â≠£ËäÇ","Êò•Â§©","Â§èÊó•","ÁßãÈ£é","ÂÜ¨Èõ™","‰∫∫Áîü","ÁêÜÊÉ≥","Âì≤ÁêÜ","Êó∂Èó¥","ÈùíÊò•","ÊàêÈïø","ÁîüÊ≠ª","ÊÄÄÂè§","ÂíèÂè≤","ËæπÂ°û","Êàò‰∫â","Áà±ÂõΩ","ÂüéÂ∏Ç","‰π°Êùë","ÁîüÊ¥ª","ÊóÖË°å","È•ÆÈ£ü","Âä≥Âä®"]},{name:"ÊÉÖÊÑüÂü∫Ë∞É",icon:"üí≠",tags:["Ê≤ªÊÑà","Ê∏©Êöñ","Êµ™Êº´","ÂîØÁæé","ÊÇ≤‰º§","‰º§ÊÑü","ÊÉÜÊÄÖ","ÂØÇÂØû","Ë±™Êîæ","Ë±ÅËææ","ÊøÄÊòÇ","ÁÉ≠Ë°Ä","Â©âÁ∫¶","ÁªÜËÖª","Ê∏ÖÊñ∞","ÂÆÅÈùô","Âä±Âøó","ÈºìËàû","ÂùöÂÆö","ÂÖÖÊª°Â∏åÊúõ","ËÆΩÂà∫","ÊâπÂà§","Ê∑±Ê≤â","Âºï‰∫∫Ê∑±ÊÄù"]},{name:"ÂΩ¢Âºè‰ΩìË£Å",icon:"üìñ",tags:["Âè§‰ΩìËØó","Ëøë‰ΩìËØó","‰∫îË®Ä","‰∏ÉË®Ä","ÁªùÂè•","ÂæãËØó","ËØç","Êõ≤","‰πêÂ∫ú","È™ö‰Ωì","Áé∞‰ª£ËØó","Ëá™Áî±ËØó","Êï£ÊñáËØó","ÂçÅÂõõË°åËØó","Âèô‰∫ãËØó","‰ø≥Âè•","Áü≠Ê≠å","Âè≤ËØó","ÈïøËØó","Áü≠ËØó","ÂæÆÂûãËØó","‰∏âË°åËØó"]},{name:"ÊÑèË±°ÂÖÉÁ¥†",icon:"üåô",tags:["Êúà‰∫Æ","ÊòüÊòü","Â§™Èò≥","ÂÆáÂÆô","Èì∂Ê≤≥","È£é","Èõ®","Èõ™","‰∫ë","Èõæ","Ê≤≥ÊµÅ","Â§ßÊµ∑","Â±±Â≥∞","Ê£ÆÊûó","Ëä±","Ëçâ","Ê†ë","È∫¶Áî∞","ËêΩÂè∂","Ê¢Ö","ÂÖ∞","Á´π","Ëèä","È∏ü","È©¨","Ëùâ","È±º","Ëù¥Ëù∂","ÈÖí","Ââë","Áê¥","ÁÅØ","Ëàπ","ÈïúÂ≠ê","Á∫¢Ëâ≤","ÁôΩËâ≤","ËìùËâ≤","ÈáëËâ≤"]},{name:"È£éÊ†ºÊµÅÊ¥æ",icon:"üé≠",tags:["ÂîêËØó","ÂÆãËØç","ÂÖÉÊõ≤","ÂÖàÁß¶","‰∏§Ê±â","È≠èÊôã","Âª∫ÂÆâÈ£éÈ™®","Êú¶ËÉßËØó","Êñ∞ÊúàÊ¥æ","Êµ™Êº´‰∏ª‰πâ","Áé∞ÂÆû‰∏ª‰πâ","Ë±°ÂæÅ‰∏ª‰πâ","Áé∞‰ª£‰∏ª‰πâ","ÊÑèË±°Ê¥æ","ÂûÆÊéâÁöÑ‰∏Ä‰ª£","‰∏≠ÊñáËØó","Ëã±ÊñáËØó","Êó•ÊñáËØó","Ê≥ïÊñáËØó","ÁøªËØëËØó","‰∏≠ÂõΩ","Ëã±ÂõΩ","ÁæéÂõΩ","Êó•Êú¨","‰øÑÁΩóÊñØ"]},{name:"Âú∫ÊôØÁî®ÈÄî",icon:"üéØ",tags:["ÊôöÂÆâËØó","Êó©ÂÆâÈóÆÂÄô","ËäÇÊó•Á•ùÁ¶è","Êò•ËäÇ","‰∏≠Áßã","ÊÉÖ‰∫∫ËäÇ","ÊØï‰∏öÂ≠£","Â©öÁ§ºËá¥Ëæû","ÊóÖË°åÈÄî‰∏≠","Èõ®Â§©ËØªËØó","ÂÜôÁªôÂ≠©Â≠ê","Ëá¥Êï¨ÊØç‰∫≤","ÈÄÅÁªôÊúãÂèã","ÈÄÇÂêàÊëòÊäÑ","ÂèØ‰ª•Áî®‰ΩúÁ≠æÂêç"]}],tags:[]}},onLoad:function(n){this.loadAllExistingTags(),"edit"===n.mode?this.loadEditingDraft():this.loadDraft(),this.preventPageScroll()},onShow:function(){this.preventPageScroll()},onUnload:function(){this.isPublished||this.checkAndSaveDraft()},onHide:function(){this.isPublished||this.isTemporaryHide||this.checkAndSaveDraft(),this.setData({isTemporaryHide:!1})},methods:{callCloudFunction:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l(n,t,Object.assign({pageTag:"add",context:this,requireAuth:!0},e))},uploadFile:function(n,t){var a=this;return new Promise((function(i,o){var s=e("fd09"),l=s.getCurrentPlatform,r=s.getCloudFunctionMethod,c=(l(),r());"tcb"===c?a.uploadFileViaCloudFunction(n,t).then(i).catch(o):"wx-cloud"===c?wx.cloud&&wx.cloud.uploadFile?wx.cloud.uploadFile({cloudPath:n,filePath:t,success:function(n){i(n)},fail:function(n){o(n)}}):o(new Error("ÂæÆ‰ø°‰∫ëÂºÄÂèë‰∏çÂèØÁî®")):o(new Error("‰∏çÊîØÊåÅÁöÑ‰∫ëÂáΩÊï∞Ë∞ÉÁî®ÊñπÂºè: ".concat(c)))}))},uploadFileViaCloudFunction:function(n,t){var e=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new Promise((function(i,o){if("undefined"!==typeof window&&"undefined"!==typeof FileReader)fetch(t).then((function(n){if(!n.ok)throw new Error("HTTP error! status: ".concat(n.status));return n.blob()})).then((function(s){var l=new FileReader;l.onload=function(){var s=l.result;if(!s||"string"!==typeof s)return console.error("‚ùå [AddÈ°µÈù¢] FileReaderÁªìÊûúÊó†Êïà:",s),void o(new Error("Êñá‰ª∂ËØªÂèñÂ§±Ë¥•"));var r=s.split(",")[1];console.log("üîç [AddÈ°µÈù¢] Êñá‰ª∂ËΩ¨Êç¢‰∏∫base64ÂÆåÊàêÔºåÈïøÂ∫¶: ".concat(r.length)),r.length>6291456&&console.warn("‚ö†Ô∏è [AddÈ°µÈù¢] base64Êñá‰ª∂ËøáÂ§ßÔºåÂ∞ùËØïËøõ‰∏ÄÊ≠•ÂéãÁº©"),e.callCloudFunction("upload",{cloudPath:n,fileContent:r}).then((function(n){console.log("‰∏ä‰º†‰∫ëÂáΩÊï∞ËøîÂõûÁªìÊûú:",n),n&&n.result&&n.result.success?i({fileID:n.result.fileID,cloudPath:n.result.cloudPath}):o(new Error("‰∏ä‰º†‰∫ëÂáΩÊï∞ËøîÂõûÊ†ºÂºèÈîôËØØ"))})).catch((function(s){var l;a<2&&("request:fail"===s.errMsg||null!==(l=s.message)&&void 0!==l&&l.includes("fail"))?(console.log("üîÑ [AddÈ°µÈù¢] ‰∏ä‰º†Â§±Ë¥•ÔºåÂáÜÂ§áÈáçËØï (".concat(a+1,"/2)")),setTimeout((function(){e.uploadFileViaCloudFunction(n,t,a+1).then(i).catch(o)}),1e3*(a+1))):o(s)}))},l.onerror=function(){console.error("‚ùå [AddÈ°µÈù¢] FileReaderËØªÂèñÂ§±Ë¥•"),o(new Error("Êñá‰ª∂ËØªÂèñÂ§±Ë¥•"))},l.readAsDataURL(s)})).catch((function(n){console.error("‚ùå [AddÈ°µÈù¢] Ëé∑ÂèñÊñá‰ª∂blobÂ§±Ë¥•:",n),o(new Error("Ëé∑ÂèñÊñá‰ª∂Â§±Ë¥•: "+n.message))}));else{console.log("üîç [AddÈ°µÈù¢] AppÁéØÂ¢É‰ΩøÁî®uni-app APIËØªÂèñÊñá‰ª∂");try{var s=uni.getFileSystemManager();s&&s.readFile?s.readFile({filePath:t,encoding:"base64",success:function(t){var a=t.data;console.log("üîç [AddÈ°µÈù¢] Êñá‰ª∂ËØªÂèñÂÆåÊàêÔºåbase64ÈïøÂ∫¶: ".concat(a.length)),e.callCloudFunction("upload",{cloudPath:n,fileContent:a}).then((function(n){console.log("AppÁéØÂ¢É‰∏ä‰º†‰∫ëÂáΩÊï∞ËøîÂõûÁªìÊûú:",n),n&&n.result&&n.result.success?i({fileID:n.result.fileID,cloudPath:n.result.cloudPath}):o(new Error("‰∏ä‰º†‰∫ëÂáΩÊï∞ËøîÂõûÊ†ºÂºèÈîôËØØ"))})).catch(o)},fail:function(n){console.error("‚ùå [AddÈ°µÈù¢] Êñá‰ª∂ËØªÂèñÂ§±Ë¥•Ôºö",n),o(new Error("Êñá‰ª∂ËØªÂèñÂ§±Ë¥•: ".concat(n.errMsg||"Êú™Áü•ÈîôËØØ")))}}):(console.error("‚ùå [AddÈ°µÈù¢] getFileSystemManager‰∏çÂèØÁî®"),o(new Error("Êñá‰ª∂Á≥ªÁªüAPI‰∏çÂèØÁî®")))}catch(l){console.error("‚ùå [AddÈ°µÈù¢] Êñá‰ª∂Á≥ªÁªüAPIË∞ÉÁî®Â§±Ë¥•:",l),o(new Error("Êñá‰ª∂Á≥ªÁªüAPI‰∏çÂèØÁî®"))}}}))},preventPageScroll:function(){try{uni.pageScrollTo({scrollTop:0,duration:0})}catch(n){console.log("CatchClause",n),console.log("CatchClause",n),console.log("preventPageScroll error:",n)}},onTitleInput:function(n){this.setData({title:n.detail.value}),this.checkCanPublish()},onContentInput:function(n){var t=n.detail,e=t.value;t.cursor;this.setData({content:e}),this.checkCanPublish()},onContainerTap:function(n){console.log("ÂÆπÂô®Ë¢´ÁÇπÂáªÔºåÂáÜÂ§áÈöêËóèÈîÆÁõò"),setTimeout((function(){uni.hideKeyboard()}),100)},onTextareaTap:function(n){console.log("textareaË¢´ÁÇπÂáªÔºåÂ∫îËØ•Ëé∑ÂèñÁÑ¶ÁÇπ")},onTextareaFocus:function(n){console.log("textareaËé∑ÂæóÁÑ¶ÁÇπÔºåÈîÆÁõòÈ´òÂ∫¶:",n.detail.height);var t=n.detail.height;if(!t||0===t){var e=uni.getSystemInfoSync();console.log("Á≥ªÁªü‰ø°ÊÅØ:",e),t=Math.min(.4*e.windowHeight,300),console.log("‰ΩøÁî®ÈªòËÆ§ÈîÆÁõòÈ´òÂ∫¶:",t)}this.setData({keyboardHeight:t})},onTextareaBlur:function(){console.log("textareaÂ§±ÂéªÁÑ¶ÁÇπ"),this.setData({keyboardHeight:0})},onAuthorInput:function(n){this.setData({author:n.detail.value}),this.checkCanPublish()},checkCanPublish:function(){var n=this.imageList.length>0,t=this.title&&this.title.trim(),e=this.content&&this.content.trim(),a=n||t&&e;if("poem"===this.publishMode&&!this.isOriginal){var i=this.author&&this.author.trim();a=a&&i}this.setData({canPublish:a})},switchMode:function(){"normal"===this.publishMode?this.showPoemSubmenu?this.setData({showPoemSubmenu:!1}):this.setData({showPoemSubmenu:!0,showTagSelector:!1}):(this.setData({publishMode:"normal",isOriginal:!1,showPoemSubmenu:!1,maxImageCount:9}),this.checkCanPublish())},selectPoemMode:function(n){var t="true"===n.currentTarget.dataset.original;this.setData({publishMode:"poem",isOriginal:t,showPoemSubmenu:!1,imageList:this.imageList.length>1?[]:this.imageList,maxImageCount:1}),this.checkCanPublish()},handleChooseImage:function(){var n=this,t=this,e=this.maxImageCount-this.imageList.length;e<=0?uni.showToast({title:"ÊúÄÂ§öÂè™ËÉΩ‰∏ä‰º†9Âº†ÂõæÁâá",icon:"none"}):(this.setData({isTemporaryHide:!0}),uni.chooseImage({count:e,sizeType:["original"],sourceType:["album","camera"],success:function(n){uni.showLoading({title:"Â§ÑÁêÜ‰∏≠..."}),console.log("wx.chooseImage ËøîÂõûÁöÑËØ¶ÁªÜÊñá‰ª∂‰ø°ÊÅØ:",n.tempFiles);var e=n.tempFiles.map((function(n){var e=n.path,a=n.size;if(console.log("Ëé∑ÂèñÂà∞ÂõæÁâá ".concat(e," ÁöÑÂéüÂßãÂ§ßÂ∞è:"),(a/1024).toFixed(2),"KB"),a>5242880)throw new Error("ÂõæÁâáÊñá‰ª∂ËøáÂ§ß (".concat((a/1024/1024).toFixed(2),"MB)ÔºåËØ∑ÈÄâÊã©Â∞è‰∫é5MBÁöÑÂõæÁâá"));var i=a>2e5,o={originalPath:e,imageSize:a,needCompression:i,previewUrl:e,compressedPath:e,originalUrl:"",compressedUrl:""};return i?t.compressImage(o):Promise.resolve(o)}));Promise.all(e).then((function(n){uni.hideLoading(),t.updateImageList(n),t.checkCanPublish()})).catch((function(n){uni.hideLoading(),console.error("ÂõæÁâáÂ§ÑÁêÜÂ§±Ë¥•:",n);var t="ÂõæÁâáÂ§ÑÁêÜÂ§±Ë¥•";n.message&&n.message.includes("ÂõæÁâáÊñá‰ª∂ËøáÂ§ß")?t=n.message:n.message&&(t="ÂõæÁâáÂ§ÑÁêÜÂ§±Ë¥•: ".concat(n.message)),uni.showModal({title:"ÈîôËØØ",content:t,showCancel:!1,confirmText:"Á°ÆÂÆö"})}))},fail:function(t){console.log("ÈÄâÊã©ÂõæÁâáÂèñÊ∂àÊàñÂ§±Ë¥•:",t),n.setData({isTemporaryHide:!1})}}))},compressImage:function(n){var t=this;return new Promise((function(a){var i=e("fd09"),o=i.getCurrentPlatform,s=o();"h5"===s?(console.log("üîç [AddÈ°µÈù¢] H5ÁéØÂ¢É‰ΩøÁî®CanvasÂéãÁº©ÂõæÁâá"),t.compressImageWithCanvas(n).then(a).catch((function(){console.log("CanvasÂéãÁº©Â§±Ë¥•Ôºå‰ΩøÁî®ÂéüÂõæ"),n.compressedPath=n.originalPath,n.previewUrl=n.originalPath,a(n)}))):(console.log("üîç [AddÈ°µÈù¢] Â∞èÁ®ãÂ∫è/AppÁéØÂ¢É‰ΩøÁî®uni.compressImage"),uni.compressImage({src:n.originalPath,quality:80,success:function(t){n.compressedPath=t.tempFilePath,n.previewUrl=t.tempFilePath,a(n)},fail:function(t){console.log("ÂéãÁº©Â§±Ë¥•Ôºå‰ΩøÁî®ÂéüÂõæ:",t),n.compressedPath=n.originalPath,n.previewUrl=n.originalPath,a(n)}}))}))},compressImageWithCanvas:function(n){return new Promise((function(t,e){var a=new Image;a.crossOrigin="anonymous",a.onload=function(){try{var i=document.createElement("canvas"),o=i.getContext("2d"),s=a.width,l=a.height;s>l?s>1200&&(l=1200*l/s,s=1200):l>1200&&(s=1200*s/l,l=1200),i.width=s,i.height=l,o.drawImage(a,0,0,s,l),i.toBlob((function(a){if(a){var i=URL.createObjectURL(a);n.compressedPath=i,n.previewUrl=i,console.log("‚úÖ [AddÈ°µÈù¢] CanvasÂéãÁº©ÊàêÂäüÔºåÊñ∞Â∞∫ÂØ∏:",s,"x",l),t(n)}else e(new Error("CanvasÂéãÁº©Â§±Ë¥•"))}),"image/jpeg",.6)}catch(r){console.error("CanvasÂéãÁº©ËøáÁ®ãÂá∫Èîô:",r),e(r)}},a.onerror=function(){e(new Error("ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•"))},a.src=n.originalPath}))},updateImageList:function(n){var t=this.imageList,e=t.concat(n);this.setData({imageList:e})},removeImage:function(n){var t=n.currentTarget.dataset.index,e=this.imageList;e.splice(t,1),this.setData({imageList:e}),this.checkCanPublish()},submitPost:function(){if(this.canPublish){var n=this.title&&this.title.trim(),t=this.content&&this.content.trim();if(!n||t){if("poem"===this.publishMode&&!this.isOriginal){var e=this.author&&this.author.trim();if(!e)return void uni.showToast({title:"ÈùûÂéüÂàõËØóÊ≠åÂøÖÈ°ªÂ°´ÂÜô‰ΩúËÄÖ",icon:"none"})}console.log("Êèê‰∫§Â∏ñÂ≠ê:",{imageList:this.imageList,title:this.title,content:this.content}),"poem"!==this.publishMode||this.isOriginal?(uni.showLoading({title:"ÂèëÂ∏É‰∏≠..."}),this.imageList.length>0?this.uploadImagesAndSubmit():this.submitTextOnly()):this.checkDuplicatePoem()}else uni.showToast({title:"ËØ∑ËæìÂÖ•Ê≠£ÊñáÂÜÖÂÆπ",icon:"none"})}else uni.showToast({title:"ËØ∑Ëá≥Â∞ë‰∏ä‰º†ÂõæÁâáÊàñËæìÂÖ•ÂÜÖÂÆπ",icon:"none"})},checkDuplicatePoem:function(){var n=this;uni.showLoading({title:"Ê£ÄÊü•‰∏≠..."}),this.callCloudFunction("checkDuplicatePoem",{title:this.title.trim(),author:this.author.trim(),isOriginal:this.isOriginal}).then((function(t){uni.hideLoading(),console.log("ÈáçÂ§çÊ£ÄÊü•ÁªìÊûú:",t.result),t.result.success?t.result.isDuplicate?n.showDuplicateConfirmDialog(t.result.duplicateCount):n.proceedWithPublish():uni.showToast({title:"Ê£ÄÊü•Â§±Ë¥•ÔºåËØ∑ÈáçËØï",icon:"none"})})).catch((function(n){uni.hideLoading(),console.error("Ê£ÄÊü•ÈáçÂ§çÂ§±Ë¥•:",n),uni.showToast({title:"ÁΩëÁªúÈîôËØØÔºåËØ∑ÈáçËØï",icon:"none"})}))},showDuplicateConfirmDialog:function(n){var t=this;uni.showModal({title:"ÂèëÁé∞ÈáçÂ§çËØóÊ≠å",content:"Â∑≤Êúâ ".concat(n," ÁØáÁõ∏ÂêåÁöÑËØóÊ≠åÂèëÂ∏ÉÔºåÊòØÂê¶ÁªßÁª≠ÂèëÂ∏ÉÔºü"),confirmText:"ÁªßÁª≠ÂèëÂ∏É",cancelText:"ÂèñÊ∂àÂèëÂ∏É",success:function(n){n.confirm?t.proceedWithPublish():console.log("Áî®Êà∑ÂèñÊ∂àÂèëÂ∏ÉÈáçÂ§çËØóÊ≠å")}})},proceedWithPublish:function(){uni.showLoading({title:"ÂèëÂ∏É‰∏≠..."}),this.imageList.length>0?this.uploadImagesAndSubmit():this.submitTextOnly()},uploadImagesAndSubmit:function(){var n=this,t=(new Date).getTime(),e=this.imageList;console.log("ÂºÄÂßã‰∏ä‰º†ÂõæÁâá:",e.length+"Âº†");var a=e.map((function(e,a){return new Promise((function(i,s){var l=t+a,r="post_images/".concat(l,"_compressed.jpg");n.uploadFile(r,e.compressedPath).then((function(t){console.log("ÂéãÁº©Âõæ‰∏ä‰º†ÊàêÂäü:",t),console.log("ÂéãÁº©ÂõæfileID:",t.fileID),console.log("ÂéãÁº©ÂõæfileIDÁ±ªÂûã:",(0,o.default)(t.fileID));var a=t.fileID;if(e.needCompression){var s="post_images/".concat(l,"_original.jpg");return n.uploadFile(s,e.originalPath).then((function(n){console.log("ÂéüÂõæ‰∏ä‰º†ÊàêÂäü:",n),console.log("ÂéüÂõæfileID:",n.fileID),console.log("ÂéüÂõæfileIDÁ±ªÂûã:",(0,o.default)(n.fileID)),i({compressedUrl:a,originalUrl:n.fileID})}))}i({compressedUrl:a,originalUrl:a})})).catch(s)}))}));Promise.all(a).then((function(t){return console.log("ÊâÄÊúâÂõæÁâá‰∏ä‰º†ÂÆåÊàê:",t),n.submitWithContentCheck(t)})).catch((function(t){console.error("‰∏ä‰º†Â§±Ë¥•:",t),n.publishFail(t)}))},submitToDatabase:function(n){var t=this;console.log("Êèê‰∫§Âà∞Êï∞ÊçÆÂ∫ì:",{uploadResults:n,title:this.title,content:this.content,publishMode:this.publishMode,isOriginal:this.isOriginal}),console.log("uploadResultsËØ¶ÁªÜ‰ø°ÊÅØ:",n),console.log("uploadResultsÈïøÂ∫¶:",n.length);var e=n.map((function(n){return n.compressedUrl})),a=n.map((function(n){return n.originalUrl}));console.log("Â§ÑÁêÜÂêéÁöÑÂõæÁâáURLs:",{imageUrls:e,originalImageUrls:a,imageUrlsType:e.map((function(n){return(0,o.default)(n)})),originalImageUrlsType:a.map((function(n){return(0,o.default)(n)})),imageUrlsValues:e.map((function(n){return n?n.substring(0,50)+"...":"null/undefined"}))});var i="";if("poem"===this.publishMode)if(this.isOriginal){var s=uni.getStorageSync("userInfo"),l=s?s.nickName:"ÂåøÂêçÁî®Êà∑";i=this.author&&this.author.trim()?this.author.trim():l}else i=this.author&&this.author.trim()?this.author.trim():"";var r={title:this.title,content:this.content,createTime:new Date,votes:0,isPoem:"poem"===this.publishMode,isOriginal:this.isOriginal,author:i,tags:this.selectedTags||[]};e.length>0&&(r.imageUrl=e[0],r.imageUrls=e,r.originalImageUrl=a[0],r.originalImageUrls=a,"poem"===this.publishMode&&e.length>0&&(r.poemBgImage=e[0]));var c=e.filter((function(n){return n})),u=a.filter((function(n){return n}));console.log("‰º†ÈÄíÁªô‰∫ëÂáΩÊï∞ÁöÑÂèÇÊï∞:",{fileIDs:c,originalFileIDs:u,fileIDsLength:c.length,originalFileIDsLength:u.length});var d={title:this.title,content:this.content,fileIDs:c,originalFileIDs:u,publishMode:this.publishMode,isOriginal:this.isOriginal,author:this.author,tags:this.selectedTags||[]};return this.callCloudFunction("contentCheck",d).then((function(n){var e;(console.log("Êï∞ÊçÆÂ∫ìÊèê‰∫§ÊàêÂäü:",n),n&&n.result&&0===n.result.code)?t.publishSuccess({_id:n.result.postId}):(console.error("‰∫ëÂáΩÊï∞ËøîÂõûÂ§±Ë¥•:",n),t.publishFail(new Error((null===(e=n.result)||void 0===e?void 0:e.msg)||"‰∫ëÂáΩÊï∞ËøîÂõûÂ§±Ë¥•")))})).catch((function(n){console.error("Êï∞ÊçÆÂ∫ìÊèê‰∫§Â§±Ë¥•:",n),t.publishFail(n)}))},submitTextOnly:function(){this.submitWithContentCheck([])},submitWithContentCheck:function(n){return console.log("ÂºÄÂßãÂÜÖÂÆπÂÆ°Ê†∏ÂíåÊèê‰∫§:",{uploadResults:n,title:this.title,content:this.content,publishMode:this.publishMode,isOriginal:this.isOriginal,author:this.author,tags:this.selectedTags}),console.log("‚ö†Ô∏è ÂÜÖÂÆπÂÆ°Ê†∏Â∑≤ÊöÇÊó∂ÂÖ≥Èó≠ÔºåÁõ¥Êé•ÂèëÂ∏ÉÂÜÖÂÆπ"),this.submitToDatabase(n)},publishSuccess:function(n){uni.hideLoading(),uni.showToast({title:"ÂèëÂ∏ÉÊàêÂäüÔºÅ"});try{uni.setStorageSync("shouldRefreshIndex",!0),uni.setStorageSync("shouldRefreshProfile",!0),uni.setStorageSync("shouldRefreshPoem",!0),uni.setStorageSync("shouldRefreshMountain",!0)}catch(t){console.log("CatchClause",t),console.log("CatchClause",t)}this.setData({isPublished:!0}),this.clearDraft(),uni.navigateBack({delta:1})},publishFail:function(n){uni.hideLoading(),console.error("[ÂèëÂ∏ÉÊµÅÁ®ã] Â§±Ë¥•Ôºö",n);var t="ÂèëÂ∏ÉÂ§±Ë¥•";n&&n.message?t="ÂèëÂ∏ÉÂ§±Ë¥•: ".concat(n.message):n&&n.errMsg&&(t="ÂèëÂ∏ÉÂ§±Ë¥•: ".concat(n.errMsg)),uni.showModal({title:"ÂèëÂ∏ÉÂ§±Ë¥•",content:t,showCancel:!1,confirmText:"Á°ÆÂÆö"})},onImageError:function(n){uni.showToast({title:"ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•",icon:"none"}),console.error("ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•",n)},toggleTagSelector:function(){this.setData({showTagSelector:!this.showTagSelector})},selectTag:function(n){var t=n.currentTarget.dataset.tag,e=this.selectedTags;if(e.includes(t)){var a=e.indexOf(t);e.splice(a,1)}else{if(!(e.length<5))return void uni.showToast({title:"ÊúÄÂ§öÈÄâÊã©5‰∏™Ê†áÁ≠æ",icon:"none"});e.push(t)}this.setData({selectedTags:e})},onCustomTagInput:function(n){var t=this,e=n.detail.value;console.log("„ÄêÊ†áÁ≠æËæìÂÖ•„ÄëÁî®Êà∑ËæìÂÖ•:",e),this.setData({customTag:e}),this.searchTimer&&clearTimeout(this.searchTimer),this.searchTimer=setTimeout((function(){console.log("„ÄêÊ†áÁ≠æÊêúÁ¥¢„ÄëÂºÄÂßãÊêúÁ¥¢ÂåπÈÖçÊ†áÁ≠æ:",e),t.searchMatchingTags(e)}),300)},addCustomTag:function(){var n=this.customTag.trim();if(n)if(this.selectedTags.includes(n))uni.showToast({title:"Ê†áÁ≠æÂ∑≤Â≠òÂú®",icon:"none"});else if(this.selectedTags.length>=5)uni.showToast({title:"ÊúÄÂ§öÈÄâÊã©5‰∏™Ê†áÁ≠æ",icon:"none"});else{var t=[].concat((0,i.default)(this.selectedTags),[n]);this.setData({selectedTags:t,customTag:""})}else uni.showToast({title:"ËØ∑ËæìÂÖ•Ê†áÁ≠æ",icon:"none"})},removeTag:function(n){var t=n.currentTarget.dataset.tag,e=this.selectedTags.filter((function(n){return n!==t}));this.setData({selectedTags:e})},switchCategory:function(n){var t=n.currentTarget.dataset.index;this.setData({currentCategoryIndex:t})},getCurrentCategoryTags:function(){return this.tagCategories[this.currentCategoryIndex].tags},loadAllExistingTags:function(){var n=this;console.log("„ÄêÊ†áÁ≠æÂä†ËΩΩ„ÄëÂºÄÂßãÂä†ËΩΩÊâÄÊúâÂ∑≤ÊúâÊ†áÁ≠æ..."),this.callCloudFunction("getAllTags",{}).then((function(t){console.log("„ÄêÊ†áÁ≠æÂä†ËΩΩ„Äë‰∫ëÂáΩÊï∞ËøîÂõûÁªìÊûú:",t),t.result&&t.result.success?(n.setData({allExistingTags:t.result.tags}),console.log("„ÄêÊ†áÁ≠æÂä†ËΩΩ„ÄëÂ∑≤Âä†ËΩΩÊâÄÊúâÊ†áÁ≠æ:",t.result.tags.length,"‰∏™Ê†áÁ≠æ:",t.result.tags)):console.error("„ÄêÊ†áÁ≠æÂä†ËΩΩ„Äë‰∫ëÂáΩÊï∞ËøîÂõûÂ§±Ë¥•:",t.result)})).catch((function(n){console.error("„ÄêÊ†áÁ≠æÂä†ËΩΩ„ÄëËé∑ÂèñÊ†áÁ≠æÂ§±Ë¥•:",n)}))},searchMatchingTags:function(n){var t=this;if(console.log("„ÄêÊ†áÁ≠æÊêúÁ¥¢„ÄëÊêúÁ¥¢ÂèÇÊï∞:",{inputValue:n,inputLength:n?n.length:0,allExistingTags:this.allExistingTags,selectedTags:this.selectedTags}),!n||n.length<2)return console.log("„ÄêÊ†áÁ≠æÊêúÁ¥¢„ÄëËæìÂÖ•ÈïøÂ∫¶‰∏çË∂≥ÔºåÊ∏ÖÁ©∫ÂåπÈÖçÁªìÊûú"),void this.setData({matchedTags:[],showMatchedTags:!1});var e=this.allExistingTags;console.log("„ÄêÊ†áÁ≠æÊêúÁ¥¢„ÄëÂºÄÂßãÂåπÈÖçÔºåÊÄªÊ†áÁ≠æÊï∞:",e.length);var a=e.filter((function(e){var a=e.toLowerCase().includes(n.toLowerCase()),i=!t.selectedTags.includes(e);return console.log('„ÄêÊ†áÁ≠æÊêúÁ¥¢„ÄëÊ£ÄÊü•Ê†áÁ≠æ"'.concat(e,'": ÂåπÈÖç=').concat(a,", Êú™ÈÄâ‰∏≠=").concat(i)),a&&i})).slice(0,5);console.log("„ÄêÊ†áÁ≠æÊêúÁ¥¢„ÄëÂåπÈÖçÁªìÊûú:",a),this.setData({matchedTags:a,showMatchedTags:a.length>0}),console.log("„ÄêÊ†áÁ≠æÊêúÁ¥¢„ÄëËÆæÁΩÆÁä∂ÊÄÅ:",{matchedTags:a,showMatchedTags:a.length>0})},selectMatchedTag:function(n){var t=n.currentTarget.dataset.tag;if(this.selectedTags.includes(t))uni.showToast({title:"Ê†áÁ≠æÂ∑≤Â≠òÂú®",icon:"none"});else if(this.selectedTags.length>=5)uni.showToast({title:"ÊúÄÂ§öÈÄâÊã©5‰∏™Ê†áÁ≠æ",icon:"none"});else{var e=[].concat((0,i.default)(this.selectedTags),[t]);this.setData({selectedTags:e,customTag:"",showMatchedTags:!1,matchedTags:[]})}},hasContent:function(){var n=this.title&&this.title.trim(),t=this.content&&this.content.trim(),e=this.imageList.length>0,a=this.selectedTags.length>0;return n||t||e||a},checkAndSaveDraft:function(){var n=this;this.hasContent()&&uni.showModal({title:"‰øùÂ≠òËçâÁ®ø",content:"Ê£ÄÊµãÂà∞ÊÇ®ÊúâÊú™ÂÆåÊàêÁöÑÂÜÖÂÆπÔºåÊòØÂê¶‰øùÂ≠ò‰∏∫ËçâÁ®øÔºü",confirmText:"‰øùÂ≠ò",cancelText:"‰∏ç‰øùÂ≠ò",success:function(t){t.confirm?n.saveDraft():n.clearDraft()}})},saveDraft:function(){var n=this,t={title:this.title,content:this.content,imageList:this.imageList,publishMode:this.publishMode,isOriginal:this.isOriginal,selectedTags:this.selectedTags,customTag:this.customTag,author:this.author,saveTime:new Date};uni.showLoading({title:"‰øùÂ≠ò‰∏≠..."}),this.callCloudFunction("getMyProfileData",{action:"saveDraft",draftData:t}).then((function(t){var e;(uni.hideLoading(),t.result&&t.result.success)?(uni.showToast({title:"ËçâÁ®øÂ∑≤‰øùÂ≠ò",icon:"success"}),n.clearDraft()):(console.error("‰øùÂ≠òËçâÁ®øÂ§±Ë¥•:",t.result),uni.showToast({title:(null===(e=t.result)||void 0===e?void 0:e.message)||"‰øùÂ≠òËçâÁ®øÂ§±Ë¥•",icon:"none"}))})).catch((function(n){uni.hideLoading(),console.error("‰øùÂ≠òËçâÁ®øÂ§±Ë¥•:",n),uni.showToast({title:"ÁΩëÁªúÈîôËØØÔºå‰øùÂ≠òÂ§±Ë¥•",icon:"none"})}))},loadDraft:function(){var n=this;try{var t=uni.getStorageSync("publish_draft");if(t&&t.saveTime){var e=(new Date).getTime(),a=e-t.saveTime;a<6048e5?uni.showModal({title:"ÊÅ¢Â§çËçâÁ®ø",content:"Ê£ÄÊµãÂà∞ÊÇ®ÊúâÊú™ÂÆåÊàêÁöÑËçâÁ®øÔºåÊòØÂê¶ÊÅ¢Â§çÔºü",confirmText:"ÊÅ¢Â§ç",cancelText:"ÈáçÊñ∞ÂºÄÂßã",success:function(e){e.confirm?(n.setData({title:t.title||"",content:t.content||"",imageList:t.imageList||[],publishMode:t.publishMode||"normal",isOriginal:t.isOriginal||!1,selectedTags:t.selectedTags||[],customTag:t.customTag||"",author:t.author||"",maxImageCount:"poem"===t.publishMode?1:9}),n.checkCanPublish(),uni.showToast({title:"ËçâÁ®øÂ∑≤ÊÅ¢Â§ç",icon:"success"})):n.clearDraft()}}):this.clearDraft()}}catch(i){console.log("CatchClause",i),console.log("CatchClause",i),console.error("Âä†ËΩΩËçâÁ®øÂ§±Ë¥•:",i)}},loadEditingDraft:function(){try{var n=uni.getStorageSync("editing_draft");n&&(this.setData({title:n.title||"",content:n.content||"",imageList:n.imageList||[],publishMode:n.publishMode||"normal",isOriginal:n.isOriginal||!1,selectedTags:n.selectedTags||[],customTag:n.customTag||"",author:n.author||"",maxImageCount:"poem"===n.publishMode?1:9}),this.checkCanPublish(),uni.showToast({title:"ËçâÁ®øÂ∑≤Âä†ËΩΩ",icon:"success"}),uni.removeStorageSync("editing_draft"))}catch(t){console.log("CatchClause",t),console.log("CatchClause",t),console.error("Âä†ËΩΩÁºñËæëËçâÁ®øÂ§±Ë¥•:",t),uni.showToast({title:"Âä†ËΩΩËçâÁ®øÂ§±Ë¥•",icon:"none"})}},clearDraft:function(){try{uni.removeStorageSync("publish_draft")}catch(n){console.log("CatchClause",n),console.log("CatchClause",n),console.error("Ê∏ÖÈô§ËçâÁ®øÂ§±Ë¥•:",n)}}}};t.default=r},"8f2e":function(n,t,e){var a=e("c86c");t=a(!1),t.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* pages/add/add.wxss */uni-page-body[data-v-1b829688]{height:100vh;overflow:hidden /* È°µÈù¢Á∫ßÂà´Á¶ÅÊ≠¢ÊªöÂä® */}.container[data-v-1b829688]{background:#fff;height:100vh; /* Êîπ‰∏∫Âõ∫ÂÆöÈ´òÂ∫¶ÔºåÁ°Æ‰øùÂú®iOS‰∏ãÊ≠£Á°ÆËÆ°ÁÆó */display:flex;flex-direction:column;padding-bottom:%?120?%; /* ‰∏∫Â∫ïÈÉ®Â∑•ÂÖ∑Ê†èÁïôÂá∫Á©∫Èó¥ÔºåÈÅøÂÖçÂÜÖÂÆπË¢´ÈÅÆÊå° */box-sizing:border-box; /* Á°Æ‰øùpaddingËÆ°ÁÆóÂú®ÂÜÖ */overflow:hidden; /* Èò≤Ê≠¢Êï¥‰∏™È°µÈù¢ÊªöÂä® */position:relative; /* Á°Æ‰øùÂÆö‰Ωç‰∏ä‰∏ãÊñá */transition:padding-bottom .3s ease-out /* ‰∏∫ padding ÂèòÂåñÊ∑ªÂä†ËøáÊ∏° */}\n/* ÂèëÂ∏ÉÊåâÈíÆÊ†∑Âºè */.publish-btn[data-v-1b829688]{background:#e0e0e0;color:#999;padding:%?16?% %?32?%;border-radius:%?50?%;font-size:%?28?%;transition:all .3s ease;margin-left:auto}.publish-btn.active[data-v-1b829688]{background:#9ed7ee;color:#fff}\n/* ÂõæÁâáÈ¢ÑËßàÂå∫Âüü */.image-section[data-v-1b829688]{padding:%?30?%;background:#f8f9fa}.image-preview-scroll[data-v-1b829688]{width:100%;white-space:nowrap}.image-preview-container[data-v-1b829688]{display:flex;gap:%?20?%;padding:0 %?10?%}.image-preview-item[data-v-1b829688]{position:relative;width:%?200?%;height:%?200?%;border-radius:%?12?%;overflow:hidden;flex-shrink:0}.preview-image[data-v-1b829688]{width:100%;height:100%;border-radius:%?12?%}.image-remove-btn[data-v-1b829688]{position:absolute;top:%?-8?%;right:%?-8?%;width:%?40?%;height:%?40?%;background:#f44;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:%?24?%;font-weight:700;box-shadow:0 %?2?% %?8?% rgba(0,0,0,.2)}.add-image-btn[data-v-1b829688]{width:%?200?%;height:%?200?%;border:%?2?% dashed #ddd;border-radius:%?12?%;display:flex;align-items:center;justify-content:center;background:#fff;transition:all .3s ease;flex-shrink:0}.add-image-btn[data-v-1b829688]:active{background:#f5f5f5;border-color:#9ed7ee}.add-icon[data-v-1b829688]{font-size:%?60?%;color:#999}\n/* ÂÜÖÂÆπËæìÂÖ•Âå∫Âüü */.content-section[data-v-1b829688]{padding:%?30?%;padding-bottom:%?30?%; /* Ëøõ‰∏ÄÊ≠•ÂáèÂ∞ëÂ∫ïÈÉ®Èó¥Ë∑ùÔºåËÆ©ËæìÂÖ•Ê°ÜÊõ¥Êé•ËøëÂ∫ïÈÉ®Â∑•ÂÖ∑Ê†è */background:#fff;flex:1;display:flex;flex-direction:column;min-height:0; /* ÂÖ≥ÈîÆÔºöÂÖÅËÆ∏flexÂ≠êÂÖÉÁ¥†Êî∂Áº© */overflow:hidden; /* Èò≤Ê≠¢ÂÜÖÂÆπÊ∫¢Âá∫ */position:relative /* Á°Æ‰øùÂÆö‰Ωç‰∏ä‰∏ãÊñá */}.title-input-wrapper[data-v-1b829688]{margin-bottom:%?30?%}.title-input[data-v-1b829688]{width:100%;height:%?80?%;border:none;border-bottom:%?1?% solid #f0f0f0;font-size:%?32?%;padding:0;background:transparent}.title-input[data-v-1b829688]:focus{border-bottom-color:#2897ad}.content-input-wrapper[data-v-1b829688]{position:relative;flex:1;display:flex;flex-direction:column;margin-bottom:%?0?%; /* ÊúÄÂ∞èÂåñÂ∫ïÈÉ®Èó¥Ë∑ùÔºåËÆ©ËæìÂÖ•Ê°ÜÊõ¥Êé•ËøëÂ∫ïËæπÊ†è */min-height:0; /* ÂÖ≥ÈîÆÔºöÂÖÅËÆ∏flexÂ≠êÂÖÉÁ¥†Êî∂Áº© */overflow:hidden /* Èò≤Ê≠¢ÂÜÖÂÆπÊ∫¢Âá∫ */}.content-textarea[data-v-1b829688]{flex:1;width:100%;height:100%; /* Âõ∫ÂÆöÈ´òÂ∫¶ÔºåÂ°´ÂÖÖÁà∂ÂÆπÂô® */border:none;font-size:%?30?%;line-height:1.6;padding:0;background:transparent;resize:none;overflow-y:auto; /* ÂÖÅËÆ∏ÂûÇÁõ¥ÊªöÂä® */overflow-x:hidden; /* Á¶ÅÊ≠¢Ê∞¥Âπ≥ÊªöÂä® */-webkit-appearance:none;appearance:none;-webkit-box-sizing:border-box;box-sizing:border-box;\n    /* Á°Æ‰øùÂú®iOS‰∏äÊ≠£Á°ÆÊòæÁ§∫ */-webkit-user-select:text;user-select:text;-webkit-touch-callout:default;\n    /* Èò≤Ê≠¢iOS‰∏äÁöÑÈªòËÆ§Ê†∑ÂºèÂπ≤Êâ∞ */border-radius:0;outline:none;\n    /* Á°Æ‰øùÊªöÂä®Ë°å‰∏∫ */-webkit-overflow-scrolling:touch; /* iOSÂπ≥ÊªëÊªöÂä® */position:relative /* Á°Æ‰øùÂÆö‰Ωç‰∏ä‰∏ãÊñá */}.char-count[data-v-1b829688]{position:absolute;bottom:%?10?%; /* ÁßªÂà∞textareaÂ§ñÈù¢ÔºåÁªôÊñáÂ≠óÁïôÂá∫Á©∫Èó¥ */right:0;font-size:%?24?%;color:#666;background:#fdfdfd;padding:%?8?% %?12?%;border-radius:%?6?%;box-shadow:none;pointer-events:none /* Èò≤Ê≠¢ÈÅÆÊå°textareaÁöÑÁÇπÂáª */}\n/* ‰ΩúËÄÖËæìÂÖ•Âå∫ÂüüÊ†∑Âºè */.author-input-wrapper[data-v-1b829688]{margin-bottom:%?30?%}.author-input[data-v-1b829688]{width:100%;height:%?80?%;border:none;border-bottom:%?1?% solid #f0f0f0;font-size:%?32?%;padding:0;background:transparent}.author-input[data-v-1b829688]:focus{border-bottom-color:#9ed7ee}\n/* ÂÜôËØóÂ≠êËèúÂçï */.poem-submenu[data-v-1b829688]{position:fixed;bottom:%?120?%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);background:#fff;border-radius:%?12?%;padding:%?20?%;display:flex;gap:%?40?%;z-index:99;box-shadow:0 %?-4?% %?20?% rgba(0,0,0,.1);-webkit-animation:slideUp-data-v-1b829688 .3s ease;animation:slideUp-data-v-1b829688 .3s ease;border:%?1?% solid #f0f0f0;margin-left:%?-98?% /* ÂêëÂ∑¶ÂÅèÁßªÔºåÂØπÈΩêÂÜôËØóÊåâÈíÆ */}.submenu-item[data-v-1b829688]{display:flex;flex-direction:column;align-items:center;padding:%?10?%;transition:all .3s ease}.submenu-item[data-v-1b829688]:active{-webkit-transform:scale(.95);transform:scale(.95)}.submenu-icon[data-v-1b829688]{font-size:%?40?%;margin-bottom:%?8?%}.submenu-text[data-v-1b829688]{font-size:%?22?%;color:#666}@-webkit-keyframes slideUp-data-v-1b829688{from{-webkit-transform:translateX(-50%) translateY(100%);transform:translateX(-50%) translateY(100%);opacity:0}to{-webkit-transform:translateX(-50%) translateY(0);transform:translateX(-50%) translateY(0);opacity:1}}@keyframes slideUp-data-v-1b829688{from{-webkit-transform:translateX(-50%) translateY(100%);transform:translateX(-50%) translateY(100%);opacity:0}to{-webkit-transform:translateX(-50%) translateY(0);transform:translateX(-50%) translateY(0);opacity:1}}\n/* Â∫ïÈÉ®Â∑•ÂÖ∑Ê†è */.toolbar[data-v-1b829688]{position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:%?1?% solid #f0f0f0;padding:%?20?% %?30?%;display:flex;align-items:center;gap:%?40?%;z-index:100;transition:bottom .3s ease-out /* ‰∏∫‰ΩçÁΩÆÂèòÂåñÊ∑ªÂä†ËøáÊ∏° */}.toolbar-item[data-v-1b829688]{display:flex;flex-direction:column;align-items:center;padding:%?10?%;transition:all .3s ease}.toolbar-item[data-v-1b829688]:active{-webkit-transform:scale(.95);transform:scale(.95)}.toolbar-icon[data-v-1b829688]{font-size:%?40?%;margin-bottom:%?8?%}.toolbar-text[data-v-1b829688]{font-size:%?22?%;color:#666}\n/* Ê†áÁ≠æÈÄâÊã©Âå∫ÂüüÊ†∑Âºè */.tag-section[data-v-1b829688]{position:fixed; /* Á°Æ‰øùÊ†áÁ≠æÈÄâÊã©Âô®ÊòØÂü∫‰∫éÁ™óÂè£ÂÆö‰ΩçÁöÑ */bottom:%?120?%; /* ÂàùÂßã‰ΩçÁΩÆÂú®Â∑•ÂÖ∑Ê†è‰∏äÊñπ */left:0;right:0;background:#f8f9fa;border-radius:%?12?%;padding:%?20?%;z-index:90; /* z-index ÊØîÂ∑•ÂÖ∑Ê†è‰ΩéÔºå‰ΩÜÊØîÂÜÖÂÆπÈ´ò */transition:bottom .3s ease-out /* ‰∏∫‰ΩçÁΩÆÂèòÂåñÊ∑ªÂä†ËøáÊ∏° */}.tag-header[data-v-1b829688]{display:flex;justify-content:space-between;align-items:center;padding:%?10?% 0;border-bottom:1px solid #eee;margin-bottom:%?20?%}.tag-title[data-v-1b829688]{font-size:%?30?%;font-weight:700;color:#333}.tag-count[data-v-1b829688]{font-size:%?24?%;color:#999}.tag-toggle[data-v-1b829688]{font-size:%?26?%;color:#9ed7ee}.selected-tags[data-v-1b829688]{display:flex;flex-wrap:wrap;gap:%?10?%;margin-bottom:%?20?%}.selected-tag[data-v-1b829688]{display:flex;align-items:center;background:#9ed7ee;color:#fff;padding:%?8?% %?16?%;border-radius:%?20?%;font-size:%?24?%}.remove-tag[data-v-1b829688]{margin-left:%?8?%;font-size:%?20?%;font-weight:700;cursor:pointer}.tag-selector[data-v-1b829688]{-webkit-animation:slideDown-data-v-1b829688 .3s ease;animation:slideDown-data-v-1b829688 .3s ease}\n/* ÂàÜÁ±ªÈÄâÊã©Âô®Ê†∑Âºè */.category-selector[data-v-1b829688]{margin-bottom:%?20?%;border-bottom:1px solid #eee;padding-bottom:%?15?%}.category-scroll[data-v-1b829688]{width:100%;white-space:nowrap}.category-list[data-v-1b829688]{display:flex;gap:%?15?%;padding:0 %?10?%}.category-item[data-v-1b829688]{display:flex;flex-direction:column;align-items:center;padding:%?10?% %?15?%;border-radius:%?12?%;background:#f5f5f5;transition:all .3s ease;min-width:%?80?%;flex-shrink:0}.category-item.active[data-v-1b829688]{background:#9ed7ee;color:#fff}.category-icon[data-v-1b829688]{font-size:%?24?%;margin-bottom:%?5?%}.category-name[data-v-1b829688]{font-size:%?20?%;text-align:center;line-height:1.2}\n/* ÂΩìÂâçÂàÜÁ±ªÊ†áÁ≠æÊ†∑Âºè */.current-category-tags[data-v-1b829688]{display:flex;flex-wrap:wrap;gap:%?10?%;margin-bottom:%?20?%}.preset-tag[data-v-1b829688]{padding:%?8?% %?16?%;background:#fff;border:1px solid #ddd;border-radius:%?20?%;font-size:%?24?%;color:#666;transition:all .3s ease}.preset-tag.selected[data-v-1b829688]{background:#9ed7ee;color:#fff;border-color:#9ed7ee}.custom-tag-input[data-v-1b829688]{display:flex;align-items:center;gap:%?10?%}.custom-tag-input uni-input[data-v-1b829688]{flex:1;height:%?60?%;border:1px solid #ddd;border-radius:%?8?%;padding:0 %?15?%;font-size:%?26?%}.custom-tag-input uni-button[data-v-1b829688]{background:#9ed7ee;color:#fff;border:none;border-radius:%?8?%;padding:0 %?20?%;height:%?60?%;font-size:%?24?%}\n/* ÂåπÈÖçÊ†áÁ≠æÊé®ËçêÊ†∑Âºè */.matched-tags[data-v-1b829688]{margin-top:%?15?%;padding:%?15?%;background:#f8f9fa;border-radius:%?8?%;border:1px solid #e9ecef}.matched-tags-title[data-v-1b829688]{font-size:%?24?%;color:#666;margin-bottom:%?10?%}.matched-tags-list[data-v-1b829688]{display:flex;flex-wrap:wrap;gap:%?8?%}.matched-tag[data-v-1b829688]{background:#e3f2fd;color:#1976d2;padding:%?6?% %?12?%;border-radius:%?12?%;font-size:%?22?%;border:1px solid #bbdefb;transition:all .2s ease}.matched-tag[data-v-1b829688]:active{background:#bbdefb;-webkit-transform:scale(.95);transform:scale(.95)}@-webkit-keyframes slideDown-data-v-1b829688{from{opacity:0;-webkit-transform:translateY(%?-10?%);transform:translateY(%?-10?%)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes slideDown-data-v-1b829688{from{opacity:0;-webkit-transform:translateY(%?-10?%);transform:translateY(%?-10?%)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}",""]),n.exports=t},"979d":function(n,t,e){"use strict";e.r(t);var a=e("6e3f"),i=e.n(a);for(var o in a)["default"].indexOf(o)<0&&function(n){e.d(t,n,(function(){return a[n]}))}(o);t["default"]=i.a},b14c:function(n,t,e){"use strict";var a=e("1d6a"),i=e.n(a);i.a}}]);