(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-splash-splash"],{"0b2c":function(e,t,a){var n=a("c86c");t=n(!1),t.push([e.i,"uni-page-body[data-v-ce1971f2]{margin:0;padding:0;height:100vh;overflow:hidden}.container[data-v-ce1971f2]{width:100vw;height:100vh;background-color:#fff;color:#000;display:flex;justify-content:center;align-items:center}\r\n\r\n/* ---- 阶段一：打字机 ---- */.typing-phase-container[data-v-ce1971f2]{position:relative;width:100%;height:100vh}\r\n\r\n/* ---- 文字层：固定高度，预留光标空间 ---- */.text-layer[data-v-ce1971f2]{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;min-height:%?120?% /* 预留足够空间给光标 */}.typewriter-effect[data-v-ce1971f2]{font-family:monospace;font-size:%?48?%;display:flex;align-items:center}.blinking-cursor[data-v-ce1971f2]{width:%?4?%;height:%?48?%;background-color:#000;margin-left:%?10?%;-webkit-animation:blink-data-v-ce1971f2 1s steps(1) infinite;animation:blink-data-v-ce1971f2 1s steps(1) infinite}.blinking-cursor.hidden[data-v-ce1971f2]{opacity:0!important;-webkit-animation:none!important;animation:none!important}@-webkit-keyframes blink-data-v-ce1971f2{50%{opacity:0}}@keyframes blink-data-v-ce1971f2{50%{opacity:0}}\r\n\r\n/* ---- 按钮层：独立定位 ---- */.enter-btn[data-v-ce1971f2]{position:absolute;bottom:%?200?%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);background-color:#f5f5f5;color:#333;border:%?3?% solid #ccc;border-radius:%?12?%;padding:%?24?% %?48?%;font-size:%?28?%;font-weight:500;font-family:Courier New,monospace;letter-spacing:%?2?%;text-transform:uppercase;box-shadow:0 %?4?% %?8?% rgba(0,0,0,.1);transition:all .3s ease;-webkit-animation:slideInUp-data-v-ce1971f2 .8s ease-out;animation:slideInUp-data-v-ce1971f2 .8s ease-out;overflow:hidden;display:flex;align-items:center;justify-content:center}.enter-btn[data-v-ce1971f2]:active{background-color:#e8e8e8;border-color:#999;box-shadow:0 %?2?% %?4?% rgba(0,0,0,.15);-webkit-transform:translateY(%?2?%);transform:translateY(%?2?%)}.enter-btn.loading[data-v-ce1971f2]{opacity:.6;cursor:not-allowed}.enter-btn.loading[data-v-ce1971f2]:active{-webkit-transform:none;transform:none}.enter-key-icon[data-v-ce1971f2]{font-size:%?32?%;margin-right:%?12?%;font-weight:700;color:#666}.enter-text[data-v-ce1971f2]{font-size:%?28?%;font-weight:500;font-family:Courier New,monospace;letter-spacing:%?2?%;text-transform:uppercase}\r\n\r\n/* ---- 换行后的光标 ---- */.new-line-cursor-container[data-v-ce1971f2]{display:flex;justify-content:center;align-items:center;margin-top:%?20?%}.new-line-cursor[data-v-ce1971f2]{width:%?4?%;height:%?48?%;background-color:#000;-webkit-animation:blink-data-v-ce1971f2 1s steps(1) infinite;animation:blink-data-v-ce1971f2 1s steps(1) infinite}@-webkit-keyframes slideInUp-data-v-ce1971f2{from{opacity:0;-webkit-transform:translateX(-50%) translateY(%?60?%);transform:translateX(-50%) translateY(%?60?%)}to{opacity:1;-webkit-transform:translateX(-50%) translateY(0);transform:translateX(-50%) translateY(0)}}@keyframes slideInUp-data-v-ce1971f2{from{opacity:0;-webkit-transform:translateX(-50%) translateY(%?60?%);transform:translateX(-50%) translateY(%?60?%)}to{opacity:1;-webkit-transform:translateX(-50%) translateY(0);transform:translateX(-50%) translateY(0)}}\r\n\r\n/* ---- 阶段二：开屏图 ---- */.image-phase-container[data-v-ce1971f2]{width:100%;height:100%;-webkit-animation:fadeIn-data-v-ce1971f2 .8s ease-in-out;animation:fadeIn-data-v-ce1971f2 .8s ease-in-out}.splash-image[data-v-ce1971f2]{width:100%;height:100%;object-fit:cover}@-webkit-keyframes fadeIn-data-v-ce1971f2{from{opacity:0}to{opacity:1}}@keyframes fadeIn-data-v-ce1971f2{from{opacity:0}to{opacity:1}}\r\n\r\n/* ---- 原有的样式（保留作为备用） ---- */.splash-container[data-v-ce1971f2]{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;margin:0;padding:0;overflow:hidden;background-color:#000;opacity:1;transition:opacity .8s ease-in-out}.splash-container.fade-out[data-v-ce1971f2]{opacity:0}.splash-image.zoom-out[data-v-ce1971f2]{-webkit-transform:scale(1.1);transform:scale(1.1)}.loading-indicator[data-v-ce1971f2]{position:absolute;bottom:%?100?%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);color:hsla(0,0%,100%,.8);font-size:%?28?%;z-index:10}",""]),e.exports=t},"0d62":function(e,t,a){var n=a("0b2c");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=a("967d").default;o("61aa93aa",n,!0,{sourceMap:!1,shadowMode:!1})},"4ddc":function(e,t,a){"use strict";a.r(t);var n=a("6c99"),o=a("8f20");for(var i in o)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(i);a("cb3b");var r=a("828b"),s=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"ce1971f2",null,!1,n["a"],void 0);t["default"]=s.exports},"4f6f":function(e,t,a){"use strict";a("6a54");var n=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("aa9c"),a("bf0f"),a("18f7"),a("de6c"),a("4626"),a("5ac7");var o=n(a("2634")),i=n(a("2fdc")),r=a("4073"),s=(r.imageManager,a("11ca")),l=s.cloudCall,c={data:function(){return{currentPhase:"typing",showEnterButton:!1,showNewLineCursor:!1,textMoveUp:!1,preloadCompleted:!1,fullText:"poementer",typedText:"",preloadedImagePath:"",preloadProgress:0,isPreloading:!1,splashImageUrl:"/static/images/splash.png",fadeOut:!1,zoomOut:!1}},onLoad:function(){this.executeTypingAnimation(),this.loadSplashImage()},methods:{callCloudFunction:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l(e,t,Object.assign({pageTag:"splash",context:this},a))},executeTypingAnimation:function(){var e=this,t=this.fullText,a=0;(function n(){if(a<t.length){e.setData({typedText:e.typedText+t[a]}),a++;var o=e.getTypingDelay(a,t);setTimeout(n,o)}else setTimeout((function(){e.setData({showEnterButton:!0,textMoveUp:!0})}),500)})()},getTypingDelay:function(e,t){var a=t[e-1],n=t[e],o=100;return o=" "===a?200:"e"===a&&"n"===n?600:"m"===a&&"e"===n?400:"t"===a&&"e"===n?180:"e"===a&&"r"===n?160:120+100*Math.random(),o},handleEnterButtonClick:function(){uni.vibrateShort(),this.preloadCompleted?(this.setData({showEnterButton:!1,showNewLineCursor:!0}),this.blinkNewLineCursorAndNavigate()):uni.showToast({title:"正在加载中...",icon:"loading",duration:1e3})},blinkNewLineCursorAndNavigate:function(){var e=this,t=0,a=setInterval((function(){t++,t>=2&&(clearInterval(a),setTimeout((function(){e.navigateToTarget()}),500))}),600)},loadSplashImage:function(){var e=this;return(0,i.default)((0,o.default)().mark((function t(){return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("使用默认本地开屏图"),e.setData({preloadedImagePath:"/static/images/splash.png"}),e.executeOriginalPreloadTasks();case 3:case"end":return t.stop()}}),t)})))()},executeOriginalPreloadTasks:function(){var e=this;return(0,i.default)((0,o.default)().mark((function t(){var a,n;return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=getApp(),n=[],a.globalData.userInfo&&a.globalData.openid&&(n.push(e.preloadTabIcons()),n.push(e.preloadPoemData()),n.push(e.preloadMountainData())),t.next=5,Promise.all(n);case 5:e.setData({preloadCompleted:!0}),console.log("预加载任务完成，等待用户点击进入按钮");case 7:case"end":return t.stop()}}),t)})))()},preloadPoemData:function(){var e=this;return new Promise(function(){var t=(0,i.default)((0,o.default)().mark((function t(a,n){return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.setData({isPreloading:!0}),e.callCloudFunction("getPostList",{skip:0,limit:5,isPoem:!0,isOriginal:!0}).then(function(){var t=(0,i.default)((0,o.default)().mark((function t(i){var r;return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(i.result&&i.result.success&&i.result.posts)){t.next=9;break}if(r=getApp(),r.globalData.preloadedPoemData=i.result.posts,!(i.result.posts.length>0)){t.next=9;break}return console.log("诗歌数据获取成功，开始预加载相关图片..."),t.next=8,e.preloadFirstPostImages(i.result.posts[0]);case 8:console.log("相关图片预加载完成！");case 9:a(),t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log("CatchClause",t.t0),console.log("CatchClause",t.t0),n(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.error("诗歌数据预加载失败:",e),n(e)})).finally((function(){console.log("诗歌数据预加载流程结束"),e.setData({preloadProgress:100,isPreloading:!1})}));case 2:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())},preloadMountainData:function(){var e=this;return new Promise(function(){var t=(0,i.default)((0,o.default)().mark((function t(a,n){return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.callCloudFunction("getPostList",{skip:0,limit:5,isPoem:!0,isOriginal:!1}).then(function(){var t=(0,i.default)((0,o.default)().mark((function t(i){var r;return(0,o.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(i.result&&i.result.success&&i.result.posts)){t.next=9;break}if(r=getApp(),r.globalData.preloadedMountainData=i.result.posts,!(i.result.posts.length>0)){t.next=9;break}return console.log("山页面数据获取成功，开始预加载相关图片..."),t.next=8,e.preloadFirstMountainImages(i.result.posts[0]);case 8:console.log("山页面相关图片预加载完成！");case 9:a(),t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log("CatchClause",t.t0),console.log("CatchClause",t.t0),n(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.error("山页面数据预加载失败:",e),n(e)}));case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())},preloadFirstMountainImages:function(e){var t=getApp();t.globalData.preloadedImages||(t.globalData.preloadedImages={});var a=[],n=e.poemBgImage||e.imageUrls&&e.imageUrls[0];return n&&a.push(new Promise((function(e){var a="undefined"!==typeof window;if(a&&(n.includes("tcb.qcloud.la")||n.includes("cloudbase")))return console.log("🔍 [H5] 山页面首张背景图检测到腾讯云存储URL，直接使用:",n),t.globalData.preloadedImages[n]=n,void e();uni.downloadFile({url:n,success:function(e){200===e.statusCode&&(console.log("山页面首张背景图预加载成功:",e.tempFilePath),t.globalData.preloadedImages[n]=e.tempFilePath)},fail:function(e){console.error("山页面背景图预加载失败:",n,e),a&&(console.log("🔍 [H5] 山页面背景图预加载失败，使用原URL:",n),t.globalData.preloadedImages[n]=n)},complete:function(){e()}})}))),e.authorAvatar&&a.push(new Promise((function(a){uni.downloadFile({url:e.authorAvatar,success:function(a){200===a.statusCode&&(console.log("山页面作者头像预加载成功"),t.globalData.preloadedImages[e.authorAvatar]=a.tempFilePath)},fail:function(t){console.error("山页面作者头像预加载失败:",e.authorAvatar,t)},complete:function(){a()}})}))),Promise.all(a)},preloadTabIcons:function(){return new Promise((function(e){var t=["/static/images/icons/home.png","/static/images/icons/home-active.png","/static/images/icons/examples.png","/static/images/icons/examples-active.png","/static/images/icons/usercenter.png","/static/images/icons/usercenter-active.png"],a=0,n=t.length;0!==n?t.forEach((function(t){uni.getImageInfo({src:t,complete:function(){a++,a===n&&(console.log("所有Tab图标预加载尝试完毕"),e())}})})):e()}))},preloadFirstPostImages:function(e){var t=getApp();t.globalData.preloadedImages||(t.globalData.preloadedImages={});var a=[],n=e.poemBgImage||e.imageUrls&&e.imageUrls[0];n&&a.push(new Promise((function(e){var a="undefined"!==typeof window;if(a&&(n.includes("tcb.qcloud.la")||n.includes("cloudbase")))return console.log("🔍 [H5] 首张背景图检测到腾讯云存储URL，直接使用:",n),t.globalData.preloadedImages[n]=n,void e();uni.downloadFile({url:n,success:function(e){200===e.statusCode&&(console.log("首张背景图预加载成功:",e.tempFilePath),t.globalData.preloadedImages[n]=e.tempFilePath)},fail:function(e){console.error("首张背景图预加载失败:",n,e),a&&(console.log("🔍 [H5] 首张背景图预加载失败，使用原URL:",n),t.globalData.preloadedImages[n]=n)},complete:function(){e()}})}))),e.authorAvatar&&a.push(new Promise((function(a){uni.downloadFile({url:e.authorAvatar,success:function(a){200===a.statusCode&&(console.log("作者头像预加载成功"),t.globalData.preloadedImages[e.authorAvatar]=a.tempFilePath)},complete:function(){a()}})})));return["/static/images/like.png","/static/images/liked.png"].forEach((function(e){a.push(new Promise((function(t){uni.getImageInfo({src:e,complete:function(){console.log("通用图片预加载尝试完毕:",e),t()}})})))})),Promise.all(a)},navigateToTarget:function(){this.startFadeOut(),setTimeout((function(){var e=getApp();e.globalData.userInfo&&e.globalData.openid?uni.switchTab({url:"/pages/poem/poem"}):uni.redirectTo({url:"/pages/login/login"})}),800)},startFadeOut:function(){this.setData({fadeOut:!0,zoomOut:!0})}}};t.default=c},"6c99":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"container"},["typing"===e.currentPhase?a("v-uni-view",{staticClass:"typing-phase-container"},[a("v-uni-view",{staticClass:"text-layer"},[a("v-uni-view",{staticClass:"typewriter-effect"},[a("v-uni-text",[e._v(e._s(e.typedText))]),a("v-uni-view",{class:"blinking-cursor "+(e.showNewLineCursor?"hidden":"")})],1),e.showNewLineCursor?a("v-uni-view",{staticClass:"new-line-cursor-container"},[a("v-uni-view",{staticClass:"new-line-cursor"})],1):e._e()],1),e.showEnterButton?a("v-uni-button",{class:"enter-btn "+(e.preloadCompleted?"":"loading"),on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleEnterButtonClick.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"enter-key-icon"},[e._v("↵")]),a("v-uni-text",{staticClass:"enter-text"},[e._v(e._s(e.preloadCompleted?"enter":"loading..."))])],1):e._e()],1):e._e(),e.isPreloading?a("v-uni-view",{staticClass:"loading-indicator"},[e._v("正在加载内容...")]):e._e()],1)},o=[]},"8f20":function(e,t,a){"use strict";a.r(t);var n=a("4f6f"),o=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=o.a},cb3b:function(e,t,a){"use strict";var n=a("0d62"),o=a.n(n);o.a}}]);