(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-post-detail-post-detail"],{"028d":function(n,t,r){"use strict";r.d(t,"b",(function(){return e})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){}));var e=function(){var n=this,t=n.$createElement,r=n._self._c||t;return r("v-uni-view",[n.showClone?r("v-uni-view",{staticClass:"modal-overlay"},[r("v-uni-view",{staticClass:"modal-content"},[r("v-uni-view",{staticClass:"modal-header"},[r("v-uni-view",{staticClass:"modal-title"},[n._v("选择作品集")]),r("v-uni-view",{staticClass:"header-actions"},[r("v-uni-view",{staticClass:"refresh-btn",class:{refreshing:n.isLoading},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.loadPortfolios.apply(void 0,arguments)}}},[n._v("⟳")]),r("v-uni-view",{staticClass:"close-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.hideModal.apply(void 0,arguments)}}},[n._v("×")])],1)],1),r("v-uni-view",{staticClass:"modal-body"},[n.isLoading?r("v-uni-view",{staticClass:"loading-container"},[r("v-uni-view",{staticClass:"loading-text"},[n._v("加载中...")])],1):n.portfolios.length>0?r("v-uni-view",{staticClass:"portfolios-list"},n._l(n.portfolios,(function(t,e){return r("v-uni-view",{key:e,class:"portfolio-item "+(n.selectedPortfolioId===t._id?"selected":""),attrs:{"data-portfolio-id":t._id},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.selectPortfolio.apply(void 0,arguments)}}},[r("v-uni-view",{staticClass:"portfolio-icon"},[n._v("📚")]),r("v-uni-view",{staticClass:"portfolio-info"},[r("v-uni-view",{staticClass:"portfolio-name"},[n._v(n._s(t.name))]),r("v-uni-view",{staticClass:"portfolio-count"},[n._v(n._s(t.itemCount)+" 个作品")])],1),n.selectedPortfolioId===t._id?r("v-uni-view",{staticClass:"selected-icon"},[n._v("✓")]):n._e()],1)})),1):r("v-uni-view",{staticClass:"empty-state"},[r("v-uni-view",{staticClass:"empty-icon"},[n._v("📚")]),r("v-uni-view",{staticClass:"empty-text"},[n._v("还没有作品集")]),r("v-uni-view",{staticClass:"empty-subtext"},[n._v("点击下方按钮创建一个作品集")])],1)],1),r("v-uni-view",{staticClass:"modal-footer"},[r("v-uni-button",{staticClass:"modal-btn secondary-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.createPortfolio.apply(void 0,arguments)}}},[n._v("创建作品集")]),r("v-uni-button",{staticClass:"modal-btn primary-btn",attrs:{disabled:!n.selectedPortfolioId},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.confirmAddToPortfolio.apply(void 0,arguments)}}},[n._v("确认添加")])],1)],1)],1):n._e(),n.showCreateModal?r("v-uni-view",{staticClass:"modal-overlay"},[r("v-uni-view",{staticClass:"modal-content create-modal"},[r("v-uni-view",{staticClass:"modal-header"},[r("v-uni-view",{staticClass:"modal-title"},[n._v("创建作品集")]),r("v-uni-view",{staticClass:"close-btn",on:{click:[function(t){arguments[0]=t=n.$handleEvent(t),n.hideCreateModal.apply(void 0,arguments)},function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.trueFun.apply(void 0,arguments)}]}},[n._v("×")])],1),r("v-uni-view",{staticClass:"modal-body"},[r("v-uni-input",{staticClass:"portfolio-name-input",attrs:{placeholder:"请输入作品集名称",value:n.newPortfolioName,focus:!0},on:{input:function(t){arguments[0]=t=n.$handleEvent(t),n.onPortfolioNameInput.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.trueFun.apply(void 0,arguments)}}})],1),r("v-uni-view",{staticClass:"modal-footer"},[r("v-uni-button",{staticClass:"modal-btn secondary-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.hideCreateModal.apply(void 0,arguments)}}},[n._v("取消")]),r("v-uni-button",{staticClass:"modal-btn primary-btn",attrs:{disabled:!n.newPortfolioName},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.createNewPortfolio.apply(void 0,arguments)}}},[n._v("创建")])],1)],1)],1):n._e()],1)},o=[]},"0691":function(n,t,r){"use strict";var e=r("f0b9"),o=r.n(e);o.a},"0fca":function(n,t,r){"use strict";r.r(t);var e=r("518f"),o=r.n(e);for(var a in e)["default"].indexOf(a)<0&&function(n){r.d(t,n,(function(){return e[n]}))}(a);t["default"]=o.a},"221b":function(n,t,r){var e=r("c86c");t=e(!1),t.push([n.i,".install_tip_back[data-v-a8601b98]{position:fixed;top:0;right:0;bottom:0;left:0;background-color:rgba(0,0,0,.4);z-index:1}.install_tip_close[data-v-a8601b98]{position:absolute;right:%?10?%;top:%?10?%;width:32px;height:32px\n    /* background-color: red; */}.install_tip_detail[data-v-a8601b98]{position:fixed;background-color:#fff;right:0;bottom:0;left:0;border-radius:%?40?% %?40?% 0 0;padding:%?50?% %?50?% %?100?% %?50?%;z-index:9}.install_tip_detail_title[data-v-a8601b98]{font-weight:400;font-size:%?40?%;text-align:center}.install_tip_detail_tip[data-v-a8601b98]{font-size:%?25?%;color:rgba(0,0,0,.4);margin-top:%?20?%;text-align:left}.install_tip_detail_buttons[data-v-a8601b98]{padding-top:%?50?%;display:flex}.install_tip_detail_button[data-v-a8601b98]{color:#07c160;font-weight:500;background-color:rgba(0,0,0,.1);width:40%;text-align:center;\n    /* height: 90rpx; */border-radius:%?10?%;margin:0 auto}.install_tip_detail_button_primary[data-v-a8601b98]{background-color:#07c160;color:#fff}",""]),n.exports=t},"320b":function(n,t,r){"use strict";r.r(t);var e=r("74e3"),o=r("0fca");for(var a in o)["default"].indexOf(a)<0&&function(n){r.d(t,n,(function(){return o[n]}))}(a);r("6ce6");var i=r("828b"),s=Object(i["a"])(o["default"],e["b"],e["c"],!1,null,"5a61cc78",null,!1,e["a"],void 0);t["default"]=s.exports},3255:function(n,t,r){var e=r("d242");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);var o=r("967d").default;o("8455b0aa",e,!0,{sourceMap:!1,shadowMode:!1})},"3b34":function(n,t,r){"use strict";r("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={data:function(){return{showTip:!1}},props:{showTipProps:Boolean,title:String,content:String},watch:{showTipProps:function(n){this.setData({showTip:n})}},methods:{onClose:function(){this.setData({showTip:!this.showTip})}},created:function(){}};t.default=e},"3ccb":function(n,t,r){"use strict";r.r(t);var e=r("3b34"),o=r.n(e);for(var a in e)["default"].indexOf(a)<0&&function(n){r.d(t,n,(function(){return e[n]}))}(a);t["default"]=o.a},"437fa":function(n,t,r){"use strict";r("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r("bf0f"),r("0c26");var e=r("11ca"),o=e.cloudCall,a={data:function(){return{portfolios:[],isLoading:!0,selectedPortfolioId:"",showCreateModal:!1,newPortfolioName:"",showClone:!1}},props:{show:{type:Boolean,default:!1},postId:{type:String,default:""}},watch:{show:{handler:function(n,t){var r=this;console.log("【portfolio-selector】show变化:",{newVal:n,oldVal:t}),this.showClone=n,n&&!t&&(console.log("【portfolio-selector】弹窗显示，开始加载作品集"),setTimeout((function(){r.showClone&&r.loadPortfolios()}),100))},immediate:!0}},methods:{callCloudFunction:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(n,t,Object.assign({pageTag:"portfolio-selector",context:this,requireAuth:!0},r))},loadPortfolios:function(){var n=this;console.log("开始加载作品集列表..."),this.setData({isLoading:!0}),this.callCloudFunction("getPortfolioFolders").then((function(t){if(console.log("portfolio-selector获取作品集:",t),t.result&&t.result.success){var r=t.result.folders||[];console.log("获取到作品集数量:",r.length);var e=n.selectedPortfolioId;e&&!r.some((function(n){return n._id===e}))&&(console.log("清空失效的选中状态"),n.setData({selectedPortfolioId:""})),n.setData({portfolios:r,isLoading:!1})}else{var o;console.error("获取作品集失败，返回结果:",t),uni.showToast({title:(null===(o=t.result)||void 0===o?void 0:o.message)||"加载失败",icon:"none"}),n.setData({isLoading:!1,portfolios:[],selectedPortfolioId:""})}})).catch((function(t){console.error("获取作品集失败:",t),console.error("错误详情:",t.errMsg||t.message),setTimeout((function(){n.showClone&&(console.log("重新尝试加载作品集..."),n.loadPortfolios())}),1e3),n.setData({isLoading:!1,portfolios:[],selectedPortfolioId:""})}))},selectPortfolio:function(n){var t=n.currentTarget.dataset.portfolioId;this.setData({selectedPortfolioId:t})},confirmAddToPortfolio:function(){var n=this,t=this.selectedPortfolioId,r=this.postId;if(console.log("确认添加到作品集，postId:",r,"folderId:",t),t){if(!r)return console.error("postId 为空，无法添加到作品集"),void uni.showToast({title:"参数错误：帖子ID为空",icon:"none"});uni.showLoading({title:"添加中..."}),this.callCloudFunction("addToPortfolio",{postId:r,folderId:t}).then((function(t){uni.hideLoading(),console.log("确认添加到作品集返回结果:",t),t&&t.result?t.result.success?(uni.showToast({title:"添加成功"}),console.log("添加成功，开始关闭弹窗"),n.setData({selectedPortfolioId:""}),setTimeout((function(){n.hideModal()}),1500),n.$emit("portfolioSuccess")):(console.error("添加到作品集业务失败:",t.result),uni.showToast({title:t.result.message||"添加失败",icon:"none"})):(console.error("添加到作品集返回格式异常:",t),uni.showToast({title:"添加失败：返回格式错误",icon:"none"}))})).catch((function(n){uni.hideLoading(),console.error("添加到作品集云函数调用失败:",n),uni.showToast({title:"网络错误："+(n.errMsg||"未知错误"),icon:"none"})}))}else uni.showToast({title:"请选择作品集",icon:"none"})},createPortfolio:function(){this.setData({showCreateModal:!0,newPortfolioName:""})},hideCreateModal:function(){this.setData({showCreateModal:!1,newPortfolioName:""})},onPortfolioNameInput:function(n){var t=n.detail.value;this.setData({newPortfolioName:t})},createNewPortfolio:function(){var n=this,t=this.newPortfolioName.trim();t?(this.setData({newPortfolioName:t}),console.log("组件开始创建作品集，名称:",t),uni.showLoading({title:"创建中..."}),this.callCloudFunction("createPortfolioFolder",{folderName:t}).then((function(t){uni.hideLoading(),console.log("组件创建作品集返回结果:",t),t&&t.result?t.result.success?(uni.showToast({title:"创建成功",duration:2e3}),n.setData({showCreateModal:!1}),setTimeout((function(){n.loadPortfolios()}),300)):(console.error("组件创建作品集业务失败:",t.result),uni.showToast({title:t.result.message||"创建失败",icon:"none",duration:3e3})):(console.error("组件创建作品集返回格式异常:",t),uni.showToast({title:"创建失败：返回格式错误",icon:"none",duration:3e3}))})).catch((function(n){uni.hideLoading(),console.error("组件创建作品集云函数调用失败:",n),uni.showToast({title:"创建失败: "+(n.errMsg||"网络错误"),icon:"none",duration:3e3})}))):uni.showToast({title:"请输入作品集名称",icon:"none"})},hideModal:function(){console.log("=== 点击关闭按钮，开始隐藏弹窗 ==="),console.log("当前状态：",{show:this.show,showCreateModal:this.showCreateModal,selectedPortfolioId:this.selectedPortfolioId}),this.setData({selectedPortfolioId:"",showClone:!1,showCreateModal:!1,newPortfolioName:""}),console.log("=== 弹窗已隐藏，状态已重置 ==="),this.$emit("hide")},trueFun:function(){console.log("占位：函数 true 未声明")}},created:function(){},mounted:function(){console.log("【portfolio-selector】组件mounted"),this.show&&(console.log("【portfolio-selector】mounted时show为true，开始加载作品集"),this.loadPortfolios())}};t.default=a},"518f":function(n,t,r){"use strict";r("6a54");var e=r("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=e(r("9b1b")),a=e(r("2634")),i=e(r("fcf3")),s=e(r("2fdc"));r("bf0f"),r("fd3c"),r("f3f7"),r("18f7"),r("de6c"),r("2797"),r("9db6"),r("08eb"),r("0c26"),r("8f71"),r("c223"),r("f7a5"),r("5ef2"),r("dd2b"),r("64aa"),r("bd06"),r("aa77"),r("7a76"),r("c9b5");var l=e(r("f7a1")),c=e(r("84be")),d=e(r("ee81")),u=r("7386"),f=e(r("c605")),m=e(r("f7a1")),p=e(r("84be")),v=(getApp(),r("fe58")),g=r("df61"),h=g.togglePostLike,w=r("8e86"),b=w.previewImage,y=r("139b"),k=y.formatRelativeTime,C=(r("a7cb"),r("05f6")),x=r("11ca"),_=x.cloudCall,I=r("2b90"),F={components:{cloudTipModal:l.default,folderSelector:c.default,portfolioSelector:d.default},mixins:[I],data:function(){return{post:null,comments:[],newComment:"",commentCount:0,isLoading:!0,isCommentLoading:!0,commentSkeletonCount:3,isSubmitDisabled:!0,replyToComment:null,replyToAuthor:"",showUploadTip:!1,votingInProgress:!1,imageContainerHeight:null,swiperHeights:{},imageClampHeights:{},showFavoriteModal:!1,showPortfolioModal:!1,isInputExpanded:!1,keyboardHeight:0,isFocus:!1,viewStartTime:0,currentPostId:null,isFavorited:!1,favoriteButtonText:"收藏",favoriteButtonClass:"favorite-button",showFollowButton:!1,isFollowing:!1,followPending:!1,isFollowedByAuthor:!1,isMutualFollow:!1,isOwnPost:!1,commentImages:[],maxCommentImages:3,isSubmittingComment:!1,imgindex:0,img:"",commentIndex:0,commentImage:"",imageIndex:0,replyIndex:0,reply:{authorAvatar:"",_openid:"",authorName:"",content:"",imageUrls:"",formattedCreateTime:"",_id:"",liked:"",likeIcon:"",likes:"",canDelete:""},replyImage:"",replyImageIndex:0}},onLoad:function(n){var t=n.id;t?(this.setData({currentPostId:t}),this.loadPostDetail(t)):(this.setData({isLoading:!1,isCommentLoading:!1}),uni.showToast({title:"无效的帖子ID",icon:"none"}))},onShow:function(){this.setData({viewStartTime:Date.now()})},onUnload:function(){this.recordViewBehavior()},onHide:function(){this.isInputExpanded&&this.collapseInput(),this.recordViewBehavior()},methods:{callCloudFunction:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _(n,t,Object.assign({pageTag:"post-detail",context:this},r))},loadPostDetail:function(n){var t=this;this.setData({isCommentLoading:!0}),this.callCloudFunction("getPostDetail",{postId:n},{injectOpenId:!1}).then(function(){var n=(0,s.default)((0,a.default)().mark((function n(r){var e,o;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!r.result||!r.result.post){n.next=18;break}return e=r.result.post,e.formattedCreateTime=t.formatTime(e.createTime),e.likeIcon=v.getLikeIcon(e.votes||0,e.isVoted||!1),n.next=6,(0,u.hydrateTempUrls)([e]);case 6:(0,u.warmTempUrlsFromPosts)([e]),console.log("loadPostDetail完整返回数据:",r.result),console.log("loadPostDetail获取到的commentCount:",r.result.commentCount,"类型:",(0,i.default)(r.result.commentCount)),console.log("loadPostDetail获取到的post.commentCount:",e.commentCount,"类型:",(0,i.default)(e.commentCount)),o=r.result.commentCount||e.commentCount||0,console.log("最终使用的commentCount:",o),t.setData({post:e,commentCount:o}),console.log("loadPostDetail设置后的commentCount:",t.commentCount),t.getComments(e&&e._id?e._id:""),t.prepareFollowState(e._openid),n.next=20;break;case 18:t.setData({isCommentLoading:!1}),uni.showToast({title:"帖子加载失败",icon:"none"});case 20:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(n){console.error("Failed to get post detail",n),t.setData({isCommentLoading:!1}),uni.showToast({title:"网络错误",icon:"none"})})).finally((function(){t.setData({isLoading:!1})}))},getComments:function(n){var t=this;this.setData({isCommentLoading:!0}),this.callCloudFunction("getComments",{postId:n},{injectOpenId:!1}).then(function(){var n=(0,s.default)((0,a.default)().mark((function n(r){var e,i,s,l,c,d;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!r.result||!r.result.comments){n.next=24;break}if(e=t.openid||uni.getStorageSync("openid"),i=r.result.comments.map((function(n){var r=(0,o.default)((0,o.default)({},n),{},{formattedCreateTime:t.formatTime(n.createTime),likeIcon:v.getLikeIcon(n.likes||0,n.liked||!1),canDelete:n._openid===e,imageUrls:n.imageUrls||[],originalImageUrls:n.originalImageUrls||[]});return n.replies&&(r.replies=n.replies.map((function(n){return(0,o.default)((0,o.default)({},n),{},{formattedCreateTime:t.formatTime(n.createTime),likeIcon:v.getLikeIcon(n.likes||0,n.liked||!1),canDelete:n._openid===e,imageUrls:n.imageUrls||[],originalImageUrls:n.originalImageUrls||[]})}))),r})),n.prev=3,s=new Set,i.forEach((function(n){(Array.isArray(n.imageUrls)?n.imageUrls:[]).forEach((function(n){"string"===typeof n&&n.startsWith("cloud://")&&s.add(n)})),(Array.isArray(n.replies)?n.replies:[]).forEach((function(n){return(Array.isArray(n.imageUrls)?n.imageUrls:[]).forEach((function(n){"string"===typeof n&&n.startsWith("cloud://")&&s.add(n)}))}))})),!(s.size>0)){n.next=11;break}return n.next=9,f.default.getTempUrls(Array.from(s));case 9:l=n.sent,i.forEach((function(n){Array.isArray(n.imageUrls)&&(n.imageUrls=n.imageUrls.map((function(n){return l[n]||n}))),Array.isArray(n.replies)&&(n.replies=n.replies.map((function(n){return(0,o.default)((0,o.default)({},n),{},{imageUrls:Array.isArray(n.imageUrls)?n.imageUrls.map((function(n){return l[n]||n})):n.imageUrls})})))}));case 11:n.next=15;break;case 13:n.prev=13,n.t0=n["catch"](3);case 15:console.log("getComments返回的commentCount:",r.result.commentCount),console.log("comments数组长度:",i.length),console.log("当前页面的commentCount:",t.commentCount),c=r.result.commentCount||i.length,d=c>t.commentCount,t.setData({comments:i,commentCount:d?c:t.commentCount}),console.log("更新后的commentCount:",t.commentCount),n.next=25;break;case 24:uni.showToast({title:"评论加载失败",icon:"none"});case 25:case"end":return n.stop()}}),n,null,[[3,13]])})));return function(t){return n.apply(this,arguments)}}()).catch((function(n){console.error("Failed to get comments",n),uni.showToast({title:"网络错误",icon:"none"})})).finally((function(){t.setData({isCommentLoading:!1})}))},onVote:function(n){var t=this,r=n.currentTarget.dataset.postid;if(!this.votingInProgress){this.setData({votingInProgress:!0});var e=this.post,o=e.votes,a=e.isVoted,i=a?o-1:o+1,s=!a,l=v.getLikeIcon(i,s);this.setData({"post.votes":i,"post.isVoted":s,"post.likeIcon":l}),h(r,{pageTag:"post-detail",context:this,currentVotes:o,currentIsLiked:a,requireAuth:!0}).then((function(n){if(n.success)t.setData({"post.votes":n.votes,"post.isVoted":n.isLiked,"post.likeIcon":n.likeIcon});else{var r=n.rollback||{votes:o,isLiked:a,likeIcon:v.getLikeIcon(o,a)};t.setData({"post.votes":r.votes,"post.isVoted":r.isLiked,"post.likeIcon":r.likeIcon})}})).catch((function(n){console.error("【帖子详情点赞】调用 likeService 失败",n),t.setData({"post.votes":o,"post.isVoted":a,"post.likeIcon":v.getLikeIcon(o,a)})})).finally((function(){t.setData({votingInProgress:!1})}))}},onFavorite:function(){this.isFavorited?uni.showToast({title:"已经收藏过了",icon:"none"}):this.setData({showFavoriteModal:!0})},onAddToPortfolio:function(){var n=this;console.log("【post-detail】点击作品集按钮"),this.post&&this.post._id?(console.log("【post-detail】显示作品集选择器，postId:",this.post._id),this.setData({showPortfolioModal:!0}),setTimeout((function(){console.log("【post-detail】延迟检查showPortfolioModal:",n.showPortfolioModal)}),100)):uni.showToast({title:"帖子信息无效",icon:"none"})},hideFavoriteModal:function(){this.setData({showFavoriteModal:!1})},onFavoriteSuccess:function(){this.hideFavoriteModal(),this.setData({isFavorited:!0,favoriteButtonText:"已收藏",favoriteButtonClass:"favorite-button favorited"}),uni.showToast({title:"收藏成功",icon:"success"});try{var n=getApp(),t=n&&n.globalData&&n.globalData.openid,r=this.post&&this.post._id;t&&r&&uni.$emit&&uni.$emit("favorite-changed",{userId:t,postId:r,favored:!0})}catch(e){}},hidePortfolioModal:function(){this.setData({showPortfolioModal:!1})},onPortfolioSuccess:function(){this.hidePortfolioModal(),uni.showToast({title:"添加成功",icon:"success"})},onCreateDiscussion:function(){this.post&&this.post._id?(console.log("【post-detail】跳转到创建讨论页面，postId:",this.post._id),uni.navigateTo({url:"/pages/create-discussion/create-discussion?postId=".concat(this.post._id),success:function(){console.log("【post-detail】跳转到创建讨论页面成功")},fail:function(n){console.error("【post-detail】跳转到创建讨论页面失败:",n),uni.showToast({title:"跳转失败",icon:"none"})}})):uni.showToast({title:"帖子信息无效",icon:"none"})},handlePreview:function(n){var t=b(n,{fallbackToast:!1});return t||uni.showToast({title:"图片加载失败",icon:"none"}),t},onImageError:function(n){console.error("图片加载失败",n)},onAvatarError:function(n){console.error("头像加载失败",n)},updateSubmitState:function(){var n=(this.newComment||"").trim().length>0,t=Array.isArray(this.commentImages)&&this.commentImages.length>0,r=!n&&!t||this.isSubmittingComment;this.isSubmitDisabled!==r&&this.setData({isSubmitDisabled:r})},onCommentInput:function(n){var t=this;this.setData({newComment:n.detail.value},(function(){t.updateSubmitState()}))},chooseImages:function(){var n=this,t=this.commentImages?this.commentImages.length:0,r=this.maxCommentImages,e=r-t;e<=0?uni.showToast({title:"最多选择3张图片",icon:"none"}):(this.isInputExpanded||this.expandInput(),uni.chooseImage({count:e,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(t){var r=t.tempFiles||(t.tempFilePaths||[]).map((function(n){return{tempFilePath:n,size:0}})),e=r.map((function(t){return n.prepareCommentImage(t)}));Promise.all(e).then((function(t){var r=t.filter((function(n){return!!n}));if(0!==r.length){var e=(n.commentImages||[]).concat(r);n.setData({commentImages:e.slice(0,n.maxCommentImages)},(function(){n.updateSubmitState(),n.setData({isInputExpanded:!0,isFocus:!1})}))}})).catch((function(n){console.error("评论图片处理失败:",n),uni.showToast({title:"图片处理失败",icon:"none"})}))},fail:function(n){n&&n.errMsg&&-1===n.errMsg.indexOf("cancel")&&(console.error("选择图片失败:",n),uni.showToast({title:"无法选择图片",icon:"none"}))}}))},chooseCommentImages:function(){this.chooseImages()},prepareCommentImage:function(n){var t=this;return new Promise((function(r){var e=n.tempFilePath||n.path||(Array.isArray(n.tempFilePaths)?n.tempFilePaths[0]:"");if(e){var o=n.size||0,a=o>204800,i={id:"comment_"+Date.now()+"_"+Math.floor(1e5*Math.random()),originalPath:e,previewUrl:e,compressedPath:e,size:o,needCompression:a};a?t.compressCommentImage(i).then((function(n){r(n)})).catch((function(n){console.warn("评论图片压缩异常:",n),i.compressedPath=i.originalPath,i.previewUrl=i.originalPath,i.needCompression=!1,r(i)})):r(i)}else r(null)}))},compressCommentImage:function(n){return new Promise((function(t){(function r(e){uni.compressImage({src:n.originalPath,quality:e,success:function(o){uni.getFileInfo({filePath:o.tempFilePath,success:function(a){var i=a.size;console.log("压缩质量".concat(e,"%，文件大小: ").concat((i/1024).toFixed(2),"KB")),i>204800&&e>30?(console.log("文件大小".concat((i/1024).toFixed(2),"KB超过200KB，继续压缩...")),r(e-10)):(n.compressedPath=o.tempFilePath,n.previewUrl=o.tempFilePath,n.compressedSize=i,console.log("最终压缩质量".concat(e,"%，文件大小: ").concat((i/1024).toFixed(2),"KB")),t(n))},fail:function(){n.compressedPath=o.tempFilePath,n.previewUrl=o.tempFilePath,t(n)}})},fail:function(o){console.warn("压缩质量".concat(e,"%失败:"),o),e>30?r(e-10):(n.compressedPath=n.originalPath,n.previewUrl=n.originalPath,n.needCompression=!1,t(n))}})})(60)}))},removeCommentImage:function(n){var t=this,r=n.currentTarget.dataset.index;if(void 0!==r){var e=(this.commentImages||[]).slice();e.splice(r,1),this.setData({commentImages:e},(function(){t.updateSubmitState()}))}},previewSelectedCommentImage:function(n){var t=n.currentTarget.dataset.index||0,r=this.commentImages||[];if(r.length){var e=r.map((function(n){return n.previewUrl})).filter(Boolean);if(e.length){var o=e[t]||e[0];return b({current:o,urls:e},{fallbackToast:!1})}}},uploadCommentImages:function(){var n=this,t=this.commentImages||[];if(!t.length)return Promise.resolve([]);var r=this.getCurrentUserId()||"guest",e=Date.now();return Promise.all(t.map((function(t,o){var a=(r||"guest")+"_"+e+"_"+o,i="comment_images/"+a+"_compressed.jpg";return n.uploadFile(i,t.compressedPath||t.previewUrl||t.originalPath).then((function(r){if(t.needCompression){var e="comment_images/"+a+"_original.jpg";return n.uploadFile(e,t.originalPath).then((function(n){return{compressedUrl:r.fileID,originalUrl:n.fileID}}))}return{compressedUrl:r.fileID,originalUrl:r.fileID}}))})))},previewCommentImageFromList:function(n){var t=Number(n.currentTarget.dataset.commentIndex),r=n.currentTarget.dataset.replyIndex,e="undefined"===typeof r?-1:Number(r),o=Number(n.currentTarget.dataset.imageIndex)||0,a=n.currentTarget.dataset.isReply,i=!0===a||"true"===a,s=[];if(!Number.isNaN(t)&&t>=0){var l=this.comments[t];if(l)if(i&&Array.isArray(l.replies)&&e>=0){var c=l.replies[e];c&&(Array.isArray(c.originalImageUrls)&&c.originalImageUrls.length>0?s=c.originalImageUrls:Array.isArray(c.imageUrls)&&(s=c.imageUrls))}else Array.isArray(l.originalImageUrls)&&l.originalImageUrls.length>0?s=l.originalImageUrls:Array.isArray(l.imageUrls)&&(s=l.imageUrls)}if(s&&s.length){var d=s.filter(Boolean);if(d.length){var u=d[o]||d[0];return b({current:u,urls:d},{fallbackToast:!1})}}},onSubmitComment:function(){var n=(0,s.default)((0,a.default)().mark((function n(){var t,r,e,o,i,s,l,c,d,u,f,m,p;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!this.isSubmitDisabled&&!this.isSubmittingComment){n.next=2;break}return n.abrupt("return");case 2:if(t=(this.newComment||"").trim(),r=t.length>0,e=Array.isArray(this.commentImages)&&this.commentImages.length>0,r||e){n.next=8;break}return uni.showToast({title:"请输入内容或添加图片",icon:"none"}),n.abrupt("return");case 8:if(o=this.post&&this.post._id?this.post._id:"",o){n.next=12;break}return uni.showToast({title:"帖子信息缺失",icon:"none"}),n.abrupt("return");case 12:return i=this.replyToComment,s=this.replyToAuthor,this.setData({isSubmittingComment:!0}),this.updateSubmitState(),uni.showLoading({title:"提交中..."}),n.prev=17,n.next=20,this.uploadCommentImages();case 20:return l=n.sent,c=l.map((function(n){return n.compressedUrl})),d=l.map((function(n){return n.originalUrl})),n.next=25,this.callCloudFunction("addComment",{postId:o,content:t,parentId:i,replyToAuthorName:s,imageUrls:c,originalImageUrls:d},{requireAuth:!0});case 25:u=n.sent,uni.hideLoading(),u.result&&u.result.success?(uni.showToast({title:"评论成功"}),f=this.commentCount+1,this.setData({newComment:"",commentImages:[],commentCount:f}),this.updateSubmitState(),this.collapseInput(),this.getComments(o),m=getCurrentPages(),m.length>1&&(p=m[m.length-2],"pages/index/index"!==p.route&&"pages/profile/profile"!==p.route||"function"!==typeof p.updatePostCommentCount||p.updatePostCommentCount(o,f))):uni.showToast({title:u.result&&u.result.message||"评论失败",icon:"none"}),n.next=37;break;case 30:n.prev=30,n.t0=n["catch"](17),console.log("CatchClause",n.t0),console.log("CatchClause",n.t0),uni.hideLoading(),console.error("Failed to add comment with media:",n.t0),uni.showToast({title:"评论失败",icon:"none"});case 37:return n.prev=37,this.setData({isSubmittingComment:!1}),this.updateSubmitState(),n.finish(37);case 41:case"end":return n.stop()}}),n,this,[[17,30,37,41]])})));return function(){return n.apply(this,arguments)}}(),showReplyInput:function(n){console.log("--- showReplyInput function triggered ---"),console.log("收到的 data- attributes:",n.currentTarget.dataset);var t=n.currentTarget.dataset.commentId,r=n.currentTarget.dataset.authorName;this.setData({replyToComment:t,replyToAuthor:r}),console.log("设置后的回复状态:",{replyToComment:this.replyToComment,replyToAuthor:this.replyToAuthor}),this.expandInput()},cancelReply:function(){this.setData({replyToComment:null,replyToAuthor:""}),console.log("回复状态已被取消")},onDeleteComment:function(n){var t=this,r=n.currentTarget.dataset,e=r.commentId,a=r.parentId;e&&uni.showModal({title:"删除评论",content:"确定要删除这条评论吗？",confirmColor:"#ff4d4f",success:function(n){n.confirm&&(uni.showLoading({title:"正在删除",mask:!0}),t.callCloudFunction("deleteComment",{commentId:e},{requireAuth:!0}).then((function(n){if(n.result&&n.result.success){var r,i=Math.max(1,n.result.deletedCount||1);if(a){r=t.comments.map((function(n){return(0,o.default)((0,o.default)({},n),{},{replies:n.replies?n.replies.slice():[]})}));var s=r.findIndex((function(n){return n._id===a}));-1!==s&&(r[s].replies=r[s].replies.filter((function(n){return n._id!==e})))}else r=t.comments.filter((function(n){return n._id!==e}));var l=Math.max(0,t.commentCount-i);t.setData({comments:r,commentCount:l});var c=getCurrentPages();if(c.length>1){var d=c[c.length-2];"function"===typeof d.updatePostCommentCount&&d.updatePostCommentCount(t.post&&t.post._id?t.post._id:"",l)}uni.showToast({title:"已删除",icon:"success"})}else uni.showToast({title:n.result&&n.result.message||"删除失败",icon:"none"})})).catch((function(n){console.error("Failed to delete comment",n),uni.showToast({title:"删除失败",icon:"none"})})).finally((function(){uni.hideLoading()})))}})},toggleLikeComment:function(n){var t=this,r=n.currentTarget.dataset.commentId,e=this.post&&this.post._id?this.post._id:"",o=this.comments,a=this.findComment(o,r),i=a.comment;a.isReply;if(i){var s=!i.liked,l=i.likes||0;i.liked=s,i.likes=l+(s?1:-1),i.likeIcon=v.getLikeIcon(i.likes,i.liked),this.setData({comments:o}),this.callCloudFunction("likeComment",{commentId:r,postId:e},{requireAuth:!0}).then((function(n){n.result&&n.result.success?i.likes!==n.result.likes&&t.updateCommentLikeStatus(r,s,n.result.likes):(t.updateCommentLikeStatus(r,!s,l),uni.showToast({title:"操作失败",icon:"none"}))})).catch((function(n){t.updateCommentLikeStatus(r,!s,l),console.error("Failed to like comment",n),uni.showToast({title:"网络错误",icon:"none"})}))}},updateCommentLikeStatus:function(n,t,r){var e=this.comments,o=this.findComment(e,n),a=o.comment;o.isReply;a&&(a.liked=t,a.likes=r,a.likeIcon=v.getLikeIcon(a.likes,a.liked),this.setData({comments:e}))},findComment:function(n,t){for(var r=0;r<n.length;r++){if(n[r]._id===t)return{comment:n[r],isReply:!1};if(n[r].replies)for(var e=0;e<n[r].replies.length;e++)if(n[r].replies[e]._id===t)return{comment:n[r].replies[e],isReply:!0}}return{comment:null,isReply:!1}},toggleShowAllReplies:function(n){var t=n.currentTarget.dataset.commentId,r=this.comments,e=r.find((function(n){return n._id===t}));e&&(e.showAllReplies=!e.showAllReplies,this.setData({comments:r}))},formatTime:function(n){return k(n)},prepareFollowState:function(n){var t=this.getCurrentUserId(),r=n===t;if(console.log("【关注状态】prepareFollowState调用:",{authorOpenid:n,currentUserId:t,isSameUser:r}),this.setData({isOwnPost:r}),!n||!t||r)return console.log("【关注状态】不显示关注按钮 - 自己或无效用户"),void this.setData({showFollowButton:!1,isFollowing:!1,isFollowedByAuthor:!1,isMutualFollow:!1});console.log("【关注状态】显示关注按钮"),this.setData({showFollowButton:!0,isFollowing:!1,isFollowedByAuthor:!1,isMutualFollow:!1}),this.fetchFollowStatusWithCache(n)},fetchFollowStatusWithCache:function(n){var t=this;if(n){var r=this.getCurrentUserId();r&&C.getFollowStatus(r,n).then((function(n){n&&t.setData({isFollowing:n.isFollowing,isFollowedByAuthor:n.isFollowedByAuthor,isMutualFollow:n.isMutualFollow})}))}},fetchFollowStatus:function(n){var t=this;n&&this.callCloudFunction("follow",{action:"checkFollow",targetOpenid:n},{requireAuth:!0}).then((function(n){n.result&&n.result.success?t.setData({isFollowing:!!n.result.isFollowing,isFollowedByAuthor:!!n.result.isFollower,isMutualFollow:!!n.result.isMutual}):console.warn("检查关注状态失败",n.result)})).catch((function(n){console.error("检查关注状态调用失败:",n)}))},onFollowTap:function(){var n=this;if(!this.followPending&&this.post){var t=this.post._openid;if(t){var r=this.getCurrentUserId();r?(this.setData({followPending:!0}),C.toggleFollowStatus(r,t).then((function(t){t?(n.setData({isFollowing:t.isFollowing,isFollowedByAuthor:t.isFollowedByAuthor,isMutualFollow:t.isMutualFollow}),uni.showToast({title:t.isFollowing?"关注成功":"已取消关注",icon:"success"})):uni.showToast({title:"操作失败",icon:"none"})})).catch((function(n){console.error("切换关注状态失败:",n),uni.showToast({title:"网络错误",icon:"none"})})).finally((function(){n.setData({followPending:!1})}))):uni.showToast({title:"请先登录",icon:"none"})}}},getCurrentUserId:function(){return this.openid||uni.getStorageSync("openid")||uni.getStorageSync("userOpenId")},retryLoad:function(){this.currentPostId&&(this.setData({isLoading:!0,post:null}),this.loadPostDetail(this.currentPostId))},navigateToUserProfile:function(n){var t=n.currentTarget.dataset.userId;if(t){var r=this.openid;t===r?(console.log("【帖子详情】点击的是自己头像，切换到我的页面"),uni.switchTab({url:"/pages/profile/profile"})):(console.log("【帖子详情】点击的是他人头像，跳转到用户主页"),uni.navigateTo({url:"/pages/user-profile/user-profile?userId=".concat(t)}))}},preventBubble:function(){},expandInput:function(){this.setData({isInputExpanded:!0,isFocus:!0})},onInputFocus:function(n){console.log("键盘弹起，高度为:",n.detail.height),this.setData({keyboardHeight:n.detail.height})},onInputBlur:function(){var n=this;setTimeout((function(){n.setData({isFocus:!1,keyboardHeight:0})}),100)},collapseInput:function(){this.setData({isInputExpanded:!1,isFocus:!1,keyboardHeight:0,replyToComment:null,replyToAuthor:""})},recordViewBehavior:function(){if(this.currentPostId&&this.viewStartTime){var n=Math.floor((Date.now()-this.viewStartTime)/1e3);n<3||this.callCloudFunction("recordView",{postId:this.currentPostId,viewDuration:n}).then((function(n){console.log("浏览记录已保存",n)})).catch((function(n){console.error("浏览记录保存失败:",n)}))}},onTagClick:function(n){var t=n.currentTarget.dataset.tag;console.log("点击标签:",t),uni.navigateTo({url:"/pages/tag-filter/tag-filter?tag=".concat(encodeURIComponent(t)),success:function(){console.log("跳转到标签筛选页面成功")},fail:function(n){console.error("跳转到标签筛选页面失败",n),uni.showToast({title:"跳转失败",icon:"none"})}})},goBack:function(){var n=getCurrentPages();console.log("当前页面栈长度:",n.length),n.length>1?uni.navigateBack({delta:1,fail:function(){console.log("navigateBack失败，尝试switchTab"),uni.switchTab({url:"/pages/index/index"})}}):(console.log("没有上一页，跳转到首页"),uni.switchTab({url:"/pages/index/index"}))},uploadFile:function(n,t){var e=this;return console.log("🔍 [帖子详情页] 上传文件: ".concat(n),t),new Promise((function(o,a){var i=r("fd09"),s=i.getCurrentPlatform,l=i.getCloudFunctionMethod,c=s(),d=l();console.log("🔍 [帖子详情页] 运行环境检测 - 平台: ".concat(c,", 方法: ").concat(d)),"tcb"===d?e.$tcb&&e.$tcb.uploadFile?(console.log("🔍 [帖子详情页] TCB环境上传文件: ".concat(n)),e.$tcb.uploadFile({cloudPath:n,filePath:t}).then(o).catch(a)):(console.error("❌ [帖子详情页] TCB实例不可用"),a(new Error("TCB实例不可用"))):"wx-cloud"===d?wx.cloud&&wx.cloud.uploadFile?(console.log("🔍 [帖子详情页] 小程序环境上传文件: ".concat(n)),wx.cloud.uploadFile({cloudPath:n,filePath:t,success:function(t){console.log("✅ [帖子详情页] 文件上传成功: ".concat(n),t),o(t)},fail:function(t){console.error("❌ [帖子详情页] 文件上传失败: ".concat(n),t),a(t)}})):(console.error("❌ [帖子详情页] 微信云开发不可用"),a(new Error("微信云开发不可用"))):(console.error("❌ [帖子详情页] 不支持的文件上传方式: ".concat(d)),a(new Error("不支持的文件上传方式: ".concat(d))))}))}}};t.default=F,t.default.components=Object.assign({"cloud-tip-modal":m.default,"folder-selector":p.default},t.default.components||{})},"560a":function(n,t,r){"use strict";var e=r("b695"),o=r.n(e);o.a},6918:function(n,t,r){"use strict";r.r(t);var e=r("437fa"),o=r.n(e);for(var a in e)["default"].indexOf(a)<0&&function(n){r.d(t,n,(function(){return e[n]}))}(a);t["default"]=o.a},"6ce6":function(n,t,r){"use strict";var e=r("be14"),o=r.n(e);o.a},7386:function(n,t,r){"use strict";r("6a54");var e=r("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.hydrateTempUrls=function(){return l.apply(this,arguments)},t.warmTempUrlsFromPosts=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=new Set;n.forEach((function(n){return s(n).forEach((function(n){return t.add(n)}))})),t.size>0&&i.default.warm(Array.from(t))};var o=e(r("2634")),a=e(r("2fdc"));r("9db6"),r("aa9c"),r("bf0f"),r("2797"),r("f3f7"),r("18f7"),r("de6c"),r("08eb"),r("fd3c");var i=e(r("c605"));function s(n){var t=[],r=function(n){"string"===typeof n&&n.startsWith("cloud://")&&t.push(n)};return r(n.imageUrl),r(n.originalImageUrl),r(n.authorAvatar),r(n.poemBgImage),Array.isArray(n.imageUrls)&&n.imageUrls.forEach(r),Array.isArray(n.originalImageUrls)&&n.originalImageUrls.forEach(r),t}function l(){return l=(0,a.default)((0,o.default)().mark((function n(){var t,r,e,a,l=arguments;return(0,o.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:[],Array.isArray(t)&&0!==t.length){n.next=3;break}return n.abrupt("return",t);case 3:if(r=new Set,t.forEach((function(n){return s(n).forEach((function(n){return r.add(n)}))})),0!==r.size){n.next=7;break}return n.abrupt("return",t);case 7:return n.next=9,i.default.getTempUrls(Array.from(r));case 9:return e=n.sent,a=function(n){return"string"===typeof n&&e[n]?e[n]:n},t.forEach((function(n){n.imageUrl&&(n.imageUrl=a(n.imageUrl)),n.originalImageUrl&&(n.originalImageUrl=a(n.originalImageUrl)),n.authorAvatar&&(n.authorAvatar=a(n.authorAvatar)),n.poemBgImage&&(n.poemBgImage=a(n.poemBgImage)),Array.isArray(n.imageUrls)&&(n.imageUrls=n.imageUrls.map(a)),Array.isArray(n.originalImageUrls)&&(n.originalImageUrls=n.originalImageUrls.map(a))})),n.abrupt("return",t);case 13:case"end":return n.stop()}}),n)}))),l.apply(this,arguments)}},"74e3":function(n,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return e}));var e={folderSelector:r("84be").default,portfolioSelector:r("ee81").default},o=function(){var n=this,t=n.$createElement,r=n._self._c||t;return r("v-uni-view",[r("v-uni-view",{staticClass:"custom-back-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.goBack.apply(void 0,arguments)}}},[r("v-uni-image",{staticClass:"back-icon",attrs:{src:"/static/images/back_to_edit.png",mode:"aspectFit"}})],1),r("v-uni-view",{staticClass:"container"},[n.isLoading?[r("v-uni-view",{staticClass:"post-detail-skeleton"},[r("v-uni-view",{staticClass:"skeleton-wrapper"},[r("v-uni-view",{staticClass:"skeleton-header"},[r("v-uni-view",{staticClass:"skeleton-avatar skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-header-text"},[r("v-uni-view",{staticClass:"skeleton-line medium skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-line short skeleton-animate"})],1)],1),r("v-uni-view",{staticClass:"skeleton-line long skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-line medium skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-line short skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-image skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-line long skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-line medium skeleton-animate"})],1),r("v-uni-view",{staticClass:"skeleton-section-title skeleton-animate"}),r("v-uni-view",{staticClass:"comment-skeleton-list"},n._l(n.commentSkeletonCount,(function(n){return r("v-uni-view",{key:"post-skeleton-comment-"+n,staticClass:"comment-skeleton-item"},[r("v-uni-view",{staticClass:"skeleton-avatar skeleton-animate"}),r("v-uni-view",{staticClass:"comment-skeleton-body"},[r("v-uni-view",{staticClass:"skeleton-line medium skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-line short skeleton-animate"})],1)],1)})),1)],1)]:n.post&&n.post._id?[r("v-uni-view",{class:"post-detail-wrapper "+(n.post.isOriginal?"original-post":"")+(n.post.isPoem?" poem-post":"")},[r("v-uni-view",{staticClass:"author-info"},[r("v-uni-view",{staticClass:"author-basic"},[n.post.authorAvatar?r("v-uni-image",{staticClass:"author-avatar",attrs:{src:n.post.authorAvatar,mode:"aspectFill","data-user-id":n.post._openid},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onAvatarError.apply(void 0,arguments)},click:function(t){arguments[0]=t=n.$handleEvent(t),n.navigateToUserProfile.apply(void 0,arguments)}}}):n._e(),r("v-uni-text",{staticClass:"author-name"},[n._v(n._s(n.post.authorName))]),n.isMutualFollow?r("v-uni-view",{staticClass:"mutual-tag"},[n._v("互相关注")]):n.isFollowedByAuthor?r("v-uni-view",{staticClass:"followed-tag"},[n._v("TA关注了你")]):n._e()],1),n.showFollowButton?r("v-uni-button",{class:"follow-btn "+(n.isFollowing?"following":""),attrs:{loading:n.followPending,disabled:n.followPending},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.onFollowTap.apply(void 0,arguments)}}},[n._v(n._s(n.isFollowing?"已关注":"关注"))]):n._e()],1),r("v-uni-view",{staticClass:"post-title"},[n._v(n._s(n.post.title))]),n.post.isPoem&&n.post.author?r("v-uni-view",{staticClass:"poem-author"},[n._v(n._s(n.post.author))]):n._e(),n.post.isDiscussion&&n.post.sentenceGroups?r("v-uni-view",{staticClass:"discussion-content"},n._l(n.post.sentenceGroups,(function(t,e){return r("v-uni-view",{key:"discussion-group-"+e,staticClass:"discussion-sentence-group"},[r("v-uni-view",{staticClass:"discussion-sentence-card"},[r("v-uni-view",{staticClass:"discussion-sentence-content"},n._l(t.sentences,(function(t,e){return r("v-uni-text",{key:"discussion-sentence-"+e,staticClass:"discussion-sentence-line"},[n._v(n._s(t))])})),1)],1),t.comment?r("v-uni-view",{staticClass:"discussion-comment"},[n._v(n._s(t.comment))]):n._e()],1)})),1):n.post.content?r("v-uni-view",{staticClass:"post-content"},[n._v(n._s(n.post.content))]):n._e(),n.post.tags&&n.post.tags.length>0?r("v-uni-view",{staticClass:"post-tags"},n._l(n.post.tags,(function(t,e){return r("v-uni-text",{key:e,staticClass:"post-tag",attrs:{"data-tag":t},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.onTagClick.apply(void 0,arguments)}}},[n._v("#"+n._s(t))])})),1):n._e(),n.post.imageUrl||n.post.imageUrls&&n.post.imageUrls.length>0?r("v-uni-view",{staticClass:"image-container",attrs:{id:"detail-image-container"}},[n.post.imageUrls&&1===n.post.imageUrls.length?[r("v-uni-image",{style:"width: 100%; height: "+(n.post&&n.post._id&&n.imageClampHeights[n.post._id]?n.imageClampHeights[n.post._id]+"px":"auto")+"; object-fit: "+(n.post&&n.post._id&&n.imageClampHeights[n.post._id]?"cover":"contain")+"; background-color: #f0f0f0;",attrs:{id:"single-image-"+(n.post&&n.post._id?n.post._id:""),src:n.post.imageUrls[0],mode:n.post&&n.post._id&&n.imageClampHeights[n.post._id]?"aspectFill":"widthFix","data-postid":n.post&&n.post._id?n.post._id:"","data-type":"single","data-src":n.post.imageUrls[0],"data-original-image-urls":n.post.originalImageUrls||n.post.imageUrls,"lazy-load":!0},on:{load:function(t){arguments[0]=t=n.$handleEvent(t),n.onImageLoad.apply(void 0,arguments)},error:function(t){arguments[0]=t=n.$handleEvent(t),n.onImageError.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.handlePreview.apply(void 0,arguments)}}})]:n.post.imageUrls&&n.post.imageUrls.length>1?[r("v-uni-swiper",{staticClass:"image-swiper",style:"width: 100%; height: "+(n.swiperHeights[0]?n.swiperHeights[0]+"px":"220px")+";",attrs:{id:"swiper-"+(n.post&&n.post._id?n.post._id:""),"indicator-dots":!0,circular:!0}},[n._l(n.post.imageUrls,(function(t,e){return[r("v-uni-swiper-item",[r("v-uni-image",{staticStyle:{width:"100%",height:"100%","object-fit":"cover","background-color":"#f0f0f0"},attrs:{src:t,mode:"aspectFill","data-postid":n.post&&n.post._id?n.post._id:"","data-postindex":"0","data-imgindex":e,"data-type":"multi","data-src":t,"data-original-image-urls":n.post.originalImageUrls||n.post.imageUrls,"lazy-load":!0},on:{load:function(t){arguments[0]=t=n.$handleEvent(t),n.onImageLoad.apply(void 0,arguments)},error:function(t){arguments[0]=t=n.$handleEvent(t),n.onImageError.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.handlePreview.apply(void 0,arguments)}}})],1)]}))],2)]:n._e()],2):n._e(),r("v-uni-view",{staticClass:"post-meta"},[r("v-uni-text",{staticClass:"post-time"},[n._v(n._s(n.post.formattedCreateTime))])],1),r("v-uni-view",{staticClass:"vote-section",on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.preventBubble.apply(void 0,arguments)}}},[r("v-uni-view",{staticClass:"actions-left"}),r("v-uni-view",{staticClass:"button-group"},[r("v-uni-view",{staticClass:"like-icon-container",attrs:{"data-postid":n.post&&n.post._id?n.post._id:""},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.onVote.apply(void 0,arguments)}}},[r("v-uni-image",{staticClass:"like-icon",attrs:{src:n.post.likeIcon,mode:"aspectFit"}})],1),n.isOwnPost?r("v-uni-view",{staticClass:"portfolio-icon-container",on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.onAddToPortfolio.apply(void 0,arguments)}}},[r("v-uni-image",{staticClass:"portfolio-icon",attrs:{src:"/static/images/portfolio.png",mode:"aspectFit"}})],1):r("v-uni-view",{class:"favorite-icon-container "+(n.isFavorited?"favorited":""),on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.onFavorite.apply(void 0,arguments)}}},[r("v-uni-image",{staticClass:"favorite-icon",attrs:{src:"/static/images/my_favorites.png",mode:"aspectFit"}})],1),n.post.isPoem?r("v-uni-view",{staticClass:"discussion-icon-container",on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.onCreateDiscussion.apply(void 0,arguments)}}},[r("v-uni-image",{staticClass:"discussion-icon",attrs:{src:"/static/images/write_poetry.png",mode:"aspectFit"}})],1):n._e(),r("v-uni-view",{staticClass:"comment-icon-container",on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.expandInput.apply(void 0,arguments)}}},[r("v-uni-image",{staticClass:"comment-icon",attrs:{src:"/static/images/write_comment.png",mode:"aspectFit"}})],1)],1)],1)],1),r("v-uni-view",{staticClass:"comment-section"},[r("v-uni-view",{staticClass:"section-title"},[n._v("共"+n._s(n.isCommentLoading?"--":n.commentCount)+" 条评论")]),n.isCommentLoading?r("v-uni-view",{staticClass:"comment-skeleton-list"},n._l(n.commentSkeletonCount,(function(n){return r("v-uni-view",{key:"detail-comment-skeleton-"+n,staticClass:"comment-skeleton-item"},[r("v-uni-view",{staticClass:"skeleton-avatar skeleton-animate"}),r("v-uni-view",{staticClass:"comment-skeleton-body"},[r("v-uni-view",{staticClass:"skeleton-line medium skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-line short skeleton-animate"})],1)],1)})),1):r("v-uni-view",{staticClass:"comment-list"},[n.comments.length>0?n._l(n.comments,(function(t,e){return r("v-uni-view",{key:e,staticClass:"comment-item"},[r("v-uni-image",{staticClass:"comment-avatar",attrs:{src:t.authorAvatar,mode:"aspectFill","data-user-id":t._openid},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onAvatarError.apply(void 0,arguments)},click:function(t){arguments[0]=t=n.$handleEvent(t),n.navigateToUserProfile.apply(void 0,arguments)}}}),r("v-uni-view",{staticClass:"comment-main"},[r("v-uni-view",{staticClass:"comment-author"},[n._v(n._s(t.authorName))]),r("v-uni-view",{staticClass:"comment-content"},[n._v(n._s(t.content))]),t.imageUrls&&t.imageUrls.length?r("v-uni-view",{staticClass:"comment-image-grid"},n._l(t.imageUrls,(function(t,o){return r("v-uni-image",{key:o,staticClass:"comment-image",attrs:{src:t,mode:"aspectFill","data-comment-index":e,"data-image-index":o,"data-is-reply":!1},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.previewCommentImageFromList.apply(void 0,arguments)}}})})),1):n._e(),r("v-uni-view",{staticClass:"comment-footer"},[r("v-uni-view",{staticClass:"comment-time"},[n._v(n._s(t.formattedCreateTime))]),r("v-uni-view",{staticClass:"comment-actions"},[r("v-uni-view",{staticClass:"like-section",attrs:{"data-comment-id":t._id,"data-liked":t.liked},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.toggleLikeComment.apply(void 0,arguments)}}},[r("v-uni-image",{staticClass:"like-icon",attrs:{src:t.likeIcon}}),r("v-uni-text",{staticClass:"like-count"},[n._v(n._s(t.likes||0))])],1),t.canDelete?r("v-uni-view",{staticClass:"delete-btn",attrs:{"data-comment-id":t._id},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.onDeleteComment.apply(void 0,arguments)}}},[r("v-uni-text",{staticClass:"delete-text"},[n._v("删除")])],1):n._e(),r("v-uni-view",{staticClass:"reply-btn",attrs:{"data-comment-id":t._id,"data-author-name":t.authorName},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.showReplyInput.apply(void 0,arguments)}}},[r("v-uni-text",{staticClass:"reply-text"},[n._v("回复")])],1)],1)],1),t.replies&&t.replies.length>0?r("v-uni-view",{staticClass:"replies-container"},[n._l(t.replies,(function(o,a){return a<(t.showAllReplies?t.replies.length:3)?r("v-uni-view",{key:a,staticClass:"reply-item"},[r("v-uni-image",{staticClass:"reply-avatar",attrs:{src:o.authorAvatar,mode:"aspectFill","data-user-id":o._openid},on:{error:function(t){arguments[0]=t=n.$handleEvent(t),n.onAvatarError.apply(void 0,arguments)},click:function(t){arguments[0]=t=n.$handleEvent(t),n.navigateToUserProfile.apply(void 0,arguments)}}}),r("v-uni-view",{staticClass:"reply-main"},[r("v-uni-view",{staticClass:"reply-author"},[n._v(n._s(o.authorName))]),r("v-uni-view",{staticClass:"reply-content"},[r("v-uni-text",{staticClass:"reply-to"},[n._v("回复@"+n._s(t.authorName)+"：")]),r("v-uni-text",[n._v(n._s(o.content))])],1),o.imageUrls&&o.imageUrls.length?r("v-uni-view",{staticClass:"comment-image-grid reply-image-grid"},n._l(o.imageUrls,(function(t,o){return r("v-uni-image",{key:o,staticClass:"comment-image",attrs:{src:t,mode:"aspectFill","data-comment-index":e,"data-reply-index":a,"data-image-index":o,"data-is-reply":!0},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.previewCommentImageFromList.apply(void 0,arguments)}}})})),1):n._e(),r("v-uni-view",{staticClass:"reply-footer"},[r("v-uni-view",{staticClass:"reply-time"},[n._v(n._s(o.formattedCreateTime))]),r("v-uni-view",{staticClass:"reply-actions"},[r("v-uni-view",{staticClass:"like-section",attrs:{"data-comment-id":o._id,"data-liked":o.liked},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.toggleLikeComment.apply(void 0,arguments)}}},[r("v-uni-image",{staticClass:"like-icon",attrs:{src:o.likeIcon}}),r("v-uni-text",{staticClass:"like-count"},[n._v(n._s(o.likes||0))])],1),o.canDelete?r("v-uni-view",{staticClass:"delete-btn",attrs:{"data-comment-id":o._id,"data-parent-id":t._id},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.onDeleteComment.apply(void 0,arguments)}}},[r("v-uni-text",{staticClass:"delete-text"},[n._v("删除")])],1):n._e(),r("v-uni-view",{staticClass:"reply-btn",attrs:{"data-comment-id":t._id,"data-author-name":o.authorName},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.showReplyInput.apply(void 0,arguments)}}},[r("v-uni-text",{staticClass:"reply-text"},[n._v("回复")])],1)],1)],1)],1)],1):n._e()})),t.replies.length>3&&!t.showAllReplies?r("v-uni-view",{staticClass:"show-more-replies",attrs:{"data-comment-id":t._id},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.toggleShowAllReplies.apply(void 0,arguments)}}},[r("v-uni-text",{staticClass:"show-more-text"},[n._v("显示"+n._s(t.replies.length-3)+"条回复")])],1):n._e(),t.replies.length>3&&t.showAllReplies?r("v-uni-view",{staticClass:"show-more-replies",attrs:{"data-comment-id":t._id},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.toggleShowAllReplies.apply(void 0,arguments)}}},[r("v-uni-text",{staticClass:"show-more-text"},[n._v("收起回复")])],1):n._e()],2):n._e()],1)],1)})):[r("v-uni-view",{staticClass:"no-comment-tip"},[r("v-uni-view",{staticClass:"empty-icon"},[n._v("💬")]),r("v-uni-view",{staticClass:"empty-text"},[n._v("暂无评论，快来抢沙发吧！")])],1)]],2)],1)]:[r("v-uni-view",{staticClass:"error-container"},[r("v-uni-view",{staticClass:"error-icon"},[n._v("❌")]),r("v-uni-view",{staticClass:"error-text"},[n._v("帖子加载失败或不存在")])],1)]],2),r("v-uni-view",{class:"input-overlay "+(n.isInputExpanded?"show":""),on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.collapseInput.apply(void 0,arguments)}}}),n.isInputExpanded?r("v-uni-view",{staticClass:"comment-input-area",style:"bottom: "+n.keyboardHeight+"px;"},[n.isInputExpanded?r("v-uni-view",{staticClass:"expanded-container"},[n.replyToComment?r("v-uni-view",{staticClass:"reply-prompt"},[r("v-uni-text",{staticClass:"reply-prompt-text"},[n._v("回复 "+n._s(n.replyToAuthor)+"：")]),r("v-uni-view",{staticClass:"cancel-reply",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.cancelReply.apply(void 0,arguments)}}},[r("v-uni-text",{staticClass:"cancel-text"},[n._v("取消")])],1)],1):n._e(),r("v-uni-textarea",{staticClass:"expanded-textarea",attrs:{placeholder:"留下你的精彩评论...",value:n.newComment,focus:n.isFocus,"auto-height":!0,maxlength:"500","show-confirm-bar":!1,"adjust-position":!1},on:{input:function(t){arguments[0]=t=n.$handleEvent(t),n.onCommentInput.apply(void 0,arguments)},focus:function(t){arguments[0]=t=n.$handleEvent(t),n.onInputFocus.apply(void 0,arguments)},blur:function(t){arguments[0]=t=n.$handleEvent(t),n.onInputBlur.apply(void 0,arguments)}}}),n.commentImages.length?r("v-uni-view",{staticClass:"selected-comment-images"},n._l(n.commentImages,(function(t,e){return r("v-uni-view",{key:e,staticClass:"selected-image-item",attrs:{"data-index":e}},[r("v-uni-image",{staticClass:"selected-image-thumb",attrs:{src:t.previewUrl,mode:"aspectFill","data-index":e},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.previewSelectedCommentImage.apply(void 0,arguments)}}}),r("v-uni-view",{staticClass:"remove-image-btn",attrs:{"data-index":e},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.removeCommentImage.apply(void 0,arguments)}}},[n._v("✕")])],1)})),1):n._e(),r("v-uni-view",{staticClass:"expanded-actions"},[r("v-uni-view",{staticClass:"action-icons"},[r("v-uni-view",{staticClass:"action-icon",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.chooseImages.apply(void 0,arguments)}}},[r("v-uni-image",{staticClass:"action-icon-image",attrs:{src:"/static/images/add_image.png",mode:"aspectFit"}})],1)],1),r("v-uni-button",{staticClass:"submit-button",attrs:{disabled:n.isSubmitDisabled},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.onSubmitComment.apply(void 0,arguments)}}},[n._v("发送")])],1)],1):n._e()],1):n._e(),r("cloud-tip-modal",{attrs:{showUploadTip:n.showUploadTip}}),r("folder-selector",{attrs:{show:n.showFavoriteModal,"post-id":n.post&&n.post._id?n.post._id:""},on:{hide:function(t){arguments[0]=t=n.$handleEvent(t),n.hideFavoriteModal.apply(void 0,arguments)},favoriteSuccess:function(t){arguments[0]=t=n.$handleEvent(t),n.onFavoriteSuccess.apply(void 0,arguments)}}}),r("portfolio-selector",{attrs:{show:n.showPortfolioModal,"post-id":n.post&&n.post._id?n.post._id:""},on:{hide:function(t){arguments[0]=t=n.$handleEvent(t),n.hidePortfolioModal.apply(void 0,arguments)},portfolioSuccess:function(t){arguments[0]=t=n.$handleEvent(t),n.onPortfolioSuccess.apply(void 0,arguments)}}})],1)},a=[]},"84be":function(n,t,r){"use strict";r.r(t);var e=r("b348"),o=r("daaa");for(var a in o)["default"].indexOf(a)<0&&function(n){r.d(t,n,(function(){return o[n]}))}(a);r("9820");var i=r("828b"),s=Object(i["a"])(o["default"],e["b"],e["c"],!1,null,"3a05c372",null,!1,e["a"],void 0);t["default"]=s.exports},9820:function(n,t,r){"use strict";var e=r("3255"),o=r.n(e);o.a},"9d3a":function(n,t,r){"use strict";r("6a54");var e=r("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r("bf0f"),r("0c26");var o=e(r("39d8")),a=r("11ca"),i=a.cloudCall,s={data:function(){return{folders:[],isLoading:!0,selectedFolderId:"",showCreateModal:!1,newFolderName:"",showClone:!1}},props:{show:{type:Boolean,default:!1},postId:{type:String,default:""}},watch:(0,o.default)({show:function(n){n&&this.loadFolders()}},"show",{handler:function(n,t){this.showClone=n},immediate:!0}),methods:{callCloudFunction:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(n,t,Object.assign({pageTag:"folder-selector",context:this,requireAuth:!0},r))},loadFolders:function(){var n=this;console.log("开始加载收藏夹列表..."),this.setData({isLoading:!0});var t=this.$requireOpenid&&this.$requireOpenid();t?this.callCloudFunction("getMyProfileData",{action:"getFavoriteFolders",openid:t}).then((function(t){if(console.log("folder-selector获取收藏夹:",t),t.result&&t.result.success){var r=t.result.folders||[];console.log("获取到收藏夹数量:",r.length);var e=n.selectedFolderId;e&&!r.some((function(n){return n._id===e}))&&(console.log("清空失效的选中状态"),n.setData({selectedFolderId:""})),n.setData({folders:r,isLoading:!1})}else{var o;uni.showToast({title:(null===(o=t.result)||void 0===o?void 0:o.message)||"加载失败",icon:"none"}),n.setData({isLoading:!1,folders:[],selectedFolderId:""})}})).catch((function(t){console.error("获取收藏夹失败:",t),uni.showToast({title:"网络错误",icon:"none"}),n.setData({isLoading:!1,folders:[],selectedFolderId:""})})):this.setData({isLoading:!1,folders:[],selectedFolderId:""})},selectFolder:function(n){var t=n.currentTarget.dataset.folderId;this.setData({selectedFolderId:t})},confirmFavorite:function(){var n=this,t=this.selectedFolderId,e=this.postId;if(console.log("确认收藏，postId:",e,"folderId:",t),t){if(!e)return console.error("postId 为空，无法收藏"),void uni.showToast({title:"参数错误：帖子ID为空",icon:"none"});var o=this.$requireOpenid&&this.$requireOpenid();o&&(uni.showLoading({title:"收藏中..."}),this.callCloudFunction("getMyProfileData",{action:"addToFavorite",postId:e,folderId:t,openid:o}).then((function(t){if(uni.hideLoading(),console.log("确认收藏返回结果:",t),t&&t.result)if(t.result.success){uni.showToast({title:"收藏成功"}),console.log("收藏成功，开始关闭弹窗"),n.setData({selectedFolderId:""}),setTimeout((function(){n.hideModal()}),1500),n.$emit("favoriteSuccess");try{var o=getApp(),a=o&&o.globalData&&o.globalData.openid,i=r("80fa"),s=i.emitFavoriteChanged;s({userId:a,postId:e,favored:!0})}catch(l){}}else console.error("收藏业务失败:",t.result),uni.showToast({title:t.result.message||"收藏失败",icon:"none"});else console.error("收藏返回格式异常:",t),uni.showToast({title:"收藏失败：返回格式错误",icon:"none"})})).catch((function(n){uni.hideLoading(),console.error("收藏云函数调用失败:",n),uni.showToast({title:"网络错误："+(n.errMsg||"未知错误"),icon:"none"})})))}else uni.showToast({title:"请选择收藏夹",icon:"none"})},createFolder:function(){this.setData({showCreateModal:!0,newFolderName:""})},hideCreateModal:function(){this.setData({showCreateModal:!1,newFolderName:""})},onFolderNameInput:function(n){var t=n.detail.value;this.setData({newFolderName:t})},createNewFolder:function(){var n=this,t=this.newFolderName.trim();if(t){this.setData({newFolderName:t}),console.log("组件开始创建收藏夹，名称:",t);var r=this.$requireOpenid&&this.$requireOpenid();r&&(uni.showLoading({title:"创建中..."}),this.callCloudFunction("getMyProfileData",{action:"createFavoriteFolder",folderName:t,openid:r}).then((function(t){uni.hideLoading(),console.log("组件创建收藏夹返回结果:",t),t&&t.result?t.result.success?(uni.showToast({title:"创建成功",duration:2e3}),n.setData({showCreateModal:!1}),setTimeout((function(){n.loadFolders()}),300)):(console.error("组件创建收藏夹业务失败:",t.result),uni.showToast({title:t.result.message||"创建失败",icon:"none",duration:3e3})):(console.error("组件创建收藏夹返回格式异常:",t),uni.showToast({title:"创建失败：返回格式错误",icon:"none",duration:3e3}))})).catch((function(n){uni.hideLoading(),console.error("组件创建收藏夹云函数调用失败:",n),uni.showToast({title:"创建失败: "+(n.errMsg||"网络错误"),icon:"none",duration:3e3})})))}else uni.showToast({title:"请输入收藏夹名称",icon:"none"})},hideModal:function(){console.log("=== 点击关闭按钮，开始隐藏弹窗 ==="),console.log("当前状态：",{show:this.show,showCreateModal:this.showCreateModal,selectedFolderId:this.selectedFolderId}),this.setData({selectedFolderId:"",showClone:!1,showCreateModal:!1,newFolderName:""}),console.log("=== 弹窗已隐藏，状态已重置 ==="),this.$emit("hide")},trueFun:function(){console.log("占位：函数 true 未声明")}},created:function(){}};t.default=s},"9f16":function(n,t,r){var e=r("c86c");t=e(!1),t.push([n.i,"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* components/portfolio-selector/portfolio-selector.wxss */.modal-overlay[data-v-747a115c]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[data-v-747a115c]{background:#fff;border-radius:%?16?%;margin:%?40?%;width:calc(100% - %?80?%);max-width:%?600?%;max-height:80vh;display:flex;flex-direction:column}.modal-header[data-v-747a115c]{display:flex;align-items:center;justify-content:space-between;padding:%?30?% %?40?%;border-bottom:%?1?% solid #f0f0f0}.modal-title[data-v-747a115c]{font-size:%?36?%;font-weight:500;color:#333}.header-actions[data-v-747a115c]{display:flex;align-items:center;gap:%?20?%}.refresh-btn[data-v-747a115c]{font-size:%?36?%;color:#9ed7ee;padding:%?8?%;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease}.refresh-btn[data-v-747a115c]:active{-webkit-transform:scale(.9);transform:scale(.9);opacity:.7}.refresh-btn.refreshing[data-v-747a115c]{-webkit-animation:rotate-data-v-747a115c 1s linear infinite;animation:rotate-data-v-747a115c 1s linear infinite}@-webkit-keyframes rotate-data-v-747a115c{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes rotate-data-v-747a115c{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.close-btn[data-v-747a115c]{font-size:%?48?%;color:#999;line-height:1;position:relative;z-index:1001}.modal-body[data-v-747a115c]{flex:1;padding:%?20?% 0;max-height:60vh;overflow-y:auto}.loading-container[data-v-747a115c]{display:flex;justify-content:center;align-items:center;height:%?200?%}.loading-text[data-v-747a115c]{color:#999;font-size:%?28?%}.portfolios-list[data-v-747a115c]{padding:0 %?40?%}.portfolio-item[data-v-747a115c]{display:flex;align-items:center;padding:%?24?% 0;border-bottom:%?1?% solid #f8f8f8}.portfolio-item[data-v-747a115c]:last-child{border-bottom:none}.portfolio-item.selected[data-v-747a115c]{background:rgba(158,215,238,.1);border-radius:%?8?%;padding:%?24?% %?20?%;margin:0 %?-20?%}.portfolio-icon[data-v-747a115c]{font-size:%?40?%;margin-right:%?20?%}.portfolio-info[data-v-747a115c]{flex:1}.portfolio-name[data-v-747a115c]{font-size:%?30?%;color:#333;font-weight:500;margin-bottom:%?4?%}.portfolio-count[data-v-747a115c]{font-size:%?24?%;color:#999}.selected-icon[data-v-747a115c]{font-size:%?32?%;color:#9ed7ee;font-weight:700}.empty-state[data-v-747a115c]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:%?200?%;padding:%?40?%}.empty-icon[data-v-747a115c]{font-size:%?60?%;margin-bottom:%?16?%;opacity:.5}.empty-text[data-v-747a115c]{font-size:%?28?%;color:#666;margin-bottom:%?8?%}.empty-subtext[data-v-747a115c]{font-size:%?24?%;color:#999}.modal-footer[data-v-747a115c]{display:flex;gap:%?20?%;padding:%?30?% %?40?%;border-top:%?1?% solid #f0f0f0}.modal-btn[data-v-747a115c]{flex:1;height:%?80?%;border-radius:%?8?%;font-size:%?28?%;border:none;display:flex;align-items:center;justify-content:center;position:relative;z-index:1001}.secondary-btn[data-v-747a115c]{background:#f5f5f5;color:#666}.primary-btn[data-v-747a115c]{background:#9ed7ee;color:#fff}.primary-btn[data-v-747a115c]:disabled{background:#ccc;color:#999}\r\n/* 创建作品集弹窗样式 */.create-modal .modal-body[data-v-747a115c]{padding:%?40?%}.portfolio-name-input[data-v-747a115c]{width:100%;height:%?80?%;padding:0 %?20?%;border:%?2?% solid #e0e0e0;border-radius:%?8?%;font-size:%?30?%;box-sizing:border-box}.portfolio-name-input[data-v-747a115c]:focus{border-color:#9ed7ee}",""]),n.exports=t},a6d2:function(n,t,r){"use strict";r.d(t,"b",(function(){return e})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){}));var e=function(){var n=this,t=n.$createElement,r=n._self._c||t;return n.showTip?r("v-uni-view",{staticClass:"install_tip"},[r("v-uni-view",{staticClass:"install_tip_back"}),r("v-uni-view",{staticClass:"install_tip_detail"},[r("v-uni-image",{staticClass:"install_tip_close",attrs:{src:"/static/images/icons/close.png"},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.onClose.apply(void 0,arguments)}}}),r("v-uni-view",{staticClass:"install_tip_detail_title"},[n._v(n._s(n.title))]),r("v-uni-view",{staticClass:"install_tip_detail_tip"},[n._v(n._s(n.content))])],1)],1):n._e()},o=[]},b348:function(n,t,r){"use strict";r.d(t,"b",(function(){return e})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){}));var e=function(){var n=this,t=n.$createElement,r=n._self._c||t;return r("v-uni-view",[n.showClone?r("v-uni-view",{staticClass:"modal-overlay"},[r("v-uni-view",{staticClass:"modal-content"},[r("v-uni-view",{staticClass:"modal-header"},[r("v-uni-view",{staticClass:"modal-title"},[n._v("选择收藏夹")]),r("v-uni-view",{staticClass:"close-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.hideModal.apply(void 0,arguments)}}},[n._v("×")])],1),r("v-uni-view",{staticClass:"modal-body"},[n.isLoading?r("v-uni-view",{staticClass:"loading-container"},[r("v-uni-view",{staticClass:"loading-text"},[n._v("加载中...")])],1):n.folders.length>0?r("v-uni-view",{staticClass:"folders-list"},n._l(n.folders,(function(t,e){return r("v-uni-view",{key:e,class:"folder-item "+(n.selectedFolderId===t._id?"selected":""),attrs:{"data-folder-id":t._id},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.selectFolder.apply(void 0,arguments)}}},[r("v-uni-view",{staticClass:"folder-icon"},[n._v("📁")]),r("v-uni-view",{staticClass:"folder-info"},[r("v-uni-view",{staticClass:"folder-name"},[n._v(n._s(t.name))]),r("v-uni-view",{staticClass:"folder-count"},[n._v(n._s(t.itemCount)+" 个收藏")])],1),n.selectedFolderId===t._id?r("v-uni-view",{staticClass:"selected-icon"},[n._v("✓")]):n._e()],1)})),1):r("v-uni-view",{staticClass:"empty-state"},[r("v-uni-view",{staticClass:"empty-icon"},[n._v("📁")]),r("v-uni-view",{staticClass:"empty-text"},[n._v("还没有收藏夹")]),r("v-uni-view",{staticClass:"empty-subtext"},[n._v("先创建一个收藏夹吧")])],1)],1),r("v-uni-view",{staticClass:"modal-footer"},[r("v-uni-button",{staticClass:"modal-btn secondary-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.createFolder.apply(void 0,arguments)}}},[n._v("创建收藏夹")]),r("v-uni-button",{staticClass:"modal-btn primary-btn",attrs:{disabled:!n.selectedFolderId},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.confirmFavorite.apply(void 0,arguments)}}},[n._v("确认收藏")])],1)],1)],1):n._e(),n.showCreateModal?r("v-uni-view",{staticClass:"modal-overlay"},[r("v-uni-view",{staticClass:"modal-content create-modal"},[r("v-uni-view",{staticClass:"modal-header"},[r("v-uni-view",{staticClass:"modal-title"},[n._v("创建收藏夹")]),r("v-uni-view",{staticClass:"close-btn",on:{click:[function(t){arguments[0]=t=n.$handleEvent(t),n.hideCreateModal.apply(void 0,arguments)},function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.trueFun.apply(void 0,arguments)}]}},[n._v("×")])],1),r("v-uni-view",{staticClass:"modal-body"},[r("v-uni-input",{staticClass:"folder-name-input",attrs:{placeholder:"请输入收藏夹名称",value:n.newFolderName,focus:!0},on:{input:function(t){arguments[0]=t=n.$handleEvent(t),n.onFolderNameInput.apply(void 0,arguments)},click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=n.$handleEvent(t),n.trueFun.apply(void 0,arguments)}}})],1),r("v-uni-view",{staticClass:"modal-footer"},[r("v-uni-button",{staticClass:"modal-btn secondary-btn",on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.hideCreateModal.apply(void 0,arguments)}}},[n._v("取消")]),r("v-uni-button",{staticClass:"modal-btn primary-btn",attrs:{disabled:!n.newFolderName},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.createNewFolder.apply(void 0,arguments)}}},[n._v("创建")])],1)],1)],1):n._e()],1)},o=[]},b435:function(n,t,r){var e=r("c86c");t=e(!1),t.push([n.i,'\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* pages/post-detail/post-detail.wxss */\r\n\r\n/* 自定义返回按钮 */.custom-back-btn[data-v-5a61cc78]{position:absolute;top:calc(%?90?% + env(safe-area-inset-top, var(--safe-area-inset-top, 44px))); /* 添加安全区域偏移 */left:%?40?%;width:%?100?%;height:%?100?%;background:transparent;border:none;display:block;z-index:100;transition:all .2s ease;box-sizing:border-box}.custom-back-btn[data-v-5a61cc78]:active{-webkit-transform:scale(.95);transform:scale(.95)}.custom-back-btn .back-icon[data-v-5a61cc78]{width:%?100?%;height:%?100?%;display:block;object-fit:contain}.container[data-v-5a61cc78]{background-color:#fff;min-height:100vh;padding-bottom:%?140?%;padding-top:calc(%?160?% + env(safe-area-inset-top, var(--safe-area-inset-top, 44px))); /* 添加安全区域上边距 */position:relative /* 为返回按钮提供定位上下文 */}.post-detail-skeleton[data-v-5a61cc78]{padding:0}.skeleton-wrapper[data-v-5a61cc78]{background:#fff;padding:%?40?% %?40?% %?20?% %?40?%;border-bottom:%?1?% solid #f0f0f0;margin-bottom:0}.comment-skeleton-item[data-v-5a61cc78]{display:flex;align-items:flex-start;background-color:#fff;padding:%?20?% %?40?%;border-bottom:%?1?% solid #f5f5f5}.skeleton-header[data-v-5a61cc78]{display:flex;align-items:center;margin-bottom:%?24?%}.skeleton-avatar[data-v-5a61cc78]{width:%?88?%;height:%?88?%;border-radius:50%;background-color:#e9edf3}.skeleton-header-text[data-v-5a61cc78]{flex:1;margin-left:%?24?%}.skeleton-line[data-v-5a61cc78]{height:%?24?%;background-color:#e9edf3;border-radius:%?999?%;margin-bottom:%?16?%}.skeleton-line[data-v-5a61cc78]:last-child{margin-bottom:0}.skeleton-line.long[data-v-5a61cc78]{width:100%}.skeleton-line.medium[data-v-5a61cc78]{width:70%}.skeleton-line.short[data-v-5a61cc78]{width:45%}.skeleton-line.xshort[data-v-5a61cc78]{width:30%}.skeleton-image[data-v-5a61cc78]{width:100%;height:%?340?%;border-radius:%?20?%;background-color:#e9edf3;margin:%?30?% 0}.skeleton-section-title[data-v-5a61cc78]{width:50%;height:%?28?%;border-radius:%?999?%;background-color:#e9edf3;margin:%?10?% 0 %?30?%}.comment-skeleton-list[data-v-5a61cc78]{display:flex;flex-direction:column;gap:%?24?%}.comment-skeleton-item[data-v-5a61cc78]{display:flex;align-items:flex-start;background-color:#fff;border-radius:%?16?%;padding:%?24?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05)}.comment-skeleton-body[data-v-5a61cc78]{flex:1;margin-left:%?24?%}.comment-skeleton-body .skeleton-line[data-v-5a61cc78]{height:%?20?%}.skeleton-animate[data-v-5a61cc78]{position:relative;overflow:hidden}.skeleton-animate[data-v-5a61cc78]::after{content:"";position:absolute;top:0;left:-150%;width:150%;height:100%;background:linear-gradient(90deg,rgba(233,237,243,0),hsla(0,0%,100%,.9) 50%,rgba(233,237,243,0));-webkit-animation:skeletonPulse-data-v-5a61cc78 1.2s ease-in-out infinite;animation:skeletonPulse-data-v-5a61cc78 1.2s ease-in-out infinite}@-webkit-keyframes skeletonPulse-data-v-5a61cc78{0%{left:-150%}100%{left:100%}}@keyframes skeletonPulse-data-v-5a61cc78{0%{left:-150%}100%{left:100%}}.error-container[data-v-5a61cc78]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:%?100?% %?40?%;text-align:center}.error-icon[data-v-5a61cc78]{font-size:%?120?%;margin-bottom:%?30?%;opacity:.6}.error-text[data-v-5a61cc78]{font-size:%?32?%;color:#666}.post-detail-wrapper[data-v-5a61cc78]{background:#fff;padding:%?40?% %?40?% %?20?% %?40?%;border-bottom:%?1?% solid #f0f0f0;margin-bottom:0}.post-detail-wrapper.original-post[data-v-5a61cc78]{background:linear-gradient(180deg,hsla(0,0%,100%,0),hsla(0,0%,100%,0) 90%,rgba(235,200,141,.05) 95%,rgba(235,200,141,.08));border-left:%?3?% solid #ebc88d;position:relative}.post-detail-wrapper.poem-post[data-v-5a61cc78]{background:#fff!important}.author-info[data-v-5a61cc78]{display:flex;align-items:center;justify-content:flex-start;margin-bottom:%?20?%;gap:%?20?%}.author-basic[data-v-5a61cc78]{display:flex;align-items:center;flex:1;min-width:0;gap:%?12?%;flex-wrap:wrap}.follow-btn[data-v-5a61cc78]{padding:0 %?28?%;height:%?60?%;line-height:%?60?%;background-color:#9ed7ee;color:#fff;border:none;border-radius:%?999?%;font-size:%?26?%;flex-shrink:0;margin-left:auto}.follow-btn.following[data-v-5a61cc78]{background-color:#f0f0f0;color:#666}.follow-btn[data-v-5a61cc78]::after{border:none}.follow-btn[disabled][data-v-5a61cc78]{opacity:.7}.author-avatar[data-v-5a61cc78]{width:%?60?%;height:%?60?%;border-radius:50%;margin-right:%?15?%;background-color:#f5f5f5}.author-name[data-v-5a61cc78]{font-weight:700;font-size:%?28?%;color:#333}.post-title[data-v-5a61cc78]{font-size:%?36?%;font-weight:700;margin-bottom:%?15?%;line-height:1.4;color:#333;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.poem-author[data-v-5a61cc78]{font-size:%?28?%;color:#333;text-align:left;margin:%?10?% 0 %?15?% 0;font-weight:700;letter-spacing:%?2?%}.post-content[data-v-5a61cc78]{font-size:%?28?%;line-height:1.6;margin-bottom:%?20?%;white-space:pre-wrap;color:#666;word-break:break-word}.image-container[data-v-5a61cc78]{position:relative;width:100%;margin:%?20?% 0;background-color:#f5f5f5}.post-image[data-v-5a61cc78]{width:100%;height:auto;display:block;background-color:#f5f5f5;transition:-webkit-transform .3s ease;transition:transform .3s ease;transition:transform .3s ease,-webkit-transform .3s ease}.post-image[data-v-5a61cc78]:active{-webkit-transform:scale(1.05);transform:scale(1.05)}.post-image.single-image[data-v-5a61cc78]{width:100%!important;height:auto!important;display:block!important;background-color:#f5f5f5}.image-count-indicator[data-v-5a61cc78]{position:absolute;top:%?20?%;right:%?20?%;background-color:rgba(0,0,0,.6);color:#fff;padding:%?8?% %?16?%;border-radius:%?20?%;font-size:%?24?%;z-index:10;-webkit-backdrop-filter:blur(%?10?%);backdrop-filter:blur(%?10?%)}.post-meta[data-v-5a61cc78]{margin-bottom:%?15?%}.post-time[data-v-5a61cc78]{font-size:%?24?%;color:#999;opacity:.8}.vote-section[data-v-5a61cc78]{display:flex;justify-content:flex-end;align-items:center;margin-top:%?10?%;padding:%?10?% %?40?% 0 %?40?%}.actions-left[data-v-5a61cc78]{display:flex;align-items:center}.vote-count[data-v-5a61cc78],\r\n.comment-count[data-v-5a61cc78]{display:flex;align-items:center;font-size:%?28?%;color:#999;margin-left:%?10?%;transition:color .2s ease}.action-emoji[data-v-5a61cc78]{font-size:%?28?%;margin-right:%?8?%}.action-text[data-v-5a61cc78]{font-size:%?28?%;color:inherit}.like-icon-container[data-v-5a61cc78]{display:flex;align-items:center;justify-content:center;padding:%?12?%;border-radius:%?12?%;transition:all .2s ease;width:%?60?%;height:%?60?%;margin-right:%?12?%}.like-icon-container[data-v-5a61cc78]:active{-webkit-transform:scale(.95);transform:scale(.95)}.vote-count.voted[data-v-5a61cc78]{color:#ff4757}.button-group[data-v-5a61cc78]{display:flex;align-items:center}.favorite-icon-container[data-v-5a61cc78]{margin-right:%?12?%;display:flex;align-items:center;justify-content:center;padding:%?12?%;border-radius:%?12?%;transition:all .2s ease;width:%?60?%;height:%?60?%}.favorite-icon-container[data-v-5a61cc78]:active{-webkit-transform:scale(.95);transform:scale(.95)}.favorite-icon[data-v-5a61cc78]{width:%?56?%;height:%?56?%;opacity:1}.favorite-icon-container.favorited .favorite-icon[data-v-5a61cc78]{opacity:.6}.portfolio-icon-container[data-v-5a61cc78]{margin-right:%?12?%;display:flex;align-items:center;justify-content:center;padding:%?12?%;border-radius:%?12?%;transition:all .2s ease;width:%?60?%;height:%?60?%}.portfolio-icon-container[data-v-5a61cc78]:active{-webkit-transform:scale(.95);transform:scale(.95)}.portfolio-icon[data-v-5a61cc78]{width:%?56?%;height:%?56?%}.discussion-icon-container[data-v-5a61cc78]{margin-right:%?12?%;display:flex;align-items:center;justify-content:center;padding:%?12?%;border-radius:%?12?%;transition:all .2s ease;width:%?60?%;height:%?60?%}.discussion-icon-container[data-v-5a61cc78]:active{-webkit-transform:scale(.95);transform:scale(.95)}.discussion-icon[data-v-5a61cc78]{width:%?56?%;height:%?56?%}.comment-icon-container[data-v-5a61cc78]{margin-right:0;display:flex;align-items:center;justify-content:center;padding:%?12?%;border-radius:%?12?%;transition:all .2s ease;width:%?60?%;height:%?60?%}.comment-icon-container[data-v-5a61cc78]:active{-webkit-transform:scale(.95);transform:scale(.95)}.comment-icon[data-v-5a61cc78]{width:%?56?%;height:%?56?%}.like-icon[data-v-5a61cc78]{width:%?56?%;height:%?56?%}.comment-section[data-v-5a61cc78]{background:#fff;padding:%?30?% %?40?%;border-bottom:%?1?% solid #f0f0f0}.section-title[data-v-5a61cc78]{font-size:%?26?%;font-weight:400;margin-bottom:%?20?%;padding-bottom:%?15?%;border-bottom:%?1?% solid #f0f0f0;color:#999;margin-left:0;text-align:left}.comment-list[data-v-5a61cc78]{margin-top:%?20?%}.comment-item[data-v-5a61cc78]{display:flex;margin-bottom:0;padding:%?20?% 0;border-bottom:%?1?% solid #f0f0f0}.comment-item[data-v-5a61cc78]:last-child{border-bottom:none;margin-bottom:0}.comment-avatar[data-v-5a61cc78]{width:%?60?%;height:%?60?%;border-radius:50%;margin-right:%?15?%;flex-shrink:0;background-color:#f5f5f5;margin-left:0}.comment-main[data-v-5a61cc78]{display:flex;flex-direction:column;flex:1;min-width:0}.comment-author[data-v-5a61cc78]{font-size:%?28?%;color:#333;font-weight:700;margin-bottom:%?8?%}.comment-content[data-v-5a61cc78]{font-size:%?28?%;color:#666;line-height:1.5;word-break:break-word;margin-bottom:%?10?%}.comment-image-grid[data-v-5a61cc78]{display:flex;flex-direction:column;gap:%?12?%;margin-bottom:%?12?%}.comment-image[data-v-5a61cc78]{width:100%;height:%?400?%;border-radius:%?12?%;background-color:#f2f2f2;display:block;object-fit:cover}.reply-image-grid[data-v-5a61cc78]{margin-top:%?10?%}.comment-footer[data-v-5a61cc78]{display:flex;justify-content:space-between;align-items:center;width:100%;margin-right:%?40?%}.comment-time[data-v-5a61cc78]{font-size:%?24?%;color:#999;opacity:.8}.comment-actions[data-v-5a61cc78]{display:flex;align-items:center}.like-section[data-v-5a61cc78]{display:flex;align-items:center;padding:%?8?% %?12?%;margin-right:%?15?%;transition:all .2s ease}.like-section[data-v-5a61cc78]:active{-webkit-transform:scale(.95);transform:scale(.95)}.like-section .like-icon[data-v-5a61cc78]{width:%?32?%;height:%?32?%;margin-right:%?8?%}.like-count[data-v-5a61cc78]{font-size:%?26?%;color:#666}.delete-btn[data-v-5a61cc78]{display:flex;align-items:center;padding:%?8?% %?12?%;margin-right:%?15?%;transition:opacity .2s ease}.delete-btn[data-v-5a61cc78]:active{opacity:.7}.delete-text[data-v-5a61cc78]{font-size:%?26?%;color:#ff4d4f}.reply-btn[data-v-5a61cc78]{display:flex;align-items:center;padding:%?8?% %?12?%;transition:opacity .2s ease}.reply-btn[data-v-5a61cc78]:active{opacity:.7}.reply-text[data-v-5a61cc78]{font-size:%?26?%;color:#9ed7ee}.replies-container[data-v-5a61cc78]{margin-top:%?15?%;margin-left:%?10?%;padding-left:%?10?%;border-left:%?2?% solid #f0f0f0}.reply-item[data-v-5a61cc78]{display:flex;margin-bottom:%?15?%}.reply-avatar[data-v-5a61cc78]{width:%?40?%;height:%?40?%;border-radius:50%;margin-right:%?10?%;flex-shrink:0;background-color:#f5f5f5}.reply-main[data-v-5a61cc78]{display:flex;flex-direction:column;flex:1;min-width:0}.reply-author[data-v-5a61cc78]{font-size:%?24?%;color:#333;font-weight:700;margin-bottom:%?4?%}.reply-content[data-v-5a61cc78]{font-size:%?26?%;color:#666;line-height:1.4;word-break:break-word}.reply-to[data-v-5a61cc78]{color:#9ed7ee;font-weight:700}.reply-footer[data-v-5a61cc78]{display:flex;justify-content:space-between;align-items:center;margin-top:%?8?%}.reply-time[data-v-5a61cc78]{font-size:%?22?%;color:#999;opacity:.8}.reply-actions[data-v-5a61cc78]{display:flex;align-items:center}.show-more-replies[data-v-5a61cc78]{padding:%?10?% 0;transition:opacity .2s ease}.show-more-replies[data-v-5a61cc78]:active{opacity:.7}.show-more-text[data-v-5a61cc78]{font-size:%?24?%;color:#9ed7ee}.no-comment-tip[data-v-5a61cc78]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:%?60?% %?40?%;text-align:center}.empty-icon[data-v-5a61cc78]{font-size:%?80?%;margin-bottom:%?20?%;opacity:.6}.empty-text[data-v-5a61cc78]{font-size:%?28?%;color:#999}.input-overlay[data-v-5a61cc78]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.4);z-index:99;opacity:0;pointer-events:none;transition:opacity .3s ease}.input-overlay.show[data-v-5a61cc78]{opacity:1;pointer-events:auto}.comment-input-area[data-v-5a61cc78]{position:fixed;left:0;right:0;bottom:0;background-color:#fff;z-index:100;transition:bottom .2s ease-out;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.collapsed-bar[data-v-5a61cc78]{padding:%?16?% %?40?%;display:flex;align-items:center;border-top:%?1?% solid #f0f0f0}.collapsed-input-placeholder[data-v-5a61cc78]{flex:1;height:%?68?%;line-height:%?68?%;padding:0 %?24?%;background-color:#f7f8fa;border-radius:%?34?%;font-size:%?28?%;color:#999}.expanded-container[data-v-5a61cc78]{padding:%?20?% %?40?%;display:flex;flex-direction:column;border-top:%?1?% solid #f0f0f0}.expanded-textarea[data-v-5a61cc78]{width:100%;min-height:%?180?%;max-height:%?350?%;padding:%?20?% %?24?%;background-color:#fff;border-radius:0;font-size:%?30?%;line-height:1.6;box-sizing:border-box;border:none;-webkit-appearance:none;-webkit-box-sizing:border-box;-webkit-user-select:text;-webkit-touch-callout:default;outline:none}.expanded-actions[data-v-5a61cc78]{display:flex;justify-content:space-between;align-items:center;margin-top:%?20?%;width:100%}.action-icons[data-v-5a61cc78]{display:flex;gap:%?24?%}.action-icon[data-v-5a61cc78]{width:%?100?%;height:%?100?%;border-radius:0;background:transparent;display:flex;align-items:center;justify-content:center;transition:-webkit-transform .2s ease;transition:transform .2s ease;transition:transform .2s ease,-webkit-transform .2s ease}.action-icon[data-v-5a61cc78]:active{-webkit-transform:scale(.92);transform:scale(.92);background:transparent}.action-icon-text[data-v-5a61cc78]{font-size:%?36?%}.action-icon-image[data-v-5a61cc78]{width:%?80?%;height:%?80?%}.selected-comment-images[data-v-5a61cc78]{display:flex;flex-wrap:wrap;gap:%?12?%;margin-top:%?16?%}.selected-image-item[data-v-5a61cc78]{position:relative;width:%?150?%;height:%?150?%;border-radius:%?12?%;overflow:hidden}.selected-image-thumb[data-v-5a61cc78]{width:100%;height:100%;background-color:#f2f2f2;display:block}.remove-image-btn[data-v-5a61cc78]{position:absolute;top:%?6?%;right:%?6?%;width:%?36?%;height:%?36?%;border-radius:50%;background:rgba(0,0,0,.55);color:#fff;font-size:%?24?%;display:flex;align-items:center;justify-content:center}.emoji-panel[data-v-5a61cc78]{margin-top:%?16?%;padding:%?20?% %?18?%;background:#f6f7f9;border-radius:%?16?%;display:flex;flex-wrap:wrap;gap:%?18?%}.emoji-item[data-v-5a61cc78]{font-size:%?36?%;padding:%?6?% %?10?%}.reply-prompt[data-v-5a61cc78]{display:flex;justify-content:flex-start;align-items:center;margin-bottom:%?15?%;padding:0 %?10?%}.reply-prompt-text[data-v-5a61cc78]{font-size:%?26?%;color:#666}.cancel-reply .cancel-text[data-v-5a61cc78]{font-size:%?26?%;color:#9ed7ee}.submit-button[data-v-5a61cc78]{width:%?120?%!important;height:%?64?%!important;line-height:%?64?%!important;background-color:#9ed7ee;color:#fff;border-radius:%?32?%;font-size:%?28?%;padding:0!important;margin:0!important;border:none!important;box-sizing:border-box!important;flex-shrink:0;transition:background-color .2s ease}.submit-button[disabled][data-v-5a61cc78]{background-color:#b3e6c9;color:#fff}.submit-button[data-v-5a61cc78]::after{border:none}.swiper-wrapper[data-v-5a61cc78]{position:relative;width:100%}.image-swiper[data-v-5a61cc78]{width:100%;background-color:#f0f0f0;border-radius:%?12?%;overflow:hidden}.swiper-item[data-v-5a61cc78]{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.post-image[data-v-5a61cc78]{max-width:100%;max-height:100%}.image-count-indicator[data-v-5a61cc78]{position:absolute;bottom:%?20?%;right:%?20?%;background-color:rgba(0,0,0,.6);color:#fff;padding:%?8?% %?16?%;border-radius:%?20?%;font-size:%?24?%;z-index:10;-webkit-backdrop-filter:blur(%?10?%);backdrop-filter:blur(%?10?%)}.post-tags[data-v-5a61cc78]{margin:%?30?% 0 %?10?% 0;line-height:1.5}.post-tag[data-v-5a61cc78]{color:#24375f;font-size:%?26?%;margin-right:%?10?%;transition:all .2s ease;cursor:pointer}.post-tag[data-v-5a61cc78]:active{color:#1a2a4a;opacity:.8}.mutual-tag[data-v-5a61cc78]{font-size:%?24?%;padding:%?4?% %?16?%;border-radius:%?999?%;background-color:#e6f4ff;color:#1f6fd2;flex-shrink:0}.followed-tag[data-v-5a61cc78]{font-size:%?24?%;padding:%?4?% %?16?%;border-radius:%?999?%;background-color:#f4ebff;color:#7c55c7;flex-shrink:0}\r\n\r\n/* 模式切换样式 */.mode-switcher[data-v-5a61cc78]{display:flex;background:#f7f8fa;border-radius:%?25?%;padding:%?6?%;margin-bottom:%?20?%;border:%?2?% solid #e9ecef}.mode-item[data-v-5a61cc78]{flex:1;text-align:center;padding:%?16?% %?24?%;border-radius:%?20?%;transition:all .3s ease;position:relative}.mode-item.active[data-v-5a61cc78]{background:#9ed7ee;box-shadow:0 %?2?% %?8?% rgba(158,215,238,.3)}.mode-text[data-v-5a61cc78]{font-size:%?28?%;font-weight:500;color:#666;transition:color .3s ease}.mode-item.active .mode-text[data-v-5a61cc78]{color:#fff;font-weight:600}\r\n\r\n/* 讨论标题输入样式 */.discussion-title-wrapper[data-v-5a61cc78]{margin-bottom:%?15?%;border-bottom:%?1?% solid #f0f0f0;padding-bottom:%?15?%}.discussion-title-input[data-v-5a61cc78]{width:100%;height:%?80?%;line-height:%?80?%;padding:0 %?24?%;background-color:#fff;border:%?1?% solid #e9ecef;border-radius:%?12?%;font-size:%?30?%;color:#333;box-sizing:border-box}.discussion-title-input[data-v-5a61cc78]::-webkit-input-placeholder{color:#999}.discussion-title-input[data-v-5a61cc78]::placeholder{color:#999}\r\n\r\n/* 讨论类型帖子样式 */.discussion-content[data-v-5a61cc78]{margin:%?20?% 0}.discussion-sentence-group[data-v-5a61cc78]{margin-bottom:%?30?%}.discussion-sentence-card[data-v-5a61cc78]{background:#f5f5f5; /* 添加灰色背景 */border-radius:%?12?%; /* 添加圆角 */padding:%?30?%;margin-bottom:%?20?%;width:100%;min-height:%?120?%;position:relative;box-sizing:border-box;max-width:100%}.discussion-sentence-content[data-v-5a61cc78]{position:relative;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;box-sizing:border-box;max-width:100%}.discussion-sentence-line[data-v-5a61cc78]{font-family:Inter,sans-serif;font-style:italic;font-weight:600;font-size:%?40?%;line-height:%?48?%;color:#989090;display:block;margin-bottom:%?8?%;word-wrap:break-word;word-break:break-all;width:100%;max-width:100%;box-sizing:border-box;overflow-wrap:break-word}.discussion-sentence-line[data-v-5a61cc78]:last-child{margin-bottom:0}.discussion-comment[data-v-5a61cc78]{font-family:Inter,sans-serif;font-weight:600;font-size:%?32?%;line-height:%?38?%;color:#000;margin-top:%?20?%;padding:%?20?% 0; /* 移除左右padding，只保留上下padding */background:transparent; /* 移除灰色背景 */border-radius:0; /* 移除圆角 */word-wrap:break-word;word-break:break-all;width:100%;max-width:100%;box-sizing:border-box;overflow-wrap:break-word}',""]),n.exports=t},b695:function(n,t,r){var e=r("9f16");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);var o=r("967d").default;o("2bc966b0",e,!0,{sourceMap:!1,shadowMode:!1})},be14:function(n,t,r){var e=r("b435");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);var o=r("967d").default;o("5f6a1cde",e,!0,{sourceMap:!1,shadowMode:!1})},d242:function(n,t,r){var e=r("c86c");t=e(!1),t.push([n.i,"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* components/folder-selector/folder-selector.wxss */.modal-overlay[data-v-3a05c372]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[data-v-3a05c372]{background:#fff;border-radius:%?16?%;margin:%?40?%;width:calc(100% - %?80?%);max-width:%?600?%;max-height:80vh;display:flex;flex-direction:column}.modal-header[data-v-3a05c372]{display:flex;align-items:center;justify-content:space-between;padding:%?30?% %?40?%;border-bottom:%?1?% solid #f0f0f0}.modal-title[data-v-3a05c372]{font-size:%?36?%;font-weight:500;color:#333}.close-btn[data-v-3a05c372]{font-size:%?48?%;color:#999;line-height:1;position:relative;z-index:1001}.modal-body[data-v-3a05c372]{flex:1;padding:%?20?% 0;max-height:60vh;overflow-y:auto}.loading-container[data-v-3a05c372]{display:flex;justify-content:center;align-items:center;height:%?200?%}.loading-text[data-v-3a05c372]{color:#999;font-size:%?28?%}.folders-list[data-v-3a05c372]{padding:0 %?40?%}.folder-item[data-v-3a05c372]{display:flex;align-items:center;padding:%?24?% 0;border-bottom:%?1?% solid #f8f8f8}.folder-item[data-v-3a05c372]:last-child{border-bottom:none}.folder-item.selected[data-v-3a05c372]{background:rgba(7,193,96,.1);border-radius:%?8?%;padding:%?24?% %?20?%;margin:0 %?-20?%}.folder-icon[data-v-3a05c372]{font-size:%?40?%;margin-right:%?20?%}.folder-info[data-v-3a05c372]{flex:1}.folder-name[data-v-3a05c372]{font-size:%?30?%;color:#333;font-weight:500;margin-bottom:%?4?%}.folder-count[data-v-3a05c372]{font-size:%?24?%;color:#999}.selected-icon[data-v-3a05c372]{font-size:%?32?%;color:#9ed7ee;font-weight:700}.empty-state[data-v-3a05c372]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:%?200?%;padding:%?40?%}.empty-icon[data-v-3a05c372]{font-size:%?60?%;margin-bottom:%?16?%;opacity:.5}.empty-text[data-v-3a05c372]{font-size:%?28?%;color:#666;margin-bottom:%?8?%}.empty-subtext[data-v-3a05c372]{font-size:%?24?%;color:#999}.modal-footer[data-v-3a05c372]{display:flex;gap:%?20?%;padding:%?30?% %?40?%;border-top:%?1?% solid #f0f0f0}.modal-btn[data-v-3a05c372]{flex:1;height:%?80?%;border-radius:%?8?%;font-size:%?28?%;border:none;display:flex;align-items:center;justify-content:center;position:relative;z-index:1001}.secondary-btn[data-v-3a05c372]{background:#f5f5f5;color:#666}.primary-btn[data-v-3a05c372]{background:#9ed7ee;color:#fff}.primary-btn[data-v-3a05c372]:disabled{background:#ccc;color:#999}\r\n/* 创建收藏夹弹窗样式 */.create-modal .modal-body[data-v-3a05c372]{padding:%?40?%}.folder-name-input[data-v-3a05c372]{width:100%;height:%?80?%;padding:0 %?20?%;border:%?2?% solid #e0e0e0;border-radius:%?8?%;font-size:%?30?%;box-sizing:border-box}.folder-name-input[data-v-3a05c372]:focus{border-color:#9ed7ee}",""]),n.exports=t},daaa:function(n,t,r){"use strict";r.r(t);var e=r("9d3a"),o=r.n(e);for(var a in e)["default"].indexOf(a)<0&&function(n){r.d(t,n,(function(){return e[n]}))}(a);t["default"]=o.a},df61:function(n,t,r){var e=r("dd7e").default,o=r("46c5").default;r("64aa"),r("dc8a"),r("8f71"),r("bf0f"),r("9db6"),r("2797"),r("de6c"),r("7a76"),r("c9b5");var a=r("11ca"),i=a.cloudCall,s=r("fe58"),l=r("3ab8").default;function c(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=Number(n);return Number.isFinite(r)?r:t}function d(n,t,r){if("function"===typeof n)try{return n(t,r)}catch(e){console.warn("[likeService] likeIcon resolver 执行失败",e)}return s.getLikeIcon(t,r)}function u(n){var t=n.votes,r=n.isLiked,e=n.icon;return{votes:t,isLiked:r,likeIcon:e}}function f(n,t,r,e){try{if(!n)return;var o=l.getStats?l.getStats():{},a=Object.keys(o),i=a.filter((function(n){return"posts:home"===n||"posts:discover"===n||n.startsWith("posts:tag:")||n.startsWith("me:posts")||n.startsWith("userPosts:")}));i.forEach((function(o){try{var a=l.namespace(o),i=a.keys&&a.keys()||[];i.forEach((function(o){try{a.update(o,(function(o){if(!Array.isArray(o))return o;for(var a=0;a<o.length;a+=1){var i=o[a];!i||i._id!==n&&i.id!==n||(i.votes=t,i.isVoted=r,i.likeIcon=e,!0)}return o}))}catch(i){}}))}catch(s){}}))}catch(s){console.warn("[likeService] updatePostInCaches failed",s)}}function m(n){if("undefined"!==typeof uni&&"function"===typeof uni.showToast)try{uni.showToast({title:n||"操作失败，请稍后重试",icon:"none"})}catch(t){console.warn("[likeService] showToast 调用失败",t)}}function p(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.pageTag,r=void 0===t?"like-service":t,e=n.context,o=void 0===e?null:e,a=n.currentVotes,i=void 0===a?0:a,l=n.currentIsLiked,d=void 0!==l&&l,u=n.likeIconResolver,f=void 0===u?s.getLikeIcon:u,m=n.requireAuth,p=void 0===m||m,v=n.retry,g=void 0===v?0:v,h=n.updateCache,w=void 0===h||h,b=n.showErrorToast,y=void 0===b||b,k=n.cloudOptions,C=void 0===k?{}:k;return{pageTag:r,context:o,currentVotes:c(i,0),currentIsLiked:Boolean(d),likeIconResolver:f,requireAuth:p,retry:g,updateCache:w,showErrorToast:y,cloudOptions:C}}function v(){return v=o(e().mark((function n(t){var r,o,a,s,l,v,g,h,w,b,y,k,C,x,_,I,F,T,P,D,E,U,z,A=arguments;return e().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=A.length>1&&void 0!==A[1]?A[1]:{},t){n.next=3;break}return n.abrupt("return",Promise.reject(new Error("[likeService] postId 不能为空")));case 3:return o=p(r),a=o.pageTag,s=o.context,l=o.currentVotes,v=o.currentIsLiked,g=o.likeIconResolver,h=o.requireAuth,w=o.retry,b=o.updateCache,y=o.showErrorToast,k=o.cloudOptions,C=c(l,0),x=Boolean(v),_=d(g,C,x),I=u({votes:C,isLiked:x,icon:_}),n.prev=8,n.next=11,i("vote",{postId:t},Object.assign({pageTag:"likeService:".concat(a),context:s,requireAuth:h,retry:w},k));case 11:F=n.sent,n.next=19;break;case 14:return n.prev=14,n.t0=n["catch"](8),console.error("[likeService] 调用云函数失败",n.t0),y&&m(n.t0&&n.t0.message),n.abrupt("return",{success:!1,error:n.t0,rollback:I});case 19:if(T=F&&F.result?F.result:F,P=T&&!0===T.success,P){n.next=26;break}return D=T&&T.message?T.message:"操作失败，请稍后重试",console.warn("[likeService] 云函数返回失败结果",T),y&&m(D),n.abrupt("return",{success:!1,error:T,rollback:I});case 26:return E=c(T.votes,C),U=Boolean(T.isLiked),z=d(g,E,U),b&&f(t,E,U,z),n.abrupt("return",{success:!0,votes:E,isLiked:U,likeIcon:z,response:T});case 31:case"end":return n.stop()}}),n,null,[[8,14]])}))),v.apply(this,arguments)}n.exports={togglePostLike:function(n){return v.apply(this,arguments)}}},ee81:function(n,t,r){"use strict";r.r(t);var e=r("028d"),o=r("6918");for(var a in o)["default"].indexOf(a)<0&&function(n){r.d(t,n,(function(){return o[n]}))}(a);r("560a");var i=r("828b"),s=Object(i["a"])(o["default"],e["b"],e["c"],!1,null,"747a115c",null,!1,e["a"],void 0);t["default"]=s.exports},f0b9:function(n,t,r){var e=r("221b");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);var o=r("967d").default;o("9b847392",e,!0,{sourceMap:!1,shadowMode:!1})},f7a1:function(n,t,r){"use strict";r.r(t);var e=r("a6d2"),o=r("3ccb");for(var a in o)["default"].indexOf(a)<0&&function(n){r.d(t,n,(function(){return o[n]}))}(a);r("0691");var i=r("828b"),s=Object(i["a"])(o["default"],e["b"],e["c"],!1,null,"a8601b98",null,!1,e["a"],void 0);t["default"]=s.exports},fe58:function(n,t){n.exports={getLikeIcon:function(n,t){var r="";return r=n<=3?t?"seedplus.png":"seed.png":n<=7?t?"leafplus.png":"leaf.png":n<=15?t?"flowerplus .png":"flower.png":t?"peachplus.png":"peach.png","/static/images/"+r},getLikeIconDescription:function(n){return n<=3?"种子":n<=7?"叶子":n<=15?"花":"果实"}}}}]);