(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-following-following"],{"334c":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){}));var n=function(){var t=this.$createElement,e=this._self._c||t;return e("v-uni-view",{staticClass:"container"},[this.followings.length>0?e("v-uni-view",{staticClass:"footer-hint"},[this.hasMore?this._e():e("v-uni-view",{staticClass:"loading-more"},[this._v("已经到底了")])],1):this._e()],1)},o=[]},3354:function(t,e,a){"use strict";a("6a54");var n=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(a("39d8"));a("bf0f"),a("c223"),a("8f71");var i=a("38db"),l=i.cloudCall,s={data:function(){return{followings:[],isLoading:!1,hasMore:!0,page:0,PAGE_SIZE:20,pendingOpenid:null,defaultAvatar:"/images/avatar.png",total:"",avatarKey:""}},onLoad:function(){this.loadFollowings(!0)},onPullDownRefresh:function(){this.loadFollowings(!0)},onReachBottom:function(){this.hasMore&&!this.isLoading&&this.loadFollowings()},methods:{callCloudFunction:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l(t,e,Object.assign({pageTag:"following",context:this,requireAuth:!0},a))},loadFollowings:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isLoading){e&&this.setData({page:0,hasMore:!0});var a=e?0:this.page;this.setData({isLoading:!0});var n=this.$requireOpenid&&this.$requireOpenid();if(!n)return this.setData({isLoading:!1}),void(e&&uni.stopPullDownRefresh());this.callCloudFunction("follow",{action:"getFollowingList",skip:a*this.PAGE_SIZE,limit:this.PAGE_SIZE,openid:n}).then((function(n){if(n.result&&n.result.success){var o=n.result.list||[],i=e?o:t.followings.concat(o);t.setData({followings:i,page:a+1,hasMore:!!n.result.hasMore,total:n.result.total||i.length})}else uni.showToast({title:n.result&&n.result.message?n.result.message:"加载失败",icon:"none"})})).catch((function(t){console.error("获取关注列表失败:",t),uni.showToast({title:"网络错误",icon:"none"})})).finally((function(){t.setData({isLoading:!1}),e&&uni.stopPullDownRefresh()}))}},onToggleFollow:function(t){var e=this,a=t.currentTarget.dataset.openid,n=t.currentTarget.dataset.index;if(a&&!this.pendingOpenid){this.setData({pendingOpenid:a});var o=this.$requireOpenid&&this.$requireOpenid();o?this.callCloudFunction("follow",{action:"toggleFollow",targetOpenid:a,openid:o}).then((function(t){if(t.result&&t.result.success){var a=!!t.result.isFollowing;if(a)uni.showToast({title:"已关注",icon:"success"});else{var o=e.followings.filter((function(t,e){return e!==n}));e.setData({followings:o}),uni.showToast({title:"已取消关注",icon:"success"}),e.hasMore&&o.length<e.PAGE_SIZE&&e.loadFollowings(),0!==o.length||e.hasMore||e.setData({page:0})}}else uni.showToast({title:t.result&&t.result.message?t.result.message:"操作失败",icon:"none"})})).catch((function(t){console.error("取消关注失败:",t),uni.showToast({title:"网络错误",icon:"none"})})).finally((function(){e.setData({pendingOpenid:null})})):this.setData({pendingOpenid:null})}},onAvatarError:function(t){var e=t.currentTarget.dataset.index;if(void 0!==e){var a="followings[".concat(e,"].avatarUrl");this.setData((0,o.default)({},a,this.defaultAvatar))}},openUserProfile:function(t){var e=t.currentTarget.dataset.openid;e&&uni.navigateTo({url:"/pages/user-profile/user-profile?userId=".concat(e)})}}};e.default=s},"40ea":function(t,e,a){"use strict";var n=a("c27d"),o=a.n(n);o.a},"5bb4":function(t,e,a){"use strict";a.r(e);var n=a("334c"),o=a("f2cd");for(var i in o)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(i);a("40ea");var l=a("828b"),s=Object(l["a"])(o["default"],n["b"],n["c"],!1,null,"0fac2ebc",null,!1,n["a"],void 0);e["default"]=s.exports},"5ef9":function(t,e,a){var n=a("c86c");e=n(!1),e.push([t.i,".container[data-v-0fac2ebc]{padding:%?32?%;background-color:#f7f8fa;min-height:100vh}.list[data-v-0fac2ebc]{display:flex;flex-direction:column;gap:%?24?%}.following-item[data-v-0fac2ebc]{display:flex;align-items:center;justify-content:space-between;background-color:#fff;border-radius:%?16?%;padding:%?24?% %?28?%;box-shadow:0 %?6?% %?18?% rgba(0,0,0,.05)}.user-info[data-v-0fac2ebc]{display:flex;align-items:center;flex:1;overflow:hidden}.avatar[data-v-0fac2ebc]{width:%?88?%;height:%?88?%;border-radius:50%;margin-right:%?20?%;background-color:#f0f0f0}.info-text[data-v-0fac2ebc]{display:flex;flex-direction:column;gap:%?8?%;overflow:hidden}.name[data-v-0fac2ebc]{font-size:%?30?%;color:#333;font-weight:600}.bio[data-v-0fac2ebc]{font-size:%?24?%;color:#888;line-height:1.4;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:%?420?%}.unfollow-btn[data-v-0fac2ebc]{margin-left:%?24?%;border:%?2?% solid #ff8f8f;color:#ff6b6b;background-color:#fff;border-radius:%?999?%;padding:0 %?28?%;height:%?64?%!important;line-height:%?64?%!important}.unfollow-btn[data-v-0fac2ebc]::after{border:none}.unfollow-btn[disabled][data-v-0fac2ebc]{opacity:.6}.loading[data-v-0fac2ebc],\r\n.loading-more[data-v-0fac2ebc]{margin-top:%?32?%;text-align:center;color:#999;font-size:%?26?%}.empty[data-v-0fac2ebc]{margin-top:%?120?%;text-align:center;color:#999;font-size:%?28?%}.footer-hint[data-v-0fac2ebc]{margin-top:%?24?%}.mutual-label[data-v-0fac2ebc]{margin-top:%?8?%;display:inline-block;padding:%?4?% %?16?%;background-color:#e6f4ff;color:#1f6fd2;border-radius:%?999?%;font-size:%?24?%}",""]),t.exports=e},c27d:function(t,e,a){var n=a("5ef9");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var o=a("967d").default;o("9a85f7a8",n,!0,{sourceMap:!1,shadowMode:!1})},f2cd:function(t,e,a){"use strict";a.r(e);var n=a("3354"),o=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=o.a}}]);