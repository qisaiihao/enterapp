(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-tag-filter-tag-filter"],{"0efe":function(t,e,n){var r=n("dd7e").default,a=n("46c5").default,i=n("bdbb").default,o=n("5014").default;n("dc8a"),n("bf0f"),n("2797"),n("7a76"),n("c9b5");var s={page:0,hasMore:!0,isLoading:!1,isLoadingMore:!1},l=Object.keys(s);function c(t){return t.__paginationState||(t.__paginationState=o({},s)),"object"!==i(t.pagination)||null===t.pagination?t.pagination=o({},s):t.pagination=o(o({},s),t.pagination),l.forEach((function(e){"undefined"===typeof t[e]&&(t[e]=s[e])})),t.__paginationState}function u(t,e){var n=c(t);Object.assign(n,e),function(t,e){if(e&&"object"===i(e)){var n={};if(l.forEach((function(r){Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r],t.pagination&&"object"===i(t.pagination)&&(t.pagination[r]=e[r]),t[r]=e[r])})),"function"===typeof t.setData){var r={};return Object.keys(n).forEach((function(t){r[t]=n[t],r["pagination.".concat(t)]=n[t]})),void t.setData(r)}Object.assign(t,n)}}(t,e)}function f(t,e,n){var r=n.pageSize,a=n.isRefresh,i=n.fallback;if(e&&"boolean"===typeof e.hasMore)return e.hasMore;var o=t.__paginationConfig||{};if("function"===typeof o.computeHasMore)try{var s=o.computeHasMore.call(t,e,{page:t.__paginationState.page,pageSize:r,isRefresh:a});if("boolean"===typeof s)return s}catch(l){console.warn("[pagination] computeHasMore 执行失败",l)}return e&&Array.isArray(e.list)?"number"===typeof r?e.list.length>=r:e.list.length>0:e&&Array.isArray(e.items)?"number"===typeof r?e.items.length>=r:e.items.length>0:"boolean"!==typeof i||i}function d(t){return g.apply(this,arguments)}function g(){return g=a(r().mark((function t(e){var n,a,i,o,s,l,d,g,p,v,m,h,b,y,w=arguments;return r().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=w.length>1&&void 0!==w[1]?w[1]:{},a=n.isRefresh,i=n.extra,o=void 0===i?{}:i,s=n.fromPullDown,l=void 0!==s&&s,d=e.__paginationConfig,d&&"function"===typeof d.loader){t.next=5;break}return console.warn("[pagination] 尚未通过 initPagination 注册加载函数"),t.abrupt("return",null);case 5:if(c(e),g=e.__paginationState,a||!1!==g.hasMore){t.next=9;break}return t.abrupt("return",null);case 9:if(!g.isLoading&&!g.isLoadingMore){t.next=11;break}return t.abrupt("return",null);case 11:return p=a?0:g.page,v=0===p,u(e,{isLoading:v,isLoadingMore:!v}),m={page:p,pageSize:d.pageSize,isRefresh:a,isFirstPage:v,extra:o},t.prev=15,"function"===typeof d.beforeLoad&&d.beforeLoad.call(e,m),t.next=19,d.loader.call(e,m);case 19:h=t.sent,b=p+1,y=f(e,h,{pageSize:d.pageSize,isRefresh:a,fallback:!!a||g.hasMore}),u(e,{page:b,hasMore:y}),"function"===typeof d.afterLoad&&d.afterLoad.call(e,h,m),t.next=30;break;case 26:throw t.prev=26,t.t0=t["catch"](15),"function"===typeof d.onError?d.onError.call(e,t.t0,m):console.error("[pagination] 加载数据失败",t.t0),t.t0;case 30:if(t.prev=30,u(e,{isLoading:!1,isLoadingMore:!1}),a&&!1!==d.autoStopPullDown&&l&&"undefined"!==typeof uni&&"function"===typeof uni.stopPullDownRefresh)try{uni.stopPullDownRefresh()}catch(r){console.warn("[pagination] stopPullDownRefresh 调用失败",r)}return t.finish(30);case 34:return t.abrupt("return",h);case 35:case"end":return t.stop()}}),t,null,[[15,26,30,34]])}))),g.apply(this,arguments)}t.exports={data:function(){return o({pagination:o({},s)},s)},created:function(){c(this)},onReachBottom:function(){this.__paginationConfig&&this.loadNext().catch((function(){}))},onPullDownRefresh:function(){this.__paginationConfig&&this.refresh({fromPullDown:!0}).catch((function(){}))},methods:{initPagination:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!==typeof t)throw new TypeError("[pagination] initPagination 需要传入函数类型的 loader");var n=e.pageSize,r=void 0===n?10:n,a=e.immediate,i=void 0===a||a,l=e.autoStopPullDown,c=void 0===l||l,f=e.computeHasMore,d=e.beforeLoad,g=e.afterLoad,p=e.onError;return this.__paginationConfig={loader:t,pageSize:r,immediate:i,autoStopPullDown:c,computeHasMore:f,beforeLoad:d,afterLoad:g,onError:p},u(this,o({},s)),i?this.refresh({fromPullDown:!1}):Promise.resolve()},refresh:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c(this),u(this,{page:0,hasMore:!0}),d(this,o({isRefresh:!0},t))},loadNext:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return d(this,o({isRefresh:!1},t))},getPaginationState:function(){return c(this),o({},this.__paginationState)}}}},1354:function(t,e,n){"use strict";n.r(e);var r=n("1cbe"),a=n("799f");for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("aa6d");var o=n("828b"),s=Object(o["a"])(a["default"],r["b"],r["c"],!1,null,"838fd33e",null,!1,r["a"],void 0);e["default"]=s.exports},"139b":function(t,e,n){n("795c"),n("64aa"),n("5c47"),n("a1c1"),n("c223"),n("f7a5");var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(t).padStart(e,"0")},a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd HH:mm:ss",n=t instanceof Date?t:new Date(t);if(Number.isNaN(n.getTime()))return"";var a={yyyy:String(n.getFullYear()),MM:r(n.getMonth()+1),dd:r(n.getDate()),HH:r(n.getHours()),mm:r(n.getMinutes()),ss:r(n.getSeconds())};return e.replace(/yyyy|MM|dd|HH|mm|ss/g,(function(t){return a[t]}))};t.exports={formatTimeAgo:function(t){var e=new Date,n=new Date(t),r=e.getTime()-n.getTime(),a=Math.floor(r/1e3),i=Math.floor(a/60),o=Math.floor(i/60),s=Math.floor(o/24);if(s>=7){var l=n.getFullYear(),c=("0"+(n.getMonth()+1)).slice(-2),u=("0"+n.getDate()).slice(-2);return"".concat(l,"-").concat(c,"-").concat(u)}return s>=1?"".concat(s,"天前"):o>=1?"".concat(o,"小时前"):i>=1?"".concat(i,"分钟前"):"刚刚"},formatRelativeTime:function(t){var e=Date.now(),n=t instanceof Date?t.getTime():new Date(t).getTime();if(Number.isNaN(n))return"";var r=e-n,i=Math.floor(Math.abs(r)/1e3),o=r>=0?"前":"后";if(i<60)return"刚刚";var s=Math.floor(i/60);if(s<60)return"".concat(s,"分钟").concat(o);var l=Math.floor(s/60);if(l<24)return"".concat(l,"小时").concat(o);var c=Math.floor(l/24);return c<7?"".concat(c,"天").concat(o):a(n,"yyyy-MM-dd")},formatDate:a}},"15a1":function(t,e,n){var r=n("c86c");e=r(!1),e.push([t.i,"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* pages/tag-filter/tag-filter.wxss */.container[data-v-838fd33e]{padding:%?20?%;background-color:#f7f8fa;min-height:100vh}\r\n/* 空状态样式 */.empty-state[data-v-838fd33e]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:%?400?%;background-color:#fff;border-radius:%?16?%;margin:%?30?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05)}.empty-icon[data-v-838fd33e]{font-size:%?80?%;margin-bottom:%?20?%}.empty-text[data-v-838fd33e]{font-size:%?32?%;color:#333;margin-bottom:%?10?%}.empty-subtext[data-v-838fd33e]{font-size:%?28?%;color:#999}\r\n/* 文章列表样式 */.post-list[data-v-838fd33e]{margin-bottom:%?20?%}.post-item-wrapper[data-v-838fd33e]{background-color:#fff;border-radius:%?16?%;margin-bottom:%?20?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05);overflow:hidden}\r\n/* 作者信息 */.author-info-outside[data-v-838fd33e]{display:flex;align-items:center;padding:%?20?% %?20?% 0 %?20?%;margin-bottom:%?15?%}.author-avatar[data-v-838fd33e]{width:%?60?%;height:%?60?%;border-radius:50%;margin-right:%?15?%}.author-name[data-v-838fd33e]{font-size:%?28?%;color:#333;font-weight:500}\r\n/* 帖子内容 */.post-item[data-v-838fd33e]{padding:0 %?20?% %?20?% %?20?%}.post-title[data-v-838fd33e]{font-size:%?32?%;font-weight:700;color:#333;margin-bottom:%?15?%;line-height:1.4}.post-content[data-v-838fd33e]{font-size:%?28?%;color:#666;line-height:1.6;margin-bottom:%?15?%}\r\n/* 图片容器 */.image-container-wrapper[data-v-838fd33e]{position:relative;width:100%;margin-bottom:%?15?%;background-color:#f0f0f0; /* 占位时的背景色，很重要 */overflow:hidden;border-radius:%?12?%}.image-container-wrapper .post-image[data-v-838fd33e],\r\n.image-container-wrapper .image-swiper[data-v-838fd33e]{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.post-image[data-v-838fd33e]{width:100%;height:100%;display:block;object-fit:cover}.image-swiper[data-v-838fd33e]{width:100%;height:100%}\r\n/* 标签样式 */.post-tags[data-v-838fd33e]{margin:%?20?% 0 %?10?% 0;line-height:1.5}.post-tag[data-v-838fd33e]{color:#24375f;font-size:%?26?%;margin-right:%?10?%;transition:all .2s ease;cursor:pointer}.post-tag[data-v-838fd33e]:active{color:#1a2a4a;opacity:.8}\r\n/* 互动区域 */.vote-section[data-v-838fd33e]{display:flex;justify-content:space-between;align-items:center;padding:%?15?% %?20?% %?20?% %?20?%;border-top:%?1?% solid #f0f0f0}.actions-left[data-v-838fd33e]{flex:1}.actions-right[data-v-838fd33e]{display:flex;gap:%?30?%}.action-item[data-v-838fd33e]{display:flex;align-items:center;gap:%?8?%}.action-emoji[data-v-838fd33e]{font-size:%?24?%}.action-text[data-v-838fd33e]{font-size:%?24?%;color:#999}\r\n/* 加载更多 */.loading-more[data-v-838fd33e]{display:flex;justify-content:center;align-items:center;padding:%?40?%}.loading-text[data-v-838fd33e]{font-size:%?28?%;color:#999}",""]),t.exports=e},"1cbe":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return r}));var r={skeleton:n("8cb3").default},a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"container"},[t.isLoading?n("v-uni-view",[n("skeleton")],1):n("v-uni-view",[0!==t.postList.length||t.isLoading?t._e():n("v-uni-view",{staticClass:"empty-state"},[n("v-uni-view",{staticClass:"empty-icon"},[t._v("🏷️")]),n("v-uni-view",{staticClass:"empty-text"},[t._v("还没有 #"+t._s(t.tag)+" 标签的文章")]),n("v-uni-view",{staticClass:"empty-subtext"},[t._v("快去发布相关内容吧！")])],1),t.postList.length>0?n("v-uni-view",{staticClass:"post-list"},t._l(t.postList,(function(e,r){return n("v-uni-view",{key:r,staticClass:"post-item-wrapper"},[n("v-uni-view",{staticClass:"author-info-outside"},[e.authorAvatar?n("v-uni-image",{staticClass:"author-avatar",attrs:{src:e.authorAvatar,mode:"aspectFill","data-user-id":e._openid},on:{error:function(e){arguments[0]=e=t.$handleEvent(e),t.onAvatarError.apply(void 0,arguments)},click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.navigateToUserProfile.apply(void 0,arguments)}}}):t._e(),n("v-uni-text",{staticClass:"author-name"},[t._v(t._s(e.authorName))])],1),n("v-uni-view",{staticClass:"post-item",attrs:{"data-postid":e._id},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onPostTap.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"post-title"},[t._v(t._s(e.title))]),e.imageUrls&&e.imageUrls.length>0?n("v-uni-view",{staticClass:"image-container-wrapper",style:e.imageStyle,attrs:{"data-src":e.imageUrls[0],"data-original-image-urls":e.originalImageUrls||e.imageUrls},on:{click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.handlePreview.apply(void 0,arguments)}}},[1===e.imageUrls.length?[n("v-uni-image",{staticClass:"post-image",attrs:{src:e.imageUrls[0],mode:"aspectFill","lazy-load":!0,"data-src":e.imageUrls[0],"data-original-image-urls":e.originalImageUrls||e.imageUrls},on:{error:function(e){arguments[0]=e=t.$handleEvent(e),t.onImageError.apply(void 0,arguments)},click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.handlePreview.apply(void 0,arguments)}}})]:e.imageUrls.length>1?[n("v-uni-swiper",{staticClass:"image-swiper",attrs:{"indicator-dots":!0,circular:!0}},[t._l(e.imageUrls,(function(r,a){return[n("v-uni-swiper-item",[n("v-uni-image",{staticClass:"post-image",attrs:{src:r,mode:"aspectFill","lazy-load":!0,"data-src":r,"data-original-image-urls":e.originalImageUrls||e.imageUrls},on:{error:function(e){arguments[0]=e=t.$handleEvent(e),t.onImageError.apply(void 0,arguments)},click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.handlePreview.apply(void 0,arguments)}}})],1)]}))],2)]:t._e()],2):t._e(),e.content?n("v-uni-view",{staticClass:"post-content",staticStyle:{"white-space":"pre-wrap"}},[t._v(t._s(e.content))]):t._e(),e.tags&&e.tags.length>0?n("v-uni-view",{staticClass:"post-tags"},t._l(e.tags,(function(e,r){return n("v-uni-text",{key:r,staticClass:"post-tag",attrs:{"data-tag":e},on:{click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.onTagClick.apply(void 0,arguments)}}},[t._v("#"+t._s(e))])})),1):t._e()],1),n("v-uni-view",{staticClass:"vote-section"},[n("v-uni-view",{staticClass:"actions-left"}),n("v-uni-view",{staticClass:"actions-right"},[n("v-uni-view",{staticClass:"action-item",attrs:{"data-postid":e._id},on:{click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.onCommentClick.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"action-emoji"},[t._v("💬")]),n("v-uni-text",{staticClass:"action-text"},[t._v(t._s(e.commentCount||0))])],1),n("v-uni-view",{staticClass:"action-item"},[n("v-uni-text",{staticClass:"action-text"},[t._v(t._s(e.votes||0))])],1)],1)],1)],1)})),1):t._e(),!t.hasMore&&t.postList.length>0?n("v-uni-view",{staticClass:"loading-more"},[n("v-uni-text",{staticClass:"loading-text"},[t._v("没有更多了")])],1):t._e()],1)],1)},i=[]},2774:function(t,e,n){n("01a2"),n("e39c"),n("bf0f"),n("844d"),n("18f7"),n("de6c"),n("08eb"),t.exports=function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports["default"]=t.exports},4550:function(t,e,n){n("6a54");var r=n("8bcf");t.exports=function(t,e,n){return e=r(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports["default"]=t.exports},"4d97":function(t,e,n){"use strict";n.r(e);var r=n("aee5"),a=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(i);e["default"]=a.a},5014:function(t,e,n){n("dc8a"),n("01a2"),n("8f71"),n("bf0f"),n("9a2c"),n("aa9c"),n("2797"),n("a644"),n("a03a"),n("6a54");var r=n("4550");function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}t.exports=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t},t.exports.__esModule=!0,t.exports["default"]=t.exports},"515a":function(t,e,n){"use strict";var r=n("b52c"),a=n.n(r);a.a},"52d1":function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var r=function(){var t=this.$createElement,e=this._self._c||t;return e("v-uni-view",{staticClass:"skeleton-wrapper"},[e("v-uni-view",{staticClass:"skeleton-poem-card"},[e("v-uni-view",{staticClass:"skeleton-original-badge skeleton-animate"}),e("v-uni-view",{staticClass:"skeleton-author-info"},[e("v-uni-view",{staticClass:"skeleton-avatar skeleton-animate"}),e("v-uni-view",{staticClass:"skeleton-name skeleton-animate"})],1),e("v-uni-view",{staticClass:"skeleton-title skeleton-animate"}),e("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate"}),e("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate"}),e("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate",staticStyle:{width:"70%"}})],1),e("v-uni-view",{staticClass:"skeleton-poem-card skeleton-secondary"},[e("v-uni-view",{staticClass:"skeleton-author-info"},[e("v-uni-view",{staticClass:"skeleton-avatar skeleton-animate"}),e("v-uni-view",{staticClass:"skeleton-name skeleton-animate"})],1),e("v-uni-view",{staticClass:"skeleton-title skeleton-animate"}),e("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate"}),e("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate",staticStyle:{width:"80%"}})],1)],1)},a=[]},"56c9":function(t,e,n){n("9e15"),n("884b"),n("01a2"),n("e39c"),n("bf0f"),n("7a76"),n("c9b5"),n("64aa");var r=n("bdbb")["default"];t.exports=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)},t.exports.__esModule=!0,t.exports["default"]=t.exports},7386:function(t,e,n){"use strict";n("6a54");var r=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.hydrateTempUrls=function(){return l.apply(this,arguments)},e.warmTempUrlsFromPosts=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=new Set;t.forEach((function(t){return s(t).forEach((function(t){return e.add(t)}))})),e.size>0&&o.default.warm(Array.from(e))};var a=r(n("2634")),i=r(n("2fdc"));n("9db6"),n("aa9c"),n("bf0f"),n("2797"),n("f3f7"),n("18f7"),n("de6c"),n("08eb"),n("fd3c");var o=r(n("c605"));function s(t){var e=[],n=function(t){"string"===typeof t&&t.startsWith("cloud://")&&e.push(t)};return n(t.imageUrl),n(t.originalImageUrl),n(t.authorAvatar),n(t.poemBgImage),Array.isArray(t.imageUrls)&&t.imageUrls.forEach(n),Array.isArray(t.originalImageUrls)&&t.originalImageUrls.forEach(n),e}function l(){return l=(0,i.default)((0,a.default)().mark((function t(){var e,n,r,i,l=arguments;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=l.length>0&&void 0!==l[0]?l[0]:[],Array.isArray(e)&&0!==e.length){t.next=3;break}return t.abrupt("return",e);case 3:if(n=new Set,e.forEach((function(t){return s(t).forEach((function(t){return n.add(t)}))})),0!==n.size){t.next=7;break}return t.abrupt("return",e);case 7:return t.next=9,o.default.getTempUrls(Array.from(n));case 9:return r=t.sent,i=function(t){return"string"===typeof t&&r[t]?r[t]:t},e.forEach((function(t){t.imageUrl&&(t.imageUrl=i(t.imageUrl)),t.originalImageUrl&&(t.originalImageUrl=i(t.originalImageUrl)),t.authorAvatar&&(t.authorAvatar=i(t.authorAvatar)),t.poemBgImage&&(t.poemBgImage=i(t.poemBgImage)),Array.isArray(t.imageUrls)&&(t.imageUrls=t.imageUrls.map(i)),Array.isArray(t.originalImageUrls)&&(t.originalImageUrls=t.originalImageUrls.map(i))})),t.abrupt("return",e);case 13:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}},"73e1":function(t,e,n){"use strict";var r=n("29d8");t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},"795c":function(t,e,n){"use strict";var r=n("8bdb"),a=n("db04").start,i=n("73e1");r({target:"String",proto:!0,forced:i},{padStart:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},"799f":function(t,e,n){"use strict";n.r(e);var r=n("8907"),a=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(i);e["default"]=a.a},8907:function(t,e,n){"use strict";n("6a54");var r=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("c223");var a=r(n("2634")),i=r(n("2fdc")),o=r(n("8cb3")),s=n("a558"),l=n("7386"),c=r(n("8cb3")),u=n("8e86"),f=u.previewImage,d=n("fcd5"),g=d.normalizePostList,p=n("11ca"),v=p.cloudCall,m=n("0efe"),h={components:{skeleton:o.default},mixins:[m],data:function(){return{tag:"",postList:[],img:""}},onLoad:function(t){var e=decodeURIComponent(t.tag||"");if(!e)return uni.showToast({title:"标签参数错误",icon:"none"}),void uni.navigateBack();this.setData({tag:e}),uni.setNavigationBarTitle({title:"#".concat(e)}),this.initPagination(this.loadTagPosts.bind(this),{pageSize:10})},methods:{callCloudFunction:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return v(t,e,Object.assign({pageTag:"tag-filter",context:this},n))},loadTagPosts:function(t){var e=this;return(0,i.default)((0,a.default)().mark((function n(){var r,i,o,c,u;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.page,i=t.isRefresh,n.prev=1,n.next=4,(0,s.getTagPosts)({tag:e.tag,page:r,pageSize:10,context:e});case 4:return o=n.sent,c=g(o||[]),n.next=8,(0,l.hydrateTempUrls)(c);case 8:return c=n.sent,(0,l.warmTempUrlsFromPosts)(c),u=0===r||i?c:e.postList.concat(c),e.setData({postList:u}),n.abrupt("return",{list:c,hasMore:c&&10===c.length});case 15:throw n.prev=15,n.t0=n["catch"](1),console.error("获取标签文章失败:",n.t0),n.t0&&n.t0.__toastShown||uni.showToast({title:"网络错误",icon:"none"}),n.t0;case 20:case"end":return n.stop()}}),n,null,[[1,15]])})))()},onPostTap:function(t){var e=t.currentTarget.dataset.postid;uni.navigateTo({url:"/pages/post-detail/post-detail?id=".concat(e)})},navigateToUserProfile:function(t){var e=t.currentTarget.dataset.userId;if(e){var n=getApp(),r=n.globalData.openid;e===r?uni.switchTab({url:"/pages/profile/profile"}):uni.navigateTo({url:"/pages/user-profile/user-profile?userId=".concat(e)})}},handlePreview:function(t){return f(t,{fallbackToast:!1})},onImageError:function(t){console.error("图片加载失败",t.detail)},onAvatarError:function(t){console.error("头像加载失败",t.detail)},onTagClick:function(t){var e=t.currentTarget.dataset.tag;console.log("点击标签:",e),uni.navigateTo({url:"/pages/tag-filter/tag-filter?tag=".concat(encodeURIComponent(e)),success:function(){console.log("跳转到标签筛选页面成功")},fail:function(t){console.error("跳转到标签筛选页面失败:",t),uni.showToast({title:"跳转失败",icon:"none"})}})},onCommentClick:function(t){var e=t.currentTarget.dataset.postid;console.log("点击评论，跳转到详情页:",e),uni.navigateTo({url:"/pages/post-detail/post-detail?id=".concat(e),success:function(){console.log("跳转到详情页成功")},fail:function(t){console.error("跳转到详情页失败:",t),uni.showToast({title:"跳转失败",icon:"none"})}})}}};e.default=h,e.default.components=Object.assign({skeleton:c.default},e.default.components||{})},"8bcf":function(t,e,n){var r=n("bdbb")["default"],a=n("56c9");t.exports=function(t){var e=a(t,"string");return"symbol"===r(e)?e:String(e)},t.exports.__esModule=!0,t.exports["default"]=t.exports},"8cb3":function(t,e,n){"use strict";n.r(e);var r=n("52d1"),a=n("4d97");for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("515a");var o=n("828b"),s=Object(o["a"])(a["default"],r["b"],r["c"],!1,null,"a51e8920",null,!1,r["a"],void 0);e["default"]=s.exports},"8e86":function(t,e,n){function r(t){if(!t)return{current:"",urls:[]};if(t.currentTarget&&t.currentTarget.dataset){var e=t.currentTarget.dataset,n=e.src||e.current||e.url||Array.isArray(e.urls)&&e.urls[0]||"",r=e.originalImageUrls||e.urls||e.urlList,a=Array.isArray(r)?r.filter(Boolean):"string"===typeof r&&r?[r]:[];return{current:n,urls:a}}var i=t.current||t.src||Array.isArray(t.urls)&&t.urls[0]||Array.isArray(t.list)&&t.list[0]||"",o=Array.isArray(t.urls)?t.urls.filter(Boolean):Array.isArray(t.list)?t.list.filter(Boolean):[];return{current:i,urls:o}}function a(t){"undefined"!==typeof uni&&uni.showToast&&uni.showToast({title:t,icon:"none"})}n("8f71"),n("bf0f"),t.exports={previewImage:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.fallbackToast,i=void 0===n||n,o=r(t);if(!o.current&&0===o.urls.length)return i&&a("图片数据缺失"),!1;var s=o.urls.length?o.urls:[o.current],l=o.current||s[0];return l&&0!==s.length?uni.previewImage({current:l,urls:s}):(i&&a("图片不可预览"),!1)}}},9376:function(t,e,n){n("7a76"),n("c9b5"),t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports["default"]=t.exports},a558:function(t,e,n){"use strict";n("6a54");var r=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.getTagPosts=function(){return u.apply(this,arguments)},e.invalidateTagPosts=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.tag,n=t.page,r=t.pageSize,a=void 0===r?10:r,i=c(e);"number"===typeof n?i.delete("page:".concat(n,":size:").concat(a)):i.clear()},n("c223");var a=r(n("2634")),i=r(n("2fdc")),o=r(n("3ab8")),s=n("11ca"),l=s.cloudCall;function c(t){var e=encodeURIComponent(String(t||""));return o.default.namespace("posts:tag:".concat(e),{persistent:!0,maxItems:128})}function u(){return u=(0,i.default)((0,a.default)().mark((function t(){var e,n,r,o,s,u,f,d,g,p=arguments;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=p.length>0&&void 0!==p[0]?p[0]:{},n=e.tag,r=e.page,o=void 0===r?0:r,s=e.pageSize,u=void 0===s?10:s,f=e.context,d=c(n),g="page:".concat(o,":size:").concat(u),t.abrupt("return",d.getOrFetch(g,(0,i.default)((0,a.default)().mark((function t(){var e;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l("getPostList",{skip:o*u,limit:u,tag:n},{pageTag:"tag:".concat(n),context:f});case 2:if(e=t.sent,!(e&&e.result&&e.result.success)){t.next=5;break}return t.abrupt("return",e.result.posts||[]);case 5:return t.abrupt("return",[]);case 6:case"end":return t.stop()}}),t)}))),{ttlMs:9e4,swrMs:45e3}));case 4:case"end":return t.stop()}}),t)}))),u.apply(this,arguments)}},aa6d:function(t,e,n){"use strict";var r=n("de3a"),a=n.n(r);a.a},aee5:function(t,e,n){"use strict";n("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={data:function(){return{}},props:{},methods:{},created:function(){}}},b52c:function(t,e,n){var r=n("ee16");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var a=n("967d").default;a("77236fde",r,!0,{sourceMap:!1,shadowMode:!1})},d189:function(t,e,n){var r=n("e2db"),a=n("2774"),i=n("79b7"),o=n("9376");t.exports=function(t){return r(t)||a(t)||i(t)||o()},t.exports.__esModule=!0,t.exports["default"]=t.exports},db04:function(t,e,n){"use strict";var r=n("bb80"),a=n("c435"),i=n("9e70"),o=n("f298"),s=n("862c"),l=r(o),c=r("".slice),u=Math.ceil,f=function(t){return function(e,n,r){var o,f,d=i(s(e)),g=a(n),p=d.length,v=void 0===r?" ":i(r);return g<=p||""===v?d:(o=g-p,f=l(v,u(o/v.length)),f.length>o&&(f=c(f,0,o)),t?d+f:f+d)}};t.exports={start:f(!1),end:f(!0)}},de3a:function(t,e,n){var r=n("15a1");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var a=n("967d").default;a("0617f774",r,!0,{sourceMap:!1,shadowMode:!1})},e2db:function(t,e,n){var r=n("e476");t.exports=function(t){if(Array.isArray(t))return r(t)},t.exports.__esModule=!0,t.exports["default"]=t.exports},ee16:function(t,e,n){var r=n("c86c");e=r(!1),e.push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* components/skeleton/skeleton.wxss */.skeleton-wrapper[data-v-a51e8920]{width:100%;height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:%?20?%;box-sizing:border-box}\n/* 读诗页骨架屏卡片样式 - 匹配读诗页设计 */.skeleton-poem-card[data-v-a51e8920]{width:calc(100% - %?40?%);height:calc(100% - %?80?%);display:flex;flex-direction:column;padding:%?40?% %?20?%;box-sizing:border-box;background:hsla(0,0%,100%,.95);margin:%?40?% %?20?%;border-radius:%?24?%;box-shadow:0 %?8?% %?32?% rgba(0,0,0,.1);position:relative}\n/* 第二个卡片透明度降低 */.skeleton-poem-card.skeleton-secondary[data-v-a51e8920]{opacity:.6;position:absolute;top:%?20?%;left:%?20?%;right:%?20?%;bottom:%?20?%;z-index:-1;-webkit-transform:scale(.95);transform:scale(.95)}\n/* 原创标识骨架 */.skeleton-original-badge[data-v-a51e8920]{position:absolute;top:%?20?%;right:%?20?%;width:%?80?%;height:%?40?%;border-radius:%?20?%}\n/* 作者信息骨架 */.skeleton-author-info[data-v-a51e8920]{display:flex;align-items:center;margin-bottom:%?15?%;padding-bottom:%?10?%}.skeleton-avatar[data-v-a51e8920]{width:%?80?%;height:%?80?%;border-radius:50%;margin-right:%?20?%}.skeleton-name[data-v-a51e8920]{width:%?200?%;height:%?32?%;border-radius:%?16?%}\n/* 居中标题骨架 */.skeleton-title[data-v-a51e8920]{width:60%;height:%?40?%;margin:0 auto %?20?% auto; /* 居中并增加下边距 */border-radius:%?20?%;text-align:center}\n/* 大内容区域骨架 */.skeleton-content-large[data-v-a51e8920]{width:100%;height:%?40?%;margin-bottom:%?20?%;border-radius:%?20?%}.skeleton-animate[data-v-a51e8920]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0 50%,#f0f0f0 75%);background-size:200% 100%;-webkit-animation:skeleton-loading-data-v-a51e8920 1.5s infinite linear;animation:skeleton-loading-data-v-a51e8920 1.5s infinite linear}@-webkit-keyframes skeleton-loading-data-v-a51e8920{0%{background-position:200% 0}100%{background-position:-200% 0}}@keyframes skeleton-loading-data-v-a51e8920{0%{background-position:200% 0}100%{background-position:-200% 0}}",""]),t.exports=e},fcd5:function(t,e,n){var r=n("5014").default,a=n("d189").default,i=n("4cf1").default;n("8f71"),n("bf0f"),n("aa9c"),n("fd3c");var o=n("139b"),s=o.formatRelativeTime,l=["createTime","postCreateTime","publishTime","createdAt","updateTime"],c=function(t){return t?Array.isArray(t)?t.filter(Boolean):[t].filter(Boolean):[]},u=function(t){var e,n=i(l);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(t[r])return{key:r,value:t[r]}}}catch(a){n.e(a)}finally{n.f()}return null},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.withTime,i=void 0===n||n,o=c(t.imageUrls);0===o.length&&o.push.apply(o,a(c(t.imageUrl)));var l=c(t.originalImageUrls);0===l.length&&l.push.apply(l,a(c(t.originalImageUrl))),0===l.length&&o.length>0&&l.push.apply(l,a(o));var f=r(r({},t),{},{imageUrls:o,originalImageUrls:l,authorName:t.authorName||"匿名用户",authorAvatar:"string"===typeof t.authorAvatar?t.authorAvatar:""});if(!f.imageStyle&&o.length>0&&(f.imageStyle="height: 0; padding-bottom: 75%;"),i)if(t.formattedCreateTime)f.formattedCreateTime=t.formattedCreateTime;else{var d=u(t);d&&(f.formattedCreateTime=s(d.value))}return f};t.exports={normalizePost:f,normalizePostList:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Array.isArray(t)?t.map((function(t){return f(t,e)})):[]}}}}]);