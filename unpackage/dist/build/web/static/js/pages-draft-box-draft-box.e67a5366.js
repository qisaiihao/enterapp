(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-draft-box-draft-box"],{"01ae":function(t,n,r){"use strict";r.r(n);var e=r("284f"),a=r("19a7");for(var i in a)["default"].indexOf(i)<0&&function(t){r.d(n,t,(function(){return a[t]}))}(i);r("eb53");var o=r("828b"),s=Object(o["a"])(a["default"],e["b"],e["c"],!1,null,"ba2c68f0",null,!1,e["a"],void 0);n["default"]=s.exports},"139b":function(t,n,r){r("795c"),r("64aa"),r("5c47"),r("a1c1"),r("c223"),r("f7a5");var e=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(t).padStart(n,"0")},a=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd HH:mm:ss",r=t instanceof Date?t:new Date(t);if(Number.isNaN(r.getTime()))return"";var a={yyyy:String(r.getFullYear()),MM:e(r.getMonth()+1),dd:e(r.getDate()),HH:e(r.getHours()),mm:e(r.getMinutes()),ss:e(r.getSeconds())};return n.replace(/yyyy|MM|dd|HH|mm|ss/g,(function(t){return a[t]}))};t.exports={formatTimeAgo:function(t){var n=new Date,r=new Date(t),e=n.getTime()-r.getTime(),a=Math.floor(e/1e3),i=Math.floor(a/60),o=Math.floor(i/60),s=Math.floor(o/24);if(s>=7){var c=r.getFullYear(),d=("0"+(r.getMonth()+1)).slice(-2),f=("0"+r.getDate()).slice(-2);return"".concat(c,"-").concat(d,"-").concat(f)}return s>=1?"".concat(s,"天前"):o>=1?"".concat(o,"小时前"):i>=1?"".concat(i,"分钟前"):"刚刚"},formatRelativeTime:function(t){var n=Date.now(),r=t instanceof Date?t.getTime():new Date(t).getTime();if(Number.isNaN(r))return"";var e=n-r,i=Math.floor(Math.abs(e)/1e3),o=e>=0?"前":"后";if(i<60)return"刚刚";var s=Math.floor(i/60);if(s<60)return"".concat(s,"分钟").concat(o);var c=Math.floor(s/60);if(c<24)return"".concat(c,"小时").concat(o);var d=Math.floor(c/24);return d<7?"".concat(d,"天").concat(o):a(r,"yyyy-MM-dd")},formatDate:a}},"19a7":function(t,n,r){"use strict";r.r(n);var e=r("30f0"),a=r.n(e);for(var i in e)["default"].indexOf(i)<0&&function(t){r.d(n,t,(function(){return e[t]}))}(i);n["default"]=a.a},2704:function(t,n,r){var e=r("c86c");n=e(!1),n.push([t.i,"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* pages/draft-box/draft-box.wxss */.container[data-v-ba2c68f0]{padding:%?20?%;background-color:#f7f8fa;min-height:100vh}.draft-list[data-v-ba2c68f0]{display:flex;flex-direction:column;gap:%?20?%}.draft-item[data-v-ba2c68f0]{background:#fff;border-radius:%?16?%;padding:%?30?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05);display:flex;justify-content:space-between;align-items:flex-start;transition:all .2s ease}.draft-item[data-v-ba2c68f0]:active{-webkit-transform:scale(.98);transform:scale(.98);box-shadow:0 %?2?% %?8?% rgba(0,0,0,.1)}.draft-content[data-v-ba2c68f0]{flex:1;margin-right:%?20?%}.draft-title[data-v-ba2c68f0]{font-size:%?32?%;font-weight:600;color:#333;margin-bottom:%?10?%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.draft-preview[data-v-ba2c68f0]{font-size:%?28?%;color:#666;line-height:1.5;margin-bottom:%?15?%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical}.draft-meta[data-v-ba2c68f0]{display:flex;align-items:center;gap:%?20?%;font-size:%?24?%;color:#999}.draft-time[data-v-ba2c68f0]{flex-shrink:0}.draft-mode[data-v-ba2c68f0]{background:#e3f2fd;color:#1976d2;padding:%?4?% %?12?%;border-radius:%?12?%;font-size:%?22?%}.draft-original[data-v-ba2c68f0]{background:#e8f5e8;color:#4caf50;padding:%?4?% %?12?%;border-radius:%?12?%;font-size:%?22?%}.draft-actions[data-v-ba2c68f0]{display:flex;flex-direction:column;gap:%?10?%;flex-shrink:0}.action-btn[data-v-ba2c68f0]{min-width:%?120?%;height:%?60?%;line-height:%?60?%;border-radius:%?8?%;font-size:%?24?%;border:none;transition:all .2s ease}.edit-btn[data-v-ba2c68f0]{background:#9ed7ee;color:#fff}.edit-btn[data-v-ba2c68f0]:active{background:#06ad56}.delete-btn[data-v-ba2c68f0]{background:#ff4d4f;color:#fff}.delete-btn[data-v-ba2c68f0]:active{background:#d9363e}\r\n/* 空状态样式 */.empty-container[data-v-ba2c68f0]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:%?200?% %?40?%;text-align:center}.empty-icon[data-v-ba2c68f0]{font-size:%?120?%;margin-bottom:%?30?%;opacity:.6}.empty-text[data-v-ba2c68f0]{font-size:%?32?%;color:#666;margin-bottom:%?15?%}.empty-subtext[data-v-ba2c68f0]{font-size:%?28?%;color:#999;margin-bottom:%?40?%}.create-btn[data-v-ba2c68f0]{background:#9ed7ee;color:#fff;border:none;border-radius:%?50?%;padding:%?20?% %?40?%;font-size:%?28?%;transition:all .2s ease}.create-btn[data-v-ba2c68f0]:active{background:#06ad56;-webkit-transform:scale(.95);transform:scale(.95)}",""]),t.exports=n},"284f":function(t,n,r){"use strict";r.d(n,"b",(function(){return e})),r.d(n,"c",(function(){return a})),r.d(n,"a",(function(){}));var e=function(){var t=this,n=t.$createElement,r=t._self._c||n;return r("v-uni-view",{staticClass:"container"},[t.drafts.length>0?r("v-uni-view",{staticClass:"draft-list"},t._l(t.drafts,(function(n,e){return r("v-uni-view",{key:e,staticClass:"draft-item",attrs:{"data-draft":n},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.editDraft.apply(void 0,arguments)}}},[r("v-uni-view",{staticClass:"draft-content"},[r("v-uni-view",{staticClass:"draft-title"},[t._v(t._s(n.title||"无标题"))]),r("v-uni-view",{staticClass:"draft-preview"},[t._v(t._s(n.content||"无内容"))]),r("v-uni-view",{staticClass:"draft-meta"},[r("v-uni-text",{staticClass:"draft-time"},[t._v(t._s(n.formattedSaveTime))]),r("v-uni-text",{staticClass:"draft-mode"},[t._v(t._s("poem"===n.publishMode?"诗歌":"普通"))]),n.isOriginal?r("v-uni-text",{staticClass:"draft-original"},[t._v("原创")]):t._e()],1)],1),r("v-uni-view",{staticClass:"draft-actions"},[r("v-uni-button",{staticClass:"action-btn edit-btn",attrs:{size:"mini","data-draft":n},on:{click:function(n){n.stopPropagation(),n.preventDefault(),arguments[0]=n=t.$handleEvent(n),t.editDraft.apply(void 0,arguments)}}},[t._v("编辑")]),r("v-uni-button",{staticClass:"action-btn delete-btn",attrs:{size:"mini","data-draft-id":n._id},on:{click:function(n){n.stopPropagation(),n.preventDefault(),arguments[0]=n=t.$handleEvent(n),t.deleteDraft.apply(void 0,arguments)}}},[t._v("删除")])],1)],1)})),1):r("v-uni-view",{staticClass:"empty-container"},[r("v-uni-view",{staticClass:"empty-icon"},[t._v("📝")]),r("v-uni-view",{staticClass:"empty-text"},[t._v("草稿箱是空的")]),r("v-uni-view",{staticClass:"empty-subtext"},[t._v("去发布一些内容吧")]),r("v-uni-button",{staticClass:"create-btn",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.goToPublish.apply(void 0,arguments)}}},[t._v("开始创作")])],1)],1)},a=[]},"30f0":function(t,n,r){"use strict";r("6a54");var e=r("f5bd").default;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=e(r("9b1b"));r("fd3c");var i=r("139b"),o=i.formatRelativeTime,s=i.formatDate,c=r("11ca"),d=c.cloudCall,f={data:function(){return{drafts:[],isLoading:!0}},onLoad:function(){this.loadDrafts()},onShow:function(){this.loadDrafts()},methods:{callCloudFunction:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return d(t,n,Object.assign({pageTag:"draft-box",context:this,requireAuth:!0},r))},loadDrafts:function(){var t=this;this.setData({isLoading:!0});var n=this.$requireOpenid&&this.$requireOpenid();n?this.callCloudFunction("getMyProfileData",{action:"getDrafts",openid:n}).then((function(n){if(console.log("获取草稿列表结果:",n),n.result&&n.result.success){var r=n.result.drafts||[],e=r.map((function(t){return(0,a.default)((0,a.default)({},t),{},{formattedSaveTime:o(t.saveTime)||s(t.saveTime,"yyyy-MM-dd HH:mm")})}));t.setData({drafts:e,isLoading:!1})}else console.error("获取草稿失败:",n.result),t.setData({isLoading:!1}),uni.showToast({title:"加载草稿失败",icon:"none"})})).catch((function(n){console.error("获取草稿失败:",n),t.setData({isLoading:!1}),uni.showToast({title:"网络错误",icon:"none"})})):this.setData({isLoading:!1})},editDraft:function(t){var n=t.currentTarget.dataset.draft;if(n)try{uni.setStorageSync("editing_draft",n),uni.navigateTo({url:"/pages/add/add?mode=edit"})}catch(r){console.log("CatchClause",r),console.log("CatchClause",r),console.error("存储草稿数据失败:",r),uni.showToast({title:"打开草稿失败",icon:"none"})}},deleteDraft:function(t){var n=this,r=t.currentTarget.dataset.draftId;r&&uni.showModal({title:"删除草稿",content:"确定要删除这个草稿吗？",confirmColor:"#ff4d4f",success:function(t){if(t.confirm){var e=n.$requireOpenid&&n.$requireOpenid();e&&(uni.showLoading({title:"删除中..."}),n.callCloudFunction("getMyProfileData",{action:"deleteDraft",draftId:r,openid:e}).then((function(t){var r;(uni.hideLoading(),t.result&&t.result.success)?(uni.showToast({title:"删除成功",icon:"success"}),n.loadDrafts()):uni.showToast({title:(null===(r=t.result)||void 0===r?void 0:r.message)||"删除失败",icon:"none"})})).catch((function(t){uni.hideLoading(),console.error("删除草稿失败:",t),uni.showToast({title:"删除失败",icon:"none"})})))}}})},goToPublish:function(){uni.navigateTo({url:"/pages/add/add"})},formatTime:function(t){return o(t)||s(t,"yyyy-MM-dd HH:mm")}}};n.default=f},"32a8":function(t,n,r){var e=r("2704");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var a=r("967d").default;a("42fc02a0",e,!0,{sourceMap:!1,shadowMode:!1})},"73e1":function(t,n,r){"use strict";var e=r("29d8");t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(e)},"795c":function(t,n,r){"use strict";var e=r("8bdb"),a=r("db04").start,i=r("73e1");e({target:"String",proto:!0,forced:i},{padStart:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},"967d":function(t,n,r){"use strict";function e(t,n){for(var r=[],e={},a=0;a<n.length;a++){var i=n[a],o=i[0],s=i[1],c=i[2],d=i[3],f={id:t+":"+a,css:s,media:c,sourceMap:d};e[o]?e[o].parts.push(f):r.push(e[o]={id:o,parts:[f]})}return r}r.r(n),r.d(n,"default",(function(){return v}));var a="undefined"!==typeof document;if("undefined"!==typeof DEBUG&&DEBUG&&!a)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},o=a&&(document.head||document.getElementsByTagName("head")[0]),s=null,c=0,d=!1,f=function(){},u=null,l="undefined"!==typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function v(t,n,r,a){d=r,u=a||{};var o=e(t,n);return p(o),function(n){for(var r=[],a=0;a<o.length;a++){var s=o[a],c=i[s.id];c.refs--,r.push(c)}n?(o=e(t,n),p(o)):o=[];for(a=0;a<r.length;a++){c=r[a];if(0===c.refs){for(var d=0;d<c.parts.length;d++)c.parts[d]();delete i[c.id]}}}}function p(t){for(var n=0;n<t.length;n++){var r=t[n],e=i[r.id];if(e){e.refs++;for(var a=0;a<e.parts.length;a++)e.parts[a](r.parts[a]);for(;a<r.parts.length;a++)e.parts.push(b(r.parts[a]));e.parts.length>r.parts.length&&(e.parts.length=r.parts.length)}else{var o=[];for(a=0;a<r.parts.length;a++)o.push(b(r.parts[a]));i[r.id]={id:r.id,refs:1,parts:o}}}}function g(){var t=document.createElement("style");return t.type="text/css",o.appendChild(t),t}function b(t){var n,r,e=document.querySelector('style[data-vue-ssr-id~="'+t.id+'"]');if(e){if(d)return f;e.parentNode.removeChild(e)}if(l){var a=c++;e=s||(s=g()),n=m.bind(null,e,a,!1),r=m.bind(null,e,a,!0)}else e=g(),n=y.bind(null,e),r=function(){e.parentNode.removeChild(e)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else r()}}var h=function(){var t=[];return function(n,r){return t[n]=r,t.filter(Boolean).join("\n")}}();function m(t,n,r,e){var a=r?"":$(e.css);if(t.styleSheet)t.styleSheet.cssText=h(n,a);else{var i=document.createTextNode(a),o=t.childNodes;o[n]&&t.removeChild(o[n]),o.length?t.insertBefore(i,o[n]):t.appendChild(i)}}function y(t,n){var r=$(n.css),e=n.media,a=n.sourceMap;if(e&&t.setAttribute("media",e),u.ssrId&&t.setAttribute("data-vue-ssr-id",n.id),a&&(r+="\n/*# sourceURL="+a.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),t.styleSheet)t.styleSheet.cssText=r;else{while(t.firstChild)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var w=/%\?([+-]?\d+(\.\d+)?)\?%/g,x=/\.\?%PAGE\?%/g,M=/\?%PAGE\?%\[data-v-[a-z0-9]{8}\]/g,C=/uni-page-body\[data-v-[a-z0-9]{8}\]/g,D=/var\(--status-bar-height\)/gi,T=/var\(--window-top\)/gi,k=/var\(--window-bottom\)/gi,_=/var\(--window-left\)/gi,S=/var\(--window-right\)/gi;function $(t){var n=function(){var t="function"===typeof getApp&&getApp();return t&&t.$route&&t.$route.meta&&t.$route.meta.name||""}();if("undefined"!==typeof uni&&!uni.canIUse("css.var")){var r=function(){var t="function"===typeof getApp&&getApp();if(t&&t.$route&&t.$route.meta&&t.$route.meta.name)return{top:t.$route.meta.windowTop,bottom:t.$route.meta.isTabBar?50:0};return{top:0,bottom:0}}();t=t.replace(D,"0px").replace(T,r.top+"px").replace(k,r.bottom+"px").replace(_,"0px").replace(S,"0px")}return t.replace(M,n).replace(x,"").replace(C,"body."+n+" uni-page-body").replace(/\{[\s\S]+?\}|@media.+?\{/g,(function(t){return"undefined"===typeof uni?t:t.replace(w,(function(t,n){return uni.upx2px(n)+"px"}))}))}},c86c:function(t,n,r){"use strict";t.exports=function(t){var n=[];return n.toString=function(){return this.map((function(n){var r=function(t,n){var r=t[1]||"",e=t[3];if(!e)return r;if(n&&"function"===typeof btoa){var a=function(t){var n=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n);return"/*# ".concat(r," */")}(e),i=e.sources.map((function(t){return"/*# sourceURL=".concat(e.sourceRoot||"").concat(t," */")}));return[r].concat(i).concat([a]).join("\n")}return[r].join("\n")}(n,t);return n[2]?"@media ".concat(n[2]," {").concat(r,"}"):r})).join("")},n.i=function(t,r,e){"string"===typeof t&&(t=[[null,t,""]]);var a={};if(e)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(a[o]=!0)}for(var s=0;s<t.length;s++){var c=[].concat(t[s]);e&&a[c[0]]||(r&&(c[2]?c[2]="".concat(r," and ").concat(c[2]):c[2]=r),n.push(c))}},n}},db04:function(t,n,r){"use strict";var e=r("bb80"),a=r("c435"),i=r("9e70"),o=r("f298"),s=r("862c"),c=e(o),d=e("".slice),f=Math.ceil,u=function(t){return function(n,r,e){var o,u,l=i(s(n)),v=a(r),p=l.length,g=void 0===e?" ":i(e);return v<=p||""===g?l:(o=v-p,u=c(g,f(o/g.length)),u.length>o&&(u=d(u,0,o)),t?l+u:u+l)}};t.exports={start:u(!1),end:u(!0)}},eb53:function(t,n,r){"use strict";var e=r("32a8"),a=r.n(e);a.a}}]);