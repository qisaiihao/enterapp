(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-splash-splash"],{1963:function(e,t,a){"use strict";var r=a("1ed5"),n=a.n(r);n.a},"1ed5":function(e,t,a){var r=a("2223");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var n=a("967d").default;n("1b56a28e",r,!0,{sourceMap:!1,shadowMode:!1})},2223:function(e,t,a){var r=a("c86c");t=r(!1),t.push([e.i,"uni-page-body[data-v-0ab7b3b2]{margin:0;padding:0;height:100vh;overflow:hidden}.container[data-v-0ab7b3b2]{width:100vw;height:100vh;background-color:#fff;color:#000;display:flex;justify-content:center;align-items:center}\r\n\r\n/* ---- 阶段一：打字机 ---- */.typing-phase-container[data-v-0ab7b3b2]{position:relative;width:100%;height:100vh}\r\n\r\n/* ---- 文字层：固定高度，预留光标空间 ---- */.text-layer[data-v-0ab7b3b2]{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;min-height:%?120?% /* 预留足够空间给光标 */}.typewriter-effect[data-v-0ab7b3b2]{font-family:monospace;font-size:%?48?%;display:flex;align-items:center}.blinking-cursor[data-v-0ab7b3b2]{width:%?4?%;height:%?48?%;background-color:#000;margin-left:%?10?%;-webkit-animation:blink-data-v-0ab7b3b2 1s steps(1) infinite;animation:blink-data-v-0ab7b3b2 1s steps(1) infinite}.blinking-cursor.hidden[data-v-0ab7b3b2]{opacity:0!important;-webkit-animation:none!important;animation:none!important}@-webkit-keyframes blink-data-v-0ab7b3b2{50%{opacity:0}}@keyframes blink-data-v-0ab7b3b2{50%{opacity:0}}\r\n\r\n/* ---- 按钮层：独立定位 ---- */.enter-key-container[data-v-0ab7b3b2]{position:absolute;bottom:%?50?%;right:%?20?%;cursor:pointer;-webkit-animation:slideInUp-data-v-0ab7b3b2 .8s ease-out;animation:slideInUp-data-v-0ab7b3b2 .8s ease-out;transition:all .2s ease;width:%?640?%;height:%?400?%;padding:%?20?%;box-sizing:border-box}.enter-key-container[data-v-0ab7b3b2]:active{-webkit-transform:scale(.95);transform:scale(.95)}.enter-key-container.loading[data-v-0ab7b3b2]{opacity:.6;cursor:not-allowed}.enter-key-container.loading[data-v-0ab7b3b2]:active{-webkit-transform:scale(1);transform:scale(1)}.enter-key-image[data-v-0ab7b3b2]{width:100%;height:100%;display:block}\r\n\r\n/* L形回车键主体 */.enter-key-l-shape[data-v-0ab7b3b2]{position:relative;width:100%;height:100%}\r\n\r\n/* 横向部分 - 较长 */.enter-key-horizontal[data-v-0ab7b3b2]{position:absolute;top:0;left:%?50?%;right:0;height:%?50?%;background-color:#f5f5f5;border:%?2?% solid #ddd;border-radius:%?6?%;display:flex;align-items:center;justify-content:center;padding:0 %?12?%;z-index:2;box-sizing:border-box}\r\n\r\n/* 纵向部分 - 较短 */.enter-key-vertical[data-v-0ab7b3b2]{position:absolute;top:%?48?%;  /* 与横向部分底部对齐（50rpx - 2rpx边框） */left:0;width:%?52?%;  /* 与横向部分左侧对齐（50rpx + 2rpx边框） */height:%?52?%;  /* 总高度100rpx - 横向高度50rpx + 边框调整 */background-color:#f5f5f5;border:%?2?% solid #ddd;border-radius:%?6?%;z-index:1;box-sizing:border-box}\r\n\r\n/* 确保连接处没有重叠或间隙 */.enter-key-horizontal[data-v-0ab7b3b2]{border-left:none;  /* 移除横向部分的左边框，让两部分无缝连接 */border-top-left-radius:0;border-bottom-left-radius:0}.enter-key-vertical[data-v-0ab7b3b2]{border-top:none;  /* 移除纵向部分的上边框，让两部分无缝连接 */border-top-left-radius:0;border-top-right-radius:0}.enter-key-arrow[data-v-0ab7b3b2]{font-size:%?28?%;font-weight:700;color:#333;margin-right:%?6?%}.enter-key-label[data-v-0ab7b3b2]{font-size:%?20?%;font-weight:500;color:#333;text-transform:lowercase;letter-spacing:%?1?%}\r\n\r\n/* 悬浮和点击效果 */.enter-key-container:hover .enter-key-horizontal[data-v-0ab7b3b2],\r\n.enter-key-container:hover .enter-key-vertical[data-v-0ab7b3b2]{background-color:#e8e8e8;border-color:#ccc}.enter-key-container:active .enter-key-horizontal[data-v-0ab7b3b2],\r\n.enter-key-container:active .enter-key-vertical[data-v-0ab7b3b2]{background-color:#d0d0d0;border-color:#bbb}\r\n\r\n/* ——— Override: hide legacy pieces to avoid ghosts ——— */\r\n\r\n/* New L-key layers */.ek-layer[data-v-0ab7b3b2]{display:none!important}\r\n\r\n/* ---- 换行后的光标 ---- */.new-line-cursor-container[data-v-0ab7b3b2]{display:flex;justify-content:center;align-items:center;margin-top:%?20?%}.new-line-cursor[data-v-0ab7b3b2]{width:%?4?%;height:%?48?%;background-color:#000;-webkit-animation:blink-data-v-0ab7b3b2 1s steps(1) infinite;animation:blink-data-v-0ab7b3b2 1s steps(1) infinite}@-webkit-keyframes slideInUp-data-v-0ab7b3b2{from{opacity:0;-webkit-transform:translateX(%?60?%) translateY(%?60?%);transform:translateX(%?60?%) translateY(%?60?%)}to{opacity:1;-webkit-transform:translateX(0) translateY(0);transform:translateX(0) translateY(0)}}@keyframes slideInUp-data-v-0ab7b3b2{from{opacity:0;-webkit-transform:translateX(%?60?%) translateY(%?60?%);transform:translateX(%?60?%) translateY(%?60?%)}to{opacity:1;-webkit-transform:translateX(0) translateY(0);transform:translateX(0) translateY(0)}}\r\n\r\n/* ---- 阶段二：开屏图 ---- */.image-phase-container[data-v-0ab7b3b2]{width:100%;height:100%;-webkit-animation:fadeIn-data-v-0ab7b3b2 .8s ease-in-out;animation:fadeIn-data-v-0ab7b3b2 .8s ease-in-out}.splash-image[data-v-0ab7b3b2]{width:100%;height:100%;object-fit:cover}@-webkit-keyframes fadeIn-data-v-0ab7b3b2{from{opacity:0}to{opacity:1}}@keyframes fadeIn-data-v-0ab7b3b2{from{opacity:0}to{opacity:1}}\r\n\r\n/* ---- 原有的样式（保留作为备用） ---- */.splash-container[data-v-0ab7b3b2]{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;margin:0;padding:0;overflow:hidden;background-color:#000;opacity:1;transition:opacity .8s ease-in-out}.splash-container.fade-out[data-v-0ab7b3b2]{opacity:0}.splash-image.zoom-out[data-v-0ab7b3b2]{-webkit-transform:scale(1.1);transform:scale(1.1)}.loading-indicator[data-v-0ab7b3b2]{position:absolute;bottom:%?100?%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);color:hsla(0,0%,100%,.8);font-size:%?28?%;z-index:10}.ek-layer[data-v-0ab7b3b2]{display:none!important}\r\n\r\n/* 平面风回车键统一描边 */.enter-key-l-shape[data-v-0ab7b3b2]{position:relative;width:100%;height:100%}.enter-key-horizontal[data-v-0ab7b3b2]{position:absolute;top:0;left:%?64?%;right:0;height:%?96?%;background:#fff;border:%?4?% solid #333;border-left:none;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:%?22?%;border-bottom-right-radius:%?22?%;box-sizing:border-box}.enter-key-vertical[data-v-0ab7b3b2]{position:absolute;top:%?92?%;left:0;width:%?64?%;height:%?68?%;background:#fff;border:%?4?% solid #333;border-top:none;border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:%?22?%;border-bottom-right-radius:%?22?%;box-sizing:border-box}.enter-key-label[data-v-0ab7b3b2]{position:absolute;left:%?22?%;bottom:%?18?%;font-size:%?24?%;color:#333;font-weight:500}.enter-key-arrow[data-v-0ab7b3b2]{position:absolute;right:%?22?%;bottom:%?18?%;font-size:%?26?%;color:#333;font-weight:700}",""]),e.exports=t},4550:function(e,t,a){a("6a54");var r=a("8bcf");e.exports=function(e,t,a){return t=r(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e},e.exports.__esModule=!0,e.exports["default"]=e.exports},"4db6":function(e,t,a){a("6a54");var r=a("8bcf");function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}e.exports=function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports["default"]=e.exports},5014:function(e,t,a){a("dc8a"),a("01a2"),a("8f71"),a("bf0f"),a("9a2c"),a("aa9c"),a("2797"),a("a644"),a("a03a"),a("6a54");var r=a("4550");function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}e.exports=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e},e.exports.__esModule=!0,e.exports["default"]=e.exports},"56c9":function(e,t,a){a("9e15"),a("884b"),a("01a2"),a("e39c"),a("bf0f"),a("7a76"),a("c9b5"),a("64aa");var r=a("bdbb")["default"];e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports},7210:function(e,t,a){var r=a("dd7e").default,n=a("5014").default,o=a("46c5").default,i=a("883d").default,s=a("4db6").default;a("c223"),a("7a76"),a("c9b5"),a("fd3c"),a("bf0f"),a("18f7"),a("de6c");var l=a("38db"),c=l.cloudCall,u=function(){"use strict";function e(){i(this,e),this.cloudEnv=wx.cloud}return s(e,[{key:"callCloudFunction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(e,t,{pageTag:"imageManager-util",requireAuth:!0})}},{key:"uploadImage",value:function(){var e=o(r().mark((function e(t){var a,o,i,s,l,c,u,d=arguments;return r().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=d.length>1&&void 0!==d[1]?d[1]:{},e.prev=1,o=uni.getFileSystemManager(),i=o.readFileSync(t,"base64"),s=Date.now(),l=t&&"string"===typeof t&&t.split(".").pop()||"png",c=a.name?"".concat(a.name,"_").concat(s,".").concat(l):"image_".concat(s,".").concat(l),console.log("准备调用云函数上传，参数:",{action:"uploadImage",cloudPath:c,category:a.category||"general",fileContentLength:i.length}),e.next=10,this.callCloudFunction("imageManager",{action:"uploadImage",fileContent:i,cloudPath:c,category:a.category||"general",metadata:n({name:a.name||"",originalPath:t},a.metadata)});case 10:if(u=e.sent,console.log("云函数返回结果:",u),!u.result.success){e.next=16;break}return e.abrupt("return",{success:!0,fileID:u.result.fileID,imageId:u.result.imageId,url:u.result.url});case 16:throw new Error(u.result.error||"上传失败");case 17:e.next=25;break;case 19:return e.prev=19,e.t0=e["catch"](1),console.log("CatchClause",e.t0),console.log("CatchClause",e.t0),console.error("图片上传失败:",e.t0),e.abrupt("return",{success:!1,error:e.t0.message});case 25:case"end":return e.stop()}}),e,this,[[1,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getImageUrl",value:function(){var e=o(r().mark((function e(){var t,a,o=arguments;return r().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},e.prev=1,e.next=4,this.callCloudFunction("imageManager",n({action:"getImageUrl"},t));case 4:if(a=e.sent,!a.result.success){e.next=9;break}return e.abrupt("return",{success:!0,url:a.result.url,fileID:a.result.fileID,expireTime:a.result.expireTime});case 9:throw new Error(a.result.error||"获取URL失败");case 10:e.next=18;break;case 12:return e.prev=12,e.t0=e["catch"](1),console.log("CatchClause",e.t0),console.log("CatchClause",e.t0),console.error("获取图片URL失败:",e.t0),e.abrupt("return",{success:!1,error:e.t0.message});case 18:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"getSplashImageUrl",value:function(){var e=o(r().mark((function e(){var t;return r().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getImageUrl({category:"splash",name:"splash"});case 2:if(t=e.sent,!t.success){e.next=7;break}return e.abrupt("return",t.url);case 7:return e.abrupt("return","/static/images/splash.png");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"uploadSplashImage",value:function(){var e=o(r().mark((function e(t){return r().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.uploadImage(t,{category:"splash",name:"splash",metadata:{description:"开屏图",usage:"splash_screen"}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"preloadImages",value:function(){var e=o(r().mark((function e(t){var a;return r().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.map((function(e){return new Promise((function(t){uni.downloadFile({url:e,success:function(a){200===a.statusCode?t({success:!0,tempFilePath:a.tempFilePath,url:e}):t({success:!1,error:"下载失败",url:e})},fail:function(a){t({success:!1,error:a.errMsg,url:e})}})}))})),e.next=3,Promise.all(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteImage",value:function(){var e=o(r().mark((function e(){var t,a,o=arguments;return r().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},e.prev=1,e.next=4,this.callCloudFunction("imageManager",n({action:"deleteImage"},t));case 4:return a=e.sent,e.abrupt("return",a.result);case 8:return e.prev=8,e.t0=e["catch"](1),console.log("CatchClause",e.t0),console.log("CatchClause",e.t0),console.error("删除图片失败:",e.t0),e.abrupt("return",{success:!1,error:e.t0.message});case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"getImageList",value:function(){var e=o(r().mark((function e(){var t,a,o=arguments;return r().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},e.prev=1,e.next=4,this.callCloudFunction("imageManager",n({action:"getImageList"},t));case 4:return a=e.sent,e.abrupt("return",a.result);case 8:return e.prev=8,e.t0=e["catch"](1),console.log("CatchClause",e.t0),console.log("CatchClause",e.t0),console.error("获取图片列表失败:",e.t0),e.abrupt("return",{success:!1,error:e.t0.message});case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),d=new u;e.exports={ImageManager:u,imageManager:d}},"883d":function(e,t,a){a("7a76"),a("c9b5"),e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports["default"]=e.exports},"8b88":function(e,t,a){"use strict";a.r(t);var r=a("eba4"),n=a.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(o);t["default"]=n.a},"8bcf":function(e,t,a){var r=a("bdbb")["default"],n=a("56c9");e.exports=function(e){var t=n(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports["default"]=e.exports},cbc5:function(e,t,a){"use strict";a.r(t);var r=a("dd4f"),n=a("8b88");for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);a("1963");var i=a("828b"),s=Object(i["a"])(n["default"],r["b"],r["c"],!1,null,"0ab7b3b2",null,!1,r["a"],void 0);t["default"]=s.exports},dd4f:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){}));var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"container"},["typing"===e.currentPhase?a("v-uni-view",{staticClass:"typing-phase-container"},[a("v-uni-view",{staticClass:"text-layer"},[a("v-uni-view",{staticClass:"typewriter-effect"},[a("v-uni-text",[e._v(e._s(e.typedText))]),a("v-uni-view",{class:"blinking-cursor "+(e.showNewLineCursor?"hidden":"")})],1),e.showNewLineCursor?a("v-uni-view",{staticClass:"new-line-cursor-container"},[a("v-uni-view",{staticClass:"new-line-cursor"})],1):e._e()],1),e.showEnterButton?a("v-uni-view",{class:"enter-key-container "+(e.preloadCompleted?"":"loading"),on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleEnterButtonClick.apply(void 0,arguments)}}},[a("v-uni-image",{staticClass:"enter-key-image",attrs:{src:(e.preloadCompleted,"/static/images/enter_key.png"),mode:"aspectFit"}})],1):e._e()],1):e._e(),e.isPreloading?a("v-uni-view",{staticClass:"loading-indicator"},[e._v("正在加载内容...")]):e._e()],1)},n=[]},eba4:function(e,t,a){"use strict";a("6a54");var r=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bf0f"),a("18f7"),a("de6c"),a("aa9c"),a("5ef2"),a("5c47"),a("0506"),a("9db6");var n=r(a("2634")),o=r(a("2fdc")),i=a("7210"),s=(i.imageManager,a("38db")),l=s.cloudCall,c={data:function(){return{currentPhase:"typing",showEnterButton:!1,showNewLineCursor:!1,textMoveUp:!1,preloadCompleted:!1,fullText:"poementer",typedText:"",preloadedImagePath:"",preloadProgress:0,isPreloading:!1,splashImageUrl:"/static/images/splash.png",fadeOut:!1,zoomOut:!1}},onLoad:function(){this.executeTypingAnimation(),this.loadSplashImage()},methods:{callCloudFunction:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l(e,t,Object.assign({pageTag:"splash",context:this},a))},executeTypingAnimation:function(){var e=this,t=this.fullText,a=0;(function r(){if(a<t.length){e.setData({typedText:e.typedText+t[a]}),a++;var n=e.getTypingDelay(a,t);setTimeout(r,n)}else setTimeout((function(){e.setData({showEnterButton:!0,textMoveUp:!0})}),500)})()},getTypingDelay:function(e,t){var a=t[e-1],r=t[e],n=100;return n=" "===a?200:"e"===a&&"n"===r?600:"m"===a&&"e"===r?400:"t"===a&&"e"===r?180:"e"===a&&"r"===r?160:120+100*Math.random(),n},handleEnterButtonClick:function(){uni.vibrateShort(),this.preloadCompleted?(this.setData({showEnterButton:!1,showNewLineCursor:!0}),this.blinkNewLineCursorAndNavigate()):uni.showToast({title:"正在加载中...",icon:"loading",duration:1e3})},blinkNewLineCursorAndNavigate:function(){var e=this;console.log("开始换行光标闪烁动画");var t=0,a=setInterval((function(){t++,console.log("光标闪烁第".concat(t,"次")),t>=2&&(clearInterval(a),console.log("光标闪烁完成，准备跳转"),setTimeout((function(){console.log("调用navigateToTarget方法"),e.navigateToTarget()}),500))}),600)},loadSplashImage:function(){var e=this;return(0,o.default)((0,n.default)().mark((function t(){return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("使用默认本地开屏图"),e.setData({preloadedImagePath:"/static/images/splash.png"}),e.executeOriginalPreloadTasks();case 3:case"end":return t.stop()}}),t)})))()},waitForOpenId:function(){var e=arguments;return(0,o.default)((0,n.default)().mark((function t(){var a,r,o,i,s,l,c;return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e.length>0&&void 0!==e[0]?e[0]:6e3,r=Date.now(),o=function(){var e=null;if("function"===typeof getApp)try{e=getApp()}catch(a){console.warn("获取全局 App 实例失败:",a)}e&&(e.globalData=e.globalData||{});var t=e&&e.globalData&&e.globalData.openid;if(!t&&"undefined"!==typeof uni&&"function"===typeof uni.getStorageSync)try{t=uni.getStorageSync("userOpenId")||uni.getStorageSync("openid"),t&&e&&(e.globalData.openid=t)}catch(a){console.warn("读取本地 openid 失败:",a)}return{appInstance:e,currentOpenId:t}},i=o(),s=i.appInstance,l=i.currentOpenId;case 4:if(l||!(Date.now()-r<a)){t.next=12;break}return t.next=7,new Promise((function(e){return setTimeout(e,200)}));case 7:c=o(),s=c.appInstance,l=c.currentOpenId,t.next=4;break;case 12:return l||console.warn("等待 openid 超时，预加载将退化为普通加载"),t.abrupt("return",{app:s,openid:l});case 14:case"end":return t.stop()}}),t)})))()},executeOriginalPreloadTasks:function(){var e=this;return(0,o.default)((0,n.default)().mark((function t(){var a,r,o,i;return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.waitForOpenId();case 2:if(a=t.sent,r=a.app,o=a.openid,o){t.next=8;break}return e.setData({preloadCompleted:!0}),t.abrupt("return");case 8:return r&&(r.globalData=r.globalData||{},r.globalData.openid||(r.globalData.openid=o)),i=[e.preloadTabIcons(),e.preloadPoemData(),e.preloadMountainData()],t.prev=10,t.next=13,Promise.all(i);case 13:t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](10),console.error("预加载任务执行过程中出现错误:",t.t0);case 18:return t.prev=18,e.setData({preloadCompleted:!0}),console.log("预加载任务完成，等待用户点击进入按钮"),t.finish(18);case 22:case"end":return t.stop()}}),t,null,[[10,15,18,22]])})))()},preloadPoemData:function(){var e=this;return new Promise(function(){var t=(0,o.default)((0,n.default)().mark((function t(a,r){return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.setData({isPreloading:!0}),e.callCloudFunction("getPostList",{skip:0,limit:5,isPoem:!0,isOriginal:!0}).then(function(){var t=(0,o.default)((0,n.default)().mark((function t(o){var i;return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(o.result&&o.result.success&&o.result.posts)){t.next=9;break}if(i=getApp(),i.globalData.preloadedPoemData=o.result.posts,!(o.result.posts.length>0)){t.next=9;break}return console.log("诗歌数据获取成功，开始预加载相关图片..."),t.next=8,e.preloadFirstPostImages(o.result.posts[0]);case 8:console.log("相关图片预加载完成！");case 9:a(),t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log("CatchClause",t.t0),console.log("CatchClause",t.t0),r(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.error("诗歌数据预加载失败:",e),r(e)})).finally((function(){console.log("诗歌数据预加载流程结束"),e.setData({preloadProgress:100,isPreloading:!1})}));case 2:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())},preloadMountainData:function(){var e=this;return new Promise(function(){var t=(0,o.default)((0,n.default)().mark((function t(a,r){return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.callCloudFunction("getPostList",{skip:0,limit:5,isPoem:!0,isOriginal:!1}).then(function(){var t=(0,o.default)((0,n.default)().mark((function t(o){var i;return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(o.result&&o.result.success&&o.result.posts)){t.next=9;break}if(i=getApp(),i.globalData.preloadedMountainData=o.result.posts,!(o.result.posts.length>0)){t.next=9;break}return console.log("山页面数据获取成功，开始预加载相关图片..."),t.next=8,e.preloadFirstMountainImages(o.result.posts[0]);case 8:console.log("山页面相关图片预加载完成！");case 9:a(),t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log("CatchClause",t.t0),console.log("CatchClause",t.t0),r(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.error("山页面数据预加载失败:",e),r(e)}));case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())},preloadFirstMountainImages:function(e){var t=getApp();t.globalData.preloadedImages||(t.globalData.preloadedImages={});var a=[],r=e.poemBgImage||e.imageUrls&&e.imageUrls[0];return r&&a.push(new Promise((function(e){var a="undefined"!==typeof window,n="string"===typeof r&&0===r.indexOf("cloud://"),o=!1;if(a&&(n?o=!0:/^https?:\/\//.test(r)&&(o=!r.startsWith(window.location.origin))),o)return console.log("🔍 [H5] 山页面首张背景图跳过下载，直接使用原URL:",r),t.globalData.preloadedImages[r]=r,void e();uni.downloadFile({url:r,success:function(e){200===e.statusCode&&(console.log("山页面首张背景图预加载成功:",e.tempFilePath),t.globalData.preloadedImages[r]=e.tempFilePath)},fail:function(e){console.error("山页面背景图预加载失败:",r,e),(a||n)&&(console.log("🔍 [H5] 山页面背景图预加载失败，使用原URL:",r),t.globalData.preloadedImages[r]=r)},complete:function(){e()}})}))),e.authorAvatar&&a.push(new Promise((function(a){var r="undefined"!==typeof window,n="string"===typeof e.authorAvatar&&0===e.authorAvatar.indexOf("cloud://"),o=!1;if(r&&(n?o=!0:/^https?:\/\//.test(e.authorAvatar)&&(o=!e.authorAvatar.startsWith(window.location.origin))),o)return console.log("🔍 [H5] 山页面作者头像预加载跳过下载，直接使用原URL"),t.globalData.preloadedImages[e.authorAvatar]=e.authorAvatar,void a();uni.downloadFile({url:e.authorAvatar,success:function(a){200===a.statusCode&&(console.log("山页面作者头像预加载成功"),t.globalData.preloadedImages[e.authorAvatar]=a.tempFilePath)},fail:function(a){console.error("山页面作者头像预加载失败:",e.authorAvatar,a),(r||n)&&(t.globalData.preloadedImages[e.authorAvatar]=e.authorAvatar)},complete:function(){a()}})}))),Promise.all(a)},preloadTabIcons:function(){return new Promise((function(e){var t=["/static/images/icons/home.png","/static/images/icons/home-active.png","/static/images/icons/examples.png","/static/images/icons/examples-active.png","/static/images/icons/usercenter.png","/static/images/icons/usercenter-active.png"],a=0,r=t.length;0!==r?t.forEach((function(t){uni.getImageInfo({src:t,complete:function(){a++,a===r&&(console.log("所有Tab图标预加载尝试完毕"),e())}})})):e()}))},preloadFirstPostImages:function(e){var t=getApp();t.globalData.preloadedImages||(t.globalData.preloadedImages={});var a=[],r=e.poemBgImage||e.imageUrls&&e.imageUrls[0];r&&a.push(new Promise((function(e){var a="undefined"!==typeof window,n="string"===typeof r&&0===r.indexOf("cloud://"),o=!1;if(a&&(n?o=!0:/^https?:\/\//.test(r)&&(o=!r.startsWith(window.location.origin))),o)return console.log("🔍 [H5] 首张背景图预加载跳过下载，直接使用原URL:",r),t.globalData.preloadedImages[r]=r,void e();uni.downloadFile({url:r,success:function(e){200===e.statusCode&&(console.log("首张背景图预加载成功:",e.tempFilePath),t.globalData.preloadedImages[r]=e.tempFilePath)},fail:function(e){console.error("首张背景图预加载失败:",r,e),(a||n)&&(console.log("🔍 [H5] 首张背景图预加载失败，使用原URL:",r),t.globalData.preloadedImages[r]=r)},complete:function(){e()}})}))),e.authorAvatar&&a.push(new Promise((function(a){var r="undefined"!==typeof window,n="string"===typeof e.authorAvatar&&0===e.authorAvatar.indexOf("cloud://"),o=!1;if(r&&(n?o=!0:/^https?:\/\//.test(e.authorAvatar)&&(o=!e.authorAvatar.startsWith(window.location.origin))),o)return console.log("🔍 [H5] 作者头像预加载跳过下载，直接使用原URL"),t.globalData.preloadedImages[e.authorAvatar]=e.authorAvatar,void a();uni.downloadFile({url:e.authorAvatar,success:function(a){200===a.statusCode&&(console.log("作者头像预加载成功"),t.globalData.preloadedImages[e.authorAvatar]=a.tempFilePath)},fail:function(a){(r||n)&&(console.error("作者头像预加载失败(已使用原URL):",a),t.globalData.preloadedImages[e.authorAvatar]=e.authorAvatar)},complete:function(){a()}})})));return["/static/images/like.png","/static/images/liked.png"].forEach((function(e){a.push(new Promise((function(t){uni.getImageInfo({src:e,complete:function(){console.log("通用图片预加载尝试完毕:",e),t()}})})))})),Promise.all(a)},navigateToTarget:function(){console.log("navigateToTarget方法被调用"),this.startFadeOut(),setTimeout((function(){console.log("开始检查用户登录状态");var e=getApp();console.log("用户登录状态检查:",{userInfo:!!e.globalData.userInfo,openid:!!e.globalData.openid}),e.globalData.userInfo&&e.globalData.openid?(console.log("用户已登录，跳转到poem页面"),uni.switchTab({url:"/pages/poem-square/poem-square"})):(console.log("用户未登录，跳转到登录页面"),uni.redirectTo({url:"/pages/login/login"}))}),800)},startFadeOut:function(){this.setData({fadeOut:!0,zoomOut:!0})}}};t.default=c}}]);