(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-following-following"],{"2cac":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"container"},[e.isLoading&&0===e.followings.length?n("v-uni-view",{staticClass:"loading"},[n("v-uni-text",[e._v("加载中...")])],1):e.followings.length>0?[n("v-uni-view",{staticClass:"list"},e._l(e.followings,(function(t,a){return n("v-uni-view",{key:a,staticClass:"following-item"},[n("v-uni-view",{staticClass:"user-info",attrs:{"data-openid":t._openid},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.openUserProfile.apply(void 0,arguments)}}},[n("v-uni-image",{staticClass:"avatar",attrs:{src:t.avatarUrl||e.defaultAvatar,mode:"aspectFill","data-index":a},on:{error:function(t){arguments[0]=t=e.$handleEvent(t),e.onAvatarError.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"info-text"},[n("v-uni-text",{staticClass:"name"},[e._v(e._s(t.nickName||"微信用户"))]),n("v-uni-text",{staticClass:"bio"},[e._v(e._s(t.bio||"这个用户还没有留下简介~"))])],1)],1),n("v-uni-button",{staticClass:"unfollow-btn",attrs:{size:"mini","data-openid":t._openid,"data-index":a,loading:e.pendingOpenid===t._openid,disabled:e.pendingOpenid===t._openid},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=e.$handleEvent(t),e.onToggleFollow.apply(void 0,arguments)}}},[e._v("取消关注")])],1)})),1)]:n("v-uni-view",{staticClass:"empty"},[n("v-uni-text",[e._v("还没有关注任何人，去广场看看吧～")])],1),e.followings.length>0?n("v-uni-view",{staticClass:"footer-hint"},[e.isLoading?n("v-uni-view",{staticClass:"loading-more"},[e._v("加载中...")]):e.hasMore?e._e():n("v-uni-view",{staticClass:"loading-more"},[e._v("已经到底了")])],1):e._e()],2)},i=[]},3354:function(e,t,n){"use strict";n("6a54");var a=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("39d8"));n("bf0f"),n("c223"),n("8f71");var o=n("38db"),r=o.cloudCall,s={data:function(){return{followings:[],isLoading:!1,hasMore:!0,page:0,PAGE_SIZE:20,pendingOpenid:null,defaultAvatar:"/images/avatar.png",total:"",avatarKey:""}},onLoad:function(){this.loadFollowings(!0)},onPullDownRefresh:function(){this.loadFollowings(!0)},onReachBottom:function(){this.hasMore&&!this.isLoading&&this.loadFollowings()},methods:{callCloudFunction:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(e,t,Object.assign({pageTag:"following",context:this,requireAuth:!0},n))},loadFollowings:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isLoading){t&&this.setData({page:0,hasMore:!0});var n=t?0:this.page;this.setData({isLoading:!0});var a=this.$requireOpenid&&this.$requireOpenid();if(!a)return this.setData({isLoading:!1}),void(t&&uni.stopPullDownRefresh());this.callCloudFunction("follow",{action:"getFollowingList",skip:n*this.PAGE_SIZE,limit:this.PAGE_SIZE,openid:a}).then((function(a){if(a.result&&a.result.success){var i=a.result.list||[],o=t?i:e.followings.concat(i);e.setData({followings:o,page:n+1,hasMore:!!a.result.hasMore,total:a.result.total||o.length})}else uni.showToast({title:a.result&&a.result.message?a.result.message:"加载失败",icon:"none"})})).catch((function(e){console.error("获取关注列表失败:",e),uni.showToast({title:"网络错误",icon:"none"})})).finally((function(){e.setData({isLoading:!1}),t&&uni.stopPullDownRefresh()}))}},onToggleFollow:function(e){var t=this,n=e.currentTarget.dataset.openid,a=e.currentTarget.dataset.index;if(n&&!this.pendingOpenid){this.setData({pendingOpenid:n});var i=this.$requireOpenid&&this.$requireOpenid();i?this.callCloudFunction("follow",{action:"toggleFollow",targetOpenid:n,openid:i}).then((function(e){if(e.result&&e.result.success){var n=!!e.result.isFollowing;if(n)uni.showToast({title:"已关注",icon:"success"});else{var i=t.followings.filter((function(e,t){return t!==a}));t.setData({followings:i}),uni.showToast({title:"已取消关注",icon:"success"}),t.hasMore&&i.length<t.PAGE_SIZE&&t.loadFollowings(),0!==i.length||t.hasMore||t.setData({page:0})}}else uni.showToast({title:e.result&&e.result.message?e.result.message:"操作失败",icon:"none"})})).catch((function(e){console.error("取消关注失败:",e),uni.showToast({title:"网络错误",icon:"none"})})).finally((function(){t.setData({pendingOpenid:null})})):this.setData({pendingOpenid:null})}},onAvatarError:function(e){var t=e.currentTarget.dataset.index;if(void 0!==t){var n="followings[".concat(t,"].avatarUrl");this.setData((0,i.default)({},n,this.defaultAvatar))}},openUserProfile:function(e){var t=e.currentTarget.dataset.openid;t&&uni.navigateTo({url:"/pages/user-profile/user-profile?userId=".concat(t)})}}};t.default=s},"5bb4":function(e,t,n){"use strict";n.r(t);var a=n("2cac"),i=n("f2cd");for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("a21a");var r=n("828b"),s=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,"81ec9280",null,!1,a["a"],void 0);t["default"]=s.exports},"967d":function(e,t,n){"use strict";function a(e,t){for(var n=[],a={},i=0;i<t.length;i++){var o=t[i],r=o[0],s=o[1],l=o[2],u=o[3],c={id:e+":"+i,css:s,media:l,sourceMap:u};a[r]?a[r].parts.push(c):n.push(a[r]={id:r,parts:[c]})}return n}n.r(t),n.d(t,"default",(function(){return p}));var i="undefined"!==typeof document;if("undefined"!==typeof DEBUG&&DEBUG&&!i)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},r=i&&(document.head||document.getElementsByTagName("head")[0]),s=null,l=0,u=!1,c=function(){},d=null,f="undefined"!==typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(e,t,n,i){u=n,d=i||{};var r=a(e,t);return v(r),function(t){for(var n=[],i=0;i<r.length;i++){var s=r[i],l=o[s.id];l.refs--,n.push(l)}t?(r=a(e,t),v(r)):r=[];for(i=0;i<n.length;i++){l=n[i];if(0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete o[l.id]}}}}function v(e){for(var t=0;t<e.length;t++){var n=e[t],a=o[n.id];if(a){a.refs++;for(var i=0;i<a.parts.length;i++)a.parts[i](n.parts[i]);for(;i<n.parts.length;i++)a.parts.push(h(n.parts[i]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var r=[];for(i=0;i<n.parts.length;i++)r.push(h(n.parts[i]));o[n.id]={id:n.id,refs:1,parts:r}}}}function g(){var e=document.createElement("style");return e.type="text/css",r.appendChild(e),e}function h(e){var t,n,a=document.querySelector('style[data-vue-ssr-id~="'+e.id+'"]');if(a){if(u)return c;a.parentNode.removeChild(a)}if(f){var i=l++;a=s||(s=g()),t=m.bind(null,a,i,!1),n=m.bind(null,a,i,!0)}else a=g(),t=b.bind(null,a),n=function(){a.parentNode.removeChild(a)};return t(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;t(e=a)}else n()}}var w=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function m(e,t,n,a){var i=n?"":D(a.css);if(e.styleSheet)e.styleSheet.cssText=w(t,i);else{var o=document.createTextNode(i),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(o,r[t]):e.appendChild(o)}}function b(e,t){var n=D(t.css),a=t.media,i=t.sourceMap;if(a&&e.setAttribute("media",a),d.ssrId&&e.setAttribute("data-vue-ssr-id",t.id),i&&(n+="\n/*# sourceURL="+i.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{while(e.firstChild)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var y=/%\?([+-]?\d+(\.\d+)?)\?%/g,x=/\.\?%PAGE\?%/g,C=/\?%PAGE\?%\[data-v-[a-z0-9]{8}\]/g,_=/uni-page-body\[data-v-[a-z0-9]{8}\]/g,E=/var\(--status-bar-height\)/gi,T=/var\(--window-top\)/gi,A=/var\(--window-bottom\)/gi,O=/var\(--window-left\)/gi,M=/var\(--window-right\)/gi;function D(e){var t=function(){var e="function"===typeof getApp&&getApp();return e&&e.$route&&e.$route.meta&&e.$route.meta.name||""}();if("undefined"!==typeof uni&&!uni.canIUse("css.var")){var n=function(){var e="function"===typeof getApp&&getApp();if(e&&e.$route&&e.$route.meta&&e.$route.meta.name)return{top:e.$route.meta.windowTop,bottom:e.$route.meta.isTabBar?50:0};return{top:0,bottom:0}}();e=e.replace(E,"0px").replace(T,n.top+"px").replace(A,n.bottom+"px").replace(O,"0px").replace(M,"0px")}return e.replace(C,t).replace(x,"").replace(_,"body."+t+" uni-page-body").replace(/\{[\s\S]+?\}|@media.+?\{/g,(function(e){return"undefined"===typeof uni?e:e.replace(y,(function(e,t){return uni.upx2px(t)+"px"}))}))}},a21a:function(e,t,n){"use strict";var a=n("b4f9"),i=n.n(a);i.a},b4f9:function(e,t,n){var a=n("f2ab");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("967d").default;i("1fed0d08",a,!0,{sourceMap:!1,shadowMode:!1})},c86c:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",a=e[3];if(!a)return n;if(t&&"function"===typeof btoa){var i=function(e){var t=btoa(unescape(encodeURIComponent(JSON.stringify(e)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(t);return"/*# ".concat(n," */")}(a),o=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[n].concat(o).concat([i]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"===typeof e&&(e=[[null,e,""]]);var i={};if(a)for(var o=0;o<this.length;o++){var r=this[o][0];null!=r&&(i[r]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);a&&i[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},f2ab:function(e,t,n){var a=n("c86c");t=a(!1),t.push([e.i,".container[data-v-81ec9280]{padding:%?32?%;background-color:#f7f8fa;min-height:100vh}.list[data-v-81ec9280]{display:flex;flex-direction:column;gap:%?24?%}.following-item[data-v-81ec9280]{display:flex;align-items:center;justify-content:space-between;background-color:#fff;border-radius:%?16?%;padding:%?24?% %?28?%;box-shadow:0 %?6?% %?18?% rgba(0,0,0,.05)}.user-info[data-v-81ec9280]{display:flex;align-items:center;flex:1;overflow:hidden}.avatar[data-v-81ec9280]{width:%?88?%;height:%?88?%;border-radius:50%;margin-right:%?20?%;background-color:#f0f0f0}.info-text[data-v-81ec9280]{display:flex;flex-direction:column;gap:%?8?%;overflow:hidden}.name[data-v-81ec9280]{font-size:%?30?%;color:#333;font-weight:600}.bio[data-v-81ec9280]{font-size:%?24?%;color:#888;line-height:1.4;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:%?420?%}.unfollow-btn[data-v-81ec9280]{margin-left:%?24?%;border:%?2?% solid #ff8f8f;color:#ff6b6b;background-color:#fff;border-radius:%?999?%;padding:0 %?28?%;height:%?64?%!important;line-height:%?64?%!important}.unfollow-btn[data-v-81ec9280]::after{border:none}.unfollow-btn[disabled][data-v-81ec9280]{opacity:.6}.loading[data-v-81ec9280],\r\n.loading-more[data-v-81ec9280]{margin-top:%?32?%;text-align:center;color:#999;font-size:%?26?%}.empty[data-v-81ec9280]{margin-top:%?120?%;text-align:center;color:#999;font-size:%?28?%}.footer-hint[data-v-81ec9280]{margin-top:%?24?%}.mutual-label[data-v-81ec9280]{margin-top:%?8?%;display:inline-block;padding:%?4?% %?16?%;background-color:#e6f4ff;color:#1f6fd2;border-radius:%?999?%;font-size:%?24?%}",""]),e.exports=t},f2cd:function(e,t,n){"use strict";n.r(t);var a=n("3354"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a}}]);