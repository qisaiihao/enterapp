(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-profile-profile"],{"04c9":function(n,r,t){"use strict";t.r(r);var e=t("d2dd"),a=t.n(e);for(var o in e)["default"].indexOf(o)<0&&function(n){t.d(r,n,(function(){return e[n]}))}(o);r["default"]=a.a},"0da0":function(n,r,t){"use strict";var e=t("ac8d"),a=t.n(e);a.a},"0f46":function(n,r,t){"use strict";var e=t("14fe"),a=t.n(e);a.a},"14fe":function(n,r,t){var e=t("8ed6");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);var a=t("967d").default;a("7a9d0cb7",e,!0,{sourceMap:!1,shadowMode:!1})},"26a8":function(n,r,t){"use strict";t("6a54"),Object.defineProperty(r,"__esModule",{value:!0}),r.getCurrentTabBarStatus=function(n){try{if("function"===typeof n.getTabBar&&n.getTabBar()){var r,t=n.getTabBar();return(null===(r=t.data)||void 0===r?void 0:r.selected)||null}}catch(o){console.log("无法从原生getTabBar获取状态")}try{var e,a=null===(e=n.$refs)||void 0===e?void 0:e.customTabBar;if(a&&a.data)return a.data.selected||null}catch(o){console.log("无法从自定义组件获取状态")}try{return uni.getStorageSync("currentTabIndex")||null}catch(o){console.log("无法从存储获取状态")}return null},r.isTabBarSupported=function(){try{return!("undefined"===typeof wx||!wx.getTabBar)||!("undefined"===typeof uni||!uni.getTabBar)}catch(n){return!1}},r.updateTabBarStatus=function(n,r){try{if("function"===typeof n.getTabBar&&n.getTabBar())return n.getTabBar().setData({selected:r}),console.log("TabBar状态更新成功 (原生API): selected=".concat(r)),!0}catch(t){console.log("原生getTabBar API不可用:",t.message)}try{return uni.setStorageSync("currentTabIndex",r),console.log("TabBar状态已保存到存储: selected=".concat(r)),!0}catch(t){console.log("存储机制不可用:",t.message)}return console.warn("原生getTabBar API不可用，当前平台可能不支持getTabBar()"),!1}},"4d07":function(n,r,t){"use strict";t.r(r);var e=t("c03a"),a=t.n(e);for(var o in e)["default"].indexOf(o)<0&&function(n){t.d(r,n,(function(){return e[n]}))}(o);r["default"]=a.a},"4db6":function(n,r,t){t("6a54");var e=t("8bcf");function a(n,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,e(a.key),a)}}n.exports=function(n,r,t){return r&&a(n.prototype,r),t&&a(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n},n.exports.__esModule=!0,n.exports["default"]=n.exports},5347:function(n,r,t){"use strict";t.d(r,"b",(function(){return e})),t.d(r,"c",(function(){return a})),t.d(r,"a",(function(){}));var e=function(){var n=this.$createElement,r=this._self._c||n;return r("v-uni-view",{staticClass:"skeleton-wrapper"},[r("v-uni-view",{staticClass:"skeleton-poem-card"},[r("v-uni-view",{staticClass:"skeleton-original-badge skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-author-info"},[r("v-uni-view",{staticClass:"skeleton-avatar skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-name skeleton-animate"})],1),r("v-uni-view",{staticClass:"skeleton-title skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate",staticStyle:{width:"70%"}})],1),r("v-uni-view",{staticClass:"skeleton-poem-card skeleton-secondary"},[r("v-uni-view",{staticClass:"skeleton-author-info"},[r("v-uni-view",{staticClass:"skeleton-avatar skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-name skeleton-animate"})],1),r("v-uni-view",{staticClass:"skeleton-title skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate"}),r("v-uni-view",{staticClass:"skeleton-content-large skeleton-animate",staticStyle:{width:"80%"}})],1)],1)},a=[]},"5ee5":function(n,r,t){"use strict";t.r(r);var e=t("9322"),a=t("04c9");for(var o in a)["default"].indexOf(o)<0&&function(n){t.d(r,n,(function(){return a[n]}))}(o);t("7868");var i=t("828b"),s=Object(i["a"])(a["default"],e["b"],e["c"],!1,null,"35c887f1",null,!1,e["a"],void 0);r["default"]=s.exports},"6bf1":function(n,r,t){"use strict";t.r(r);var e=t("7a50"),a=t.n(e);for(var o in e)["default"].indexOf(o)<0&&function(n){t.d(r,n,(function(){return e[n]}))}(o);r["default"]=a.a},"71b6":function(n,r,t){"use strict";t.r(r);var e=t("5347"),a=t("4d07");for(var o in a)["default"].indexOf(o)<0&&function(n){t.d(r,n,(function(){return a[n]}))}(o);t("0f46");var i=t("828b"),s=Object(i["a"])(a["default"],e["b"],e["c"],!1,null,"a51e8920",null,!1,e["a"],void 0);r["default"]=s.exports},"724b":function(n,r,t){"use strict";t.r(r);var e=t("7d9d"),a=t("6bf1");for(var o in a)["default"].indexOf(o)<0&&function(n){t.d(r,n,(function(){return a[n]}))}(o);t("0da0");var i=t("828b"),s=Object(i["a"])(a["default"],e["b"],e["c"],!1,null,"846b9078",null,!1,e["a"],void 0);r["default"]=s.exports},7708:function(n,r,t){var e=t("7f62");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);var a=t("967d").default;a("4319e959",e,!0,{sourceMap:!1,shadowMode:!1})},7868:function(n,r,t){"use strict";var e=t("7708"),a=t.n(e);a.a},"7a3b":function(n,r,t){"use strict";t("6a54");var e=t("f5bd").default;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.resetAllCachesOnAccountChange=g;var a=e(t("2634")),o=e(t("2fdc"));t("bf0f"),t("2797"),t("dc8a"),t("de6c"),t("f3f7"),t("18f7"),t("9db6"),t("9327");var i=e(t("7ef8")),s=e(t("9384")),l=t("b577"),c=t("acbf");function d(){try{var n=i.default&&i.default.getStats?i.default.getStats():{};Object.keys(n||{}).forEach((function(n){try{i.default.namespace(n).clear()}catch(r){}}))}catch(r){}}function f(){try{"undefined"!==typeof uni&&uni.removeStorageSync("cachedPostList")}catch(n){}}function u(){try{if("undefined"===typeof uni||"function"!==typeof uni.getStorageInfoSync)return;var n=uni.getStorageInfoSync(),r=n&&n.keys||[],t=new Set;r.forEach((function(n){if("string"===typeof n&&n.startsWith("__cm__:")&&n.endsWith(":__keys__")){var r=n.substring("__cm__:".length,n.length-":__keys__".length);r&&t.add(r)}})),t.forEach((function(n){try{i.default.namespace(n,{persistent:!0}).clear()}catch(r){}}))}catch(e){}}function g(){return v.apply(this,arguments)}function v(){return v=(0,o.default)((0,a.default)().mark((function n(){var r,t,e,o=arguments;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=o.length>0&&void 0!==o[0]?o[0]:{},r.newOpenId,n.prev=1;try{s.default.invalidate()}catch(a){}d(),u(),f();try{c&&c.clearAllFollowCache&&c.clearAllFollowCache()}catch(a){}return n.prev=7,t="function"===typeof getApp?getApp():null,e=t||{$tcb:t&&t.$tcb?t.$tcb:null},n.next=12,(0,l.getMyInfo)(e);case 12:n.next=16;break;case 14:n.prev=14,n.t0=n["catch"](7);case 16:n.next=21;break;case 18:n.prev=18,n.t1=n["catch"](1);try{console.warn("[accountCacheReset] 清理缓存时出错",n.t1)}catch(a){}case 21:case"end":return n.stop()}}),n,null,[[1,18],[7,14]])}))),v.apply(this,arguments)}var h={resetAllCachesOnAccountChange:g};r.default=h},"7a50":function(n,r,t){"use strict";t("6a54"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,t("bd06"),t("5ef2"),t("5c47"),t("a1c1"),t("9db6");var e={data:function(){return{selected:0,color:"#999999",selectedColor:"#9ed7ee",lastTapTime:0,lastTapIndex:-1,doubleTapThreshold:300,list:[{pagePath:"pages/index/index",text:"广场",iconPath:"/static/images/market.png",selectedIconPath:"/static/images/marketplus.png"},{pagePath:"pages/poem-square/poem-square",text:"·",iconPath:"/static/images/road.png",selectedIconPath:"/static/images/roadplus.png"},{pagePath:"pages/mountain/mountain",text:"山",iconPath:"/static/images/mountain.png",selectedIconPath:"/static/images/mountainplus.png"},{pagePath:"pages/profile/profile",text:"池",iconPath:"/static/images/pools.png",selectedIconPath:"/static/images/poolsplus.png"}]}},created:function(){this.syncSelected()},methods:{syncSelected:function(){try{var n=getCurrentPages(),r=n&&n.length?n[n.length-1]:null,t=r&&(r.route||r.$page&&r.$page.fullPath||"");if(!t)return;var e=this.list.findIndex((function(n){return t.indexOf(n.pagePath.replace(/^\//,""))>=0}));e>=0&&this.setData({selected:e})}catch(a){}},switchTab:function(n){var r=n.currentTarget.dataset,t=r.path,e=r.index,a=Date.now(),o=a-this.lastTapTime<this.doubleTapThreshold&&this.lastTapIndex===e&&this.selected===e;if(this.setData({lastTapTime:a,lastTapIndex:e}),o)this.refreshCurrentPage();else{var i=t.startsWith("/")?t:"/".concat(t);uni.switchTab({url:i})}},refreshCurrentPage:function(){var n=this.list[this.selected],r=getCurrentPages(),t=r[r.length-1];if(t)switch(n.pagePath){case"pages/index/index":this.refreshIndexPage(t);break;case"pages/poem-square/poem-square":this.refreshPoemPage(t);break;case"pages/mountain/mountain":this.refreshMountainPage(t);break;case"pages/profile/profile":this.refreshProfilePage(t);break;default:this.refreshGenericPage(t)}},refreshIndexPage:function(n){n.refreshData?n.refreshData():n.onPullDownRefresh||uni.startPullDownRefresh()},refreshPoemPage:function(n){n.refreshPoemData?n.refreshPoemData():n.onPullDownRefresh||uni.startPullDownRefresh()},refreshMountainPage:function(n){n.refreshMountainData?n.refreshMountainData():n.onPullDownRefresh||uni.startPullDownRefresh()},refreshProfilePage:function(n){n.onPullDownRefresh||uni.startPullDownRefresh()},refreshGenericPage:function(n){n.onPullDownRefresh||uni.startPullDownRefresh()}}};r.default=e},"7d9d":function(n,r,t){"use strict";t.d(r,"b",(function(){return e})),t.d(r,"c",(function(){return a})),t.d(r,"a",(function(){}));var e=function(){var n=this,r=n.$createElement,t=n._self._c||r;return t("v-uni-view",{staticClass:"tab-bar"},n._l(n.list,(function(r,e){return t("v-uni-view",{key:e,staticClass:"tab-bar-item",attrs:{"data-index":e,"data-path":r.pagePath},on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.switchTab.apply(void 0,arguments)}}},[t("v-uni-view",{class:["icon-wrap",n.selected===e?"pressed":""]},[t("v-uni-view",{class:["icon-inner",n.selected===e?"active":""]},[t("v-uni-image",{staticClass:"icon-img",attrs:{src:n.selected===e&&r.selectedIconPath||r.iconPath,mode:"aspectFill"}})],1)],1),t("v-uni-text",{staticClass:"tab-bar-text"},[n._v(n._s(r.text))])],1)})),1)},a=[]},"7f62":function(n,r,t){var e=t("c86c");r=e(!1),r.push([n.i,'\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* pages/profile/profile.wxss */.container[data-v-35c887f1]{width:100%;height:100vh;background-color:#fff}.scroll-container[data-v-35c887f1]{width:100%;height:100%}.sidebar-mask[data-v-35c887f1]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);z-index:999}.sidebar[data-v-35c887f1]{position:fixed;top:0;left:-70%; /* Start off-screen */width:70%;height:100%;background-color:#fff;box-shadow:2px 0 5px rgba(0,0,0,.1);transition:left .3s ease;z-index:1000;display:flex;flex-direction:column;overflow-y:auto}.sidebar.open[data-v-35c887f1]{left:0 /* Slide in */}.sidebar-header[data-v-35c887f1]{padding:%?40?% %?30?%;border-bottom:%?1?% solid #eee;display:flex;flex-direction:column;align-items:center;margin-top:%?80?%}.sidebar-avatar[data-v-35c887f1]{width:%?120?%;height:%?120?%;border-radius:50%;margin-bottom:%?20?%}.sidebar-nickname[data-v-35c887f1]{font-size:%?32?%;font-weight:700}.sidebar-menu[data-v-35c887f1]{margin-top:%?40?%}.sidebar-item[data-v-35c887f1]{padding:%?30?%;border-bottom:%?1?% solid #f0f0f0;font-size:%?32?%;color:#333;position:relative;display:flex;justify-content:space-between;align-items:center}.sidebar-item[data-v-35c887f1]:active{background-color:#f5f5f5}\r\n/* 未读消息标记 */.unread-badge[data-v-35c887f1]{background-color:#ff6b6b;color:#fff;font-size:%?20?%;padding:%?4?% %?10?%;border-radius:%?20?%;min-width:%?32?%;text-align:center;font-weight:700}\r\n/* 退出登录按钮特殊样式 */.logout-item[data-v-35c887f1]{border-top:%?2?% solid #f0f0f0;margin-top:%?20?%;color:#ff6b6b!important;font-weight:500}.logout-item[data-v-35c887f1]:active{background-color:#fff5f5!important}.main-content[data-v-35c887f1]{width:100%;\r\n    /* height: 100vh; */background-color:#fff;\r\n    /* overflow-y: auto; */padding-bottom:%?100?% /* 为底部TabBar留出空间 */}.header[data-v-35c887f1]{display:flex;align-items:center;padding:%?20?% %?30?%;background-color:#fff;border-bottom:%?1?% solid #eee;padding-top:calc(%?20?% + 0px)}.menu-btn[data-v-35c887f1]{width:%?48?%;height:%?48?%;padding:%?10?%;transition:opacity .2s ease}.menu-btn[data-v-35c887f1]:active{opacity:.7}.header-title[data-v-35c887f1]{flex:1;text-align:center;font-size:%?34?%;font-weight:500;margin-right:%?68?% /* to balance the menu button */}\r\n/* Loading State */.loading-container[data-v-35c887f1]{display:flex;justify-content:center;align-items:center;height:%?400?%;background-color:#fff;border-radius:%?16?%;margin:%?30?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05)}.loading-text[data-v-35c887f1]{font-size:%?28?%;color:#999}\r\n/* User Profile Card */.profile-card[data-v-35c887f1]{margin:%?30?%;padding:%?40?%;background-color:#fff;border-radius:%?16?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05);display:flex;align-items:flex-start;transition:box-shadow .2s ease}.profile-card[data-v-35c887f1]:active{box-shadow:0 %?2?% %?8?% rgba(0,0,0,.1)}.profile-avatar[data-v-35c887f1]{margin-right:%?30?%}.profile-avatar uni-image[data-v-35c887f1]{width:%?120?%;height:%?120?%;border-radius:50%}.profile-info[data-v-35c887f1]{flex:1;display:flex;flex-direction:column;min-width:0 /* 防止flex子元素溢出 */}.profile-name[data-v-35c887f1]{font-size:%?36?%;font-weight:700;color:#333;margin-bottom:%?10?%;word-break:break-word;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.profile-bio[data-v-35c887f1]{font-size:%?28?%;color:#999;margin-bottom:%?20?%;line-height:1.4;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical}.profile-details[data-v-35c887f1]{display:flex;flex-direction:column;gap:%?8?%}.detail-item[data-v-35c887f1]{font-size:%?26?%;color:#666;word-break:break-word;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}\r\n/* Tab Navigation */.tab-navigation[data-v-35c887f1]{margin:0 %?30?% %?20?% %?30?%;display:flex;background:#fff;border:%?1?% solid #fff;border-radius:%?16?%;overflow:hidden}.tab-item[data-v-35c887f1]{flex:1;padding:%?20?% %?10?%;text-align:center;background:#fff;transition:all .3s ease;position:relative;display:flex;align-items:center;justify-content:center}.tab-item.active[data-v-35c887f1]::after{content:"";position:absolute;bottom:%?8?%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);width:%?200?%;height:%?6?%;background:#333;border-radius:%?3?%}.tab-item[data-v-35c887f1]:active{background:#f5f5f5}.tab-icon[data-v-35c887f1]{width:%?110?%;height:%?110?%;-webkit-filter:grayscale(1) brightness(.5);filter:grayscale(1) brightness(.5);opacity:.7}.tab-item.active .tab-icon[data-v-35c887f1]{-webkit-filter:grayscale(0) brightness(1);filter:grayscale(0) brightness(1);opacity:1}\r\n/* My Posts Section */.my-posts-section[data-v-35c887f1]{margin:0 0 %?30?% 0}\r\n/* Portfolio Section */.portfolio-section[data-v-35c887f1]{margin:0 0 %?30?% 0}\r\n/* Favorites Section */.favorites-section[data-v-35c887f1]{margin:0 0 %?30?% 0}.section-title[data-v-35c887f1]{font-size:%?32?%;font-weight:700;color:#333;margin-bottom:%?20?%;padding:0 %?10?%}\r\n/* 新增：帖子项包装器样式 */.post-item-wrapper[data-v-35c887f1]{background:#fff;margin-bottom:%?20?%;padding:0;box-shadow:none;border-radius:0;border-bottom:%?1?% solid #f0f0f0}\r\n/* 原创帖子特殊样式 */.post-item-wrapper.original-post[data-v-35c887f1]{background:linear-gradient(90deg,rgba(235,200,141,.05),hsla(0,0%,100%,0));border-left:%?3?% solid #ebc88d;position:relative}\r\n/* 新增：内容导航器样式 */.post-content-navigator[data-v-35c887f1]{display:block;background:transparent}\r\n/* 新增：导航器点击效果 */.navigator-hover[data-v-35c887f1]{background-color:rgba(0,0,0,.02)}\r\n/* 新增：点赞按钮容器样式 */.like-btn-container[data-v-35c887f1]{position:absolute;top:%?20?%;right:%?20?%;z-index:10}.like-btn[data-v-35c887f1]{width:%?60?%;height:%?60?%;background:hsla(0,0%,100%,.9);border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 %?2?% %?8?% rgba(0,0,0,.1);transition:all .2s ease}.like-btn[data-v-35c887f1]:active{-webkit-transform:scale(.9);transform:scale(.9)}.like-icon[data-v-35c887f1]{font-size:%?24?%;color:#666}.like-icon.liked[data-v-35c887f1]{color:#ff4757}\r\n/* 定义点击时的样式 - 整个卡片缩小 */.post-card-active[data-v-35c887f1]{-webkit-transform:scale(.98);transform:scale(.98)}\r\n/* 外部作者信息样式 */.author-info-outside[data-v-35c887f1]{display:flex;align-items:center;padding:%?20?% %?40?% %?10?% %?40?%;background:#fff;border-radius:0;box-shadow:none}.author-info-outside .author-avatar[data-v-35c887f1]{width:%?60?%;height:%?60?%;border-radius:50%;margin-right:%?15?%;background-color:#f5f5f5;cursor:pointer}.author-info-outside .author-name[data-v-35c887f1]{font-size:%?28?%;color:#333;font-weight:500}.post-item[data-v-35c887f1]{width:100%;background:#fff;border-radius:0;box-shadow:none;box-sizing:border-box;padding:%?20?% %?40?% %?30?% %?40?%}.post-title[data-v-35c887f1]{font-size:%?36?%;font-weight:700;color:#333;margin-bottom:%?15?%;line-height:1.4;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical}\r\n/* 诗歌作者样式 */.poem-author[data-v-35c887f1]{font-size:%?32?%;color:#000;text-align:center;margin:%?5?% 0 %?15?% 0;letter-spacing:%?2?%}\r\n/* 新增：图片容器占位样式 */.image-container-wrapper[data-v-35c887f1]{position:relative;width:100%;background-color:#f0f0f0; /* 占位时的背景色，很重要 */overflow:hidden;border-radius:8px; /* 可以加个圆角，让占位块更好看 */margin:%?20?% 0 /* 图片和下方内容的间距 */}\r\n/* 新增：让图片或swiper填充整个占位容器 */.image-container-wrapper .post-image[data-v-35c887f1],\r\n.image-container-wrapper .image-swiper[data-v-35c887f1]{position:absolute;top:0;left:0;width:100%;height:100%}\r\n/* 多张图片的swiper样式 */.image-swiper[data-v-35c887f1]{width:100%;background-color:#fff\r\n    /* 高度由 style 绑定动态设置 */}.swiper-item[data-v-35c887f1]{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.post-image[data-v-35c887f1]{width:100%;height:100%;display:block;object-fit:contain}.post-image[data-v-35c887f1]:active{-webkit-transform:scale(1.05);transform:scale(1.05)}.post-image.single-image[data-v-35c887f1]{width:100%;height:auto;display:block;object-fit:cover}\r\n/* 图片数量指示器 */.image-count-indicator[data-v-35c887f1]{position:absolute;top:%?20?%;right:%?20?%;background:rgba(0,0,0,.6);color:#fff;padding:%?8?% %?12?%;border-radius:%?20?%;font-size:%?24?%;z-index:5}.post-content[data-v-35c887f1]{font-size:%?28?%;color:#666;line-height:1.6;margin-top:%?15?%;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical}\r\n/* 删除按钮区域样式 */.delete-section[data-v-35c887f1]{display:flex;justify-content:space-between;align-items:center;margin-top:%?20?%;padding:0 %?40?% 0 %?40?%}\r\n/* 左侧时间区域，保持原有样式 */.time-left[data-v-35c887f1]{flex:1}.button-group[data-v-35c887f1]{display:flex;align-items:center}.favorite-time[data-v-35c887f1],\r\n.post-time[data-v-35c887f1]{font-size:%?24?%;color:#999}\r\n/* 标签样式 */.post-tags[data-v-35c887f1]{margin-top:%?30?%;margin-bottom:%?10?%;line-height:1.5}.post-tag[data-v-35c887f1]{color:#24375f;font-size:%?26?%;margin-right:%?10?%;transition:all .2s ease;cursor:pointer}.post-tag[data-v-35c887f1]:active{color:#1a2a4a;opacity:.8}.delete-btn[data-v-35c887f1]{display:flex;align-items:center;justify-content:center;transition:all .2s ease;cursor:pointer;padding:%?10?%}.delete-btn[data-v-35c887f1]:active{-webkit-transform:scale(.9);transform:scale(.9)}.delete-icon[data-v-35c887f1]{width:%?100?%;height:%?100?%}.remove-favorite-btn[data-v-35c887f1]{background-color:#f39c12;color:#fff;border:none;border-radius:%?8?%;font-size:%?24?%;padding:%?8?% %?16?%;line-height:1.2;min-width:%?100?%;transition:background-color .2s ease}.remove-favorite-btn[data-v-35c887f1]:active{background-color:#e67e22}.remove-favorite-btn[data-v-35c887f1]::after{border:none}.empty-tip[data-v-35c887f1]{text-align:center;color:#bbb;font-size:%?28?%;margin:%?40?% 0;padding:%?60?% 0;background-color:#fff;border-radius:%?16?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05)}.author-info[data-v-35c887f1]{display:flex;align-items:center\r\n    /* margin-bottom: 15rpx;  // 移除多余的间距 */}.author-avatar[data-v-35c887f1]{width:%?60?%;height:%?60?%;border-radius:50%;margin-right:%?15?%;background-color:#f5f5f5}.author-name[data-v-35c887f1]{font-size:%?28?%;color:#333;font-weight:500}.profile-card-center[data-v-35c887f1]{position:relative;margin:0;padding:%?40?% %?40?% %?20?% %?40?%;background-color:initial;border-radius:0;box-shadow:none;display:flex;flex-direction:column;align-items:center;overflow:visible}.menu-btn-small[data-v-35c887f1]{width:%?40?%;height:%?40?%;cursor:pointer;transition:-webkit-transform .2s ease;transition:transform .2s ease;transition:transform .2s ease,-webkit-transform .2s ease;-webkit-filter:grayscale(1) brightness(.5);filter:grayscale(1) brightness(.5);opacity:.7}.menu-btn-small[data-v-35c887f1]:active{-webkit-transform:scale(.9);transform:scale(.9)}.back-btn[data-v-35c887f1]{position:absolute;top:%?24?%;left:%?24?%;width:%?56?%;height:%?56?%;z-index:100;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.1);border-radius:50%;font-size:%?36?%;color:#333;transition:background-color .2s ease}.back-btn[data-v-35c887f1]:active{background:rgba(0,0,0,.2)}.profile-avatar-large[data-v-35c887f1]{display:flex;justify-content:center;align-items:center;margin:%?70?% 0 %?40?% 0}.profile-avatar-large uni-image[data-v-35c887f1]{width:%?175?%;height:%?175?%;border-radius:50%;display:block}.profile-info-center[data-v-35c887f1]{display:flex;flex-direction:column;align-items:flex-start;margin-top:%?20?%;width:100%}.profile-name-center[data-v-35c887f1]{font-family:Inter,sans-serif;font-weight:600;font-size:%?30?%;line-height:%?36?%;color:#000;margin-bottom:%?20?%;text-align:left}.profile-poemid[data-v-35c887f1]{font-family:Inter,sans-serif;font-weight:300;font-size:%?20?%;line-height:%?24?%;color:#989090;margin-bottom:%?20?%}.profile-bio-center[data-v-35c887f1]{font-family:Inter,sans-serif;font-weight:600;font-size:%?24?%;line-height:%?30?%;color:#000;text-align:left;margin-bottom:%?20?%}.profile-bottom-row[data-v-35c887f1]{display:flex;justify-content:space-between;align-items:center;width:100%;margin-bottom:%?10?%}.profile-buttons[data-v-35c887f1]{display:flex;align-items:center;gap:%?20?%}.profile-followers[data-v-35c887f1]{font-family:Inter,sans-serif;font-weight:300;font-size:%?24?%;line-height:%?30?%;color:#989090;margin:0}.edit-profile-btn[data-v-35c887f1]{position:relative;width:%?246?%;height:%?54?%;background:#d9d9d9;border-radius:%?10?%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background-color .2s ease}.edit-profile-btn[data-v-35c887f1]:active{background-color:silver}.edit-profile-btn uni-text[data-v-35c887f1]{font-family:Inter,sans-serif;font-weight:800;font-size:%?28?%;line-height:%?34?%;color:#fff}.profile-meta-center[data-v-35c887f1]{font-size:%?26?%;color:#666;margin-top:%?8?%;text-align:center}.profile-detail-card[data-v-35c887f1]{margin:0 %?30?% %?30?% %?30?%;padding:%?30?% %?40?%;background-color:#fff;border-radius:%?16?%;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.05);display:flex;flex-direction:row;align-items:center;justify-content:center;gap:%?40?%}.detail-item-inline[data-v-35c887f1]{font-size:%?28?%;color:#666;margin-right:%?20?%;white-space:nowrap}\r\n/* 底部加载状态样式 */.loading-footer[data-v-35c887f1]{text-align:center;padding:%?20?% 0;color:#999;font-size:14px}.unread-dot[data-v-35c887f1]{width:%?16?%;height:%?16?%;background-color:#ff6b6b;border-radius:50%;margin-left:%?12?%}\r\n/* Follow stats under bio */.follow-stats[data-v-35c887f1]{margin-top:%?16?%;display:flex;align-items:center;justify-content:center;gap:%?40?%}.stat-item[data-v-35c887f1]{display:flex;flex-direction:column;align-items:center}.stat-number[data-v-35c887f1]{font-size:%?36?%;font-weight:600;color:#333}.stat-label[data-v-35c887f1]{margin-top:%?4?%;font-size:%?24?%;color:#888}.stat-divider[data-v-35c887f1]{width:%?1?%;height:%?36?%;background-color:#eee}',""]),n.exports=r},"883d":function(n,r,t){t("7a76"),t("c9b5"),n.exports=function(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")},n.exports.__esModule=!0,n.exports["default"]=n.exports},"8ed6":function(n,r,t){var e=t("c86c");r=e(!1),r.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* components/skeleton/skeleton.wxss */.skeleton-wrapper[data-v-a51e8920]{width:100%;height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:%?20?%;box-sizing:border-box}\n/* 读诗页骨架屏卡片样式 - 匹配读诗页设计 */.skeleton-poem-card[data-v-a51e8920]{width:calc(100% - %?40?%);height:calc(100% - %?80?%);display:flex;flex-direction:column;padding:%?40?% %?20?%;box-sizing:border-box;background:hsla(0,0%,100%,.95);margin:%?40?% %?20?%;border-radius:%?24?%;box-shadow:0 %?8?% %?32?% rgba(0,0,0,.1);position:relative}\n/* 第二个卡片透明度降低 */.skeleton-poem-card.skeleton-secondary[data-v-a51e8920]{opacity:.6;position:absolute;top:%?20?%;left:%?20?%;right:%?20?%;bottom:%?20?%;z-index:-1;-webkit-transform:scale(.95);transform:scale(.95)}\n/* 原创标识骨架 */.skeleton-original-badge[data-v-a51e8920]{position:absolute;top:%?20?%;right:%?20?%;width:%?80?%;height:%?40?%;border-radius:%?20?%}\n/* 作者信息骨架 */.skeleton-author-info[data-v-a51e8920]{display:flex;align-items:center;margin-bottom:%?15?%;padding-bottom:%?10?%}.skeleton-avatar[data-v-a51e8920]{width:%?80?%;height:%?80?%;border-radius:50%;margin-right:%?20?%}.skeleton-name[data-v-a51e8920]{width:%?200?%;height:%?32?%;border-radius:%?16?%}\n/* 居中标题骨架 */.skeleton-title[data-v-a51e8920]{width:60%;height:%?40?%;margin:0 auto %?20?% auto; /* 居中并增加下边距 */border-radius:%?20?%;text-align:center}\n/* 大内容区域骨架 */.skeleton-content-large[data-v-a51e8920]{width:100%;height:%?40?%;margin-bottom:%?20?%;border-radius:%?20?%}.skeleton-animate[data-v-a51e8920]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0 50%,#f0f0f0 75%);background-size:200% 100%;-webkit-animation:skeleton-loading-data-v-a51e8920 1.5s infinite linear;animation:skeleton-loading-data-v-a51e8920 1.5s infinite linear}@-webkit-keyframes skeleton-loading-data-v-a51e8920{0%{background-position:200% 0}100%{background-position:-200% 0}}@keyframes skeleton-loading-data-v-a51e8920{0%{background-position:200% 0}100%{background-position:-200% 0}}",""]),n.exports=r},9322:function(n,r,t){"use strict";t.d(r,"b",(function(){return a})),t.d(r,"c",(function(){return o})),t.d(r,"a",(function(){return e}));var e={skeleton:t("71b6").default},a=function(){var n=this,r=n.$createElement,t=n._self._c||r;return t("v-uni-view",[t("v-uni-view",{staticClass:"container"},[n.isLoading?t("v-uni-view",[t("skeleton")],1):n._e(),t("v-uni-scroll-view",{staticClass:"scroll-container",attrs:{"wx:else":!0,"scroll-y":!0,"lower-threshold":"100",enhanced:!0,"show-scrollbar":!1},on:{scrolltolower:function(r){arguments[0]=r=n.$handleEvent(r),n.onScrollToLower.apply(void 0,arguments)}}},[n.isSidebarOpen?t("v-uni-view",{staticClass:"sidebar-mask",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.toggleSidebar.apply(void 0,arguments)}}}):n._e(),t("v-uni-view",{class:"sidebar "+(n.isSidebarOpen?"open":"")},[t("v-uni-view",{staticClass:"sidebar-header"},[t("v-uni-image",{staticClass:"sidebar-avatar",attrs:{src:n.userInfo.avatarUrl||"/static/images/avatar.png",mode:"aspectFill"},on:{error:function(r){arguments[0]=r=n.$handleEvent(r),n.onAvatarError.apply(void 0,arguments)}}}),t("v-uni-text",{staticClass:"sidebar-nickname"},[n._v(n._s(n.userInfo.nickName||"微信用户"))])],1),t("v-uni-view",{staticClass:"sidebar-menu"},[t("v-uni-view",{staticClass:"sidebar-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToEditProfile.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("修改资料")])],1),n.isAdmin?t("v-uni-view",{staticClass:"sidebar-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToImageManager.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("图片管理")])],1):n._e(),t("v-uni-view",{staticClass:"sidebar-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToMessages.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("消息通知")]),n.unreadCount>0?t("v-uni-view",{staticClass:"unread-badge"},[n._v(n._s(n.unreadCount))]):n._e()],1),t("v-uni-view",{staticClass:"sidebar-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToMyLikes.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("我的点赞")])],1),t("v-uni-view",{staticClass:"sidebar-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToFollowing.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("我关注的")])],1),t("v-uni-view",{staticClass:"sidebar-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToFans.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("我的粉丝")]),n.newFollowerCount>0?t("v-uni-view",{staticClass:"unread-dot"}):n._e()],1),t("v-uni-view",{staticClass:"sidebar-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToFavoriteFolders.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("我的收藏夹")])],1),t("v-uni-view",{staticClass:"sidebar-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToPortfolio.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("作品集")])],1),t("v-uni-view",{staticClass:"sidebar-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToDraftBox.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("草稿箱")])],1),t("v-uni-view",{staticClass:"sidebar-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToFeedback.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("意见反馈")])],1),n.isAdmin?t("v-uni-view",{staticClass:"sidebar-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToFeedbackAdmin.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("反馈管理")])],1):n._e(),t("v-uni-view",{staticClass:"sidebar-item logout-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.showLogoutConfirm.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("退出登录")])],1),t("v-uni-view",{staticClass:"follow-stats"},[t("v-uni-view",{staticClass:"stat-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToFollowing.apply(void 0,arguments)}}},[t("v-uni-text",{staticClass:"stat-number"},[n._v(n._s(n.followingCount))]),t("v-uni-text",{staticClass:"stat-label"},[n._v("关注")])],1),t("v-uni-view",{staticClass:"stat-divider"}),t("v-uni-view",{staticClass:"stat-item",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToFans.apply(void 0,arguments)}}},[t("v-uni-text",{staticClass:"stat-number"},[n._v(n._s(n.followerCount))]),t("v-uni-text",{staticClass:"stat-label"},[n._v("被关注")])],1)],1)],1)],1),t("v-uni-view",{staticClass:"main-content"},[t("v-uni-view",{staticClass:"profile-card profile-card-center"},[t("v-uni-view",{staticClass:"profile-avatar-large"},[t("v-uni-image",{attrs:{src:n.userInfo.avatarUrl||"/static/images/avatar.png",mode:"aspectFill"},on:{error:function(r){arguments[0]=r=n.$handleEvent(r),n.onAvatarError.apply(void 0,arguments)}}})],1),t("v-uni-view",{staticClass:"profile-info-center"},[t("v-uni-text",{staticClass:"profile-name-center"},[n._v(n._s(n.userInfo.nickName||"微信用户"))]),t("v-uni-text",{staticClass:"profile-poemid"},[n._v("poemid："+n._s(n.userInfo._openid||"未知"))]),t("v-uni-text",{staticClass:"profile-bio-center"},[n._v(n._s(n.userInfo.bio||"这个用户很懒,什么都没留下..."))]),t("v-uni-view",{staticClass:"profile-bottom-row"},[t("v-uni-text",{staticClass:"profile-followers"},[n._v("被关注数："+n._s(n.userInfo.followersCount||0))]),t("v-uni-view",{staticClass:"profile-buttons"},[t("v-uni-view",{staticClass:"edit-profile-btn",on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.navigateToEditProfile.apply(void 0,arguments)}}},[t("v-uni-text",[n._v("编辑主页")])],1),t("v-uni-image",{staticClass:"menu-btn-small",attrs:{src:"/static/images/icons/menu-icon.svg"},on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.toggleSidebar.apply(void 0,arguments)}}})],1)],1)],1)],1),n.isViewingSelf?t("v-uni-view",{staticClass:"profile-detail-card"},[t("v-uni-text",{staticClass:"detail-item-inline"},[n._v("生日:"+n._s(n.userInfo.birthday?n.userInfo.birthday:"未设置"))]),t("v-uni-text",{staticClass:"detail-item-inline"},[n._v("年龄:"+n._s(n.userInfo.age?n.userInfo.age+"岁":"未知"))])],1):n._e(),t("v-uni-view",{staticClass:"tab-navigation"},[t("v-uni-view",{class:"tab-item "+("posts"===n.currentTab?"active":""),attrs:{"data-tab":"posts"},on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.switchTab.apply(void 0,arguments)}}},[t("v-uni-image",{staticClass:"tab-icon",attrs:{src:"/static/images/我的帖子.png",mode:"aspectFit"}})],1),t("v-uni-view",{class:"tab-item "+("portfolio"===n.currentTab?"active":""),attrs:{"data-tab":"portfolio"},on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.switchTab.apply(void 0,arguments)}}},[t("v-uni-image",{staticClass:"tab-icon",attrs:{src:"/static/images/作品集.png",mode:"aspectFit"}})],1),t("v-uni-view",{class:"tab-item "+("favorites"===n.currentTab?"active":""),attrs:{"data-tab":"favorites"},on:{click:function(r){arguments[0]=r=n.$handleEvent(r),n.switchTab.apply(void 0,arguments)}}},[t("v-uni-image",{staticClass:"tab-icon",attrs:{src:"/static/images/我收藏的.png",mode:"aspectFit"}})],1)],1),"posts"===n.currentTab?t("v-uni-view",{staticClass:"my-posts-section"},[n.myPosts.length>0?[n._l(n.myPosts,(function(r,e){return t("v-uni-view",{key:e,class:"post-item-wrapper "+(r.isOriginal?"original-post":"")},[t("v-uni-view",{staticClass:"author-info-outside"},[r.authorAvatar?t("v-uni-image",{staticClass:"author-avatar",attrs:{src:r.authorAvatar,mode:"aspectFill","data-postindex":e,"data-user-id":r._openid},on:{error:function(r){arguments[0]=r=n.$handleEvent(r),n.onAvatarError.apply(void 0,arguments)},load:function(r){arguments[0]=r=n.$handleEvent(r),n.onAvatarLoad.apply(void 0,arguments)},click:function(r){r.stopPropagation(),r.preventDefault(),arguments[0]=r=n.$handleEvent(r),n.navigateToUserProfile.apply(void 0,arguments)}}}):n._e(),t("v-uni-text",{staticClass:"author-name"},[n._v(n._s(r.authorName))])],1),t("v-uni-navigator",{staticClass:"post-content-navigator",attrs:{url:"/pages/post-detail/post-detail?id="+r._id,"hover-class":"navigator-hover"}},[t("v-uni-view",{staticClass:"post-item"},[t("v-uni-view",{staticClass:"post-title"},[n._v(n._s(r.title))]),r.isPoem&&r.author?t("v-uni-view",{staticClass:"poem-author"},[n._v(n._s(r.author))]):n._e(),r.imageUrls&&r.imageUrls.length>0?t("v-uni-view",{staticClass:"image-container-wrapper",style:r.imageStyle,attrs:{"data-src":r.imageUrls[0],"data-original-image-urls":r.originalImageUrls||r.imageUrls},on:{click:function(r){r.stopPropagation(),r.preventDefault(),arguments[0]=r=n.$handleEvent(r),n.handlePreview.apply(void 0,arguments)}}},[1===r.imageUrls.length?[t("v-uni-image",{staticClass:"post-image",attrs:{id:"single-image-"+r._id,src:r.imageUrls[0],mode:"aspectFill","lazy-load":!0,"data-postid":r._id,"data-postindex":e,"data-imgindex":"0","data-type":"single"},on:{error:function(r){arguments[0]=r=n.$handleEvent(r),n.onImageError.apply(void 0,arguments)},load:function(r){arguments[0]=r=n.$handleEvent(r),n.onImageLoad.apply(void 0,arguments)}}})]:r.imageUrls.length>1?[t("v-uni-swiper",{staticClass:"image-swiper",style:"height: "+(n.swiperHeights[e]?n.swiperHeights[e]+"px":"220px")+";",attrs:{id:"swiper-"+r._id,"indicator-dots":!0,circular:!0}},[n._l(r.imageUrls,(function(a,o){return[t("v-uni-swiper-item",[t("v-uni-image",{staticClass:"post-image",attrs:{src:a,mode:"aspectFill","lazy-load":!0,"data-src":a,"data-original-image-urls":r.originalImageUrls||r.imageUrls,"data-postid":r._id,"data-postindex":e,"data-imgindex":o,"data-type":"multi"},on:{error:function(r){arguments[0]=r=n.$handleEvent(r),n.onImageError.apply(void 0,arguments)},load:function(r){arguments[0]=r=n.$handleEvent(r),n.onImageLoad.apply(void 0,arguments)},click:function(r){r.stopPropagation(),r.preventDefault(),arguments[0]=r=n.$handleEvent(r),n.handlePreview.apply(void 0,arguments)}}})],1)]}))],2)]:n._e()],2):n._e(),r.content?t("v-uni-view",{staticClass:"post-content",staticStyle:{"white-space":"pre-wrap"}},[n._v(n._s(r.content))]):n._e(),r.tags&&r.tags.length>0?t("v-uni-view",{staticClass:"post-tags"},n._l(r.tags,(function(r,e){return t("v-uni-text",{key:e,staticClass:"post-tag",attrs:{"data-tag":r},on:{click:function(r){r.stopPropagation(),r.preventDefault(),arguments[0]=r=n.$handleEvent(r),n.onTagClick.apply(void 0,arguments)}}},[n._v("#"+n._s(r))])})),1):n._e()],1)],1),t("v-uni-view",{staticClass:"delete-section"},[t("v-uni-view",{staticClass:"time-left"},[t("v-uni-text",{staticClass:"post-time"},[n._v("发布于"+n._s(r.formattedCreateTime||"未知时间"))])],1),t("v-uni-view",{staticClass:"button-group"},[t("v-uni-view",{staticClass:"delete-btn",attrs:{"data-postid":r._id,"data-index":e},on:{click:function(r){r.stopPropagation(),r.preventDefault(),arguments[0]=r=n.$handleEvent(r),n.onDelete.apply(void 0,arguments)}}},[t("v-uni-image",{staticClass:"delete-icon",attrs:{src:"/static/images/删除.png",mode:"aspectFit"}})],1)],1)],1)],1)})),t("v-uni-view",{staticClass:"loading-footer"},[n.isLoadingMore?[t("v-uni-text",[n._v("正在加载...")])]:!n.hasMore&&n.myPosts.length>0?[t("v-uni-text",[n._v("--- 我是有底线的 ---")])]:n._e()],2),t("v-uni-view",{staticStyle:{height:"200rpx"}})]:t("v-uni-view",{staticClass:"empty-tip"},[t("v-uni-text",[n._v("你还没有发布过帖子哦～")])],1)],2):n._e(),"favorites"===n.currentTab?t("v-uni-view",{staticClass:"favorites-section"},[n.favoriteList.length>0?[n._l(n.favoriteList,(function(r,e){return t("v-uni-view",{key:e,class:"post-item-wrapper "+(r.isOriginal?"original-post":"")},[t("v-uni-view",{staticClass:"author-info-outside"},[r.authorAvatar?t("v-uni-image",{staticClass:"author-avatar",attrs:{src:r.authorAvatar,mode:"aspectFill","data-postindex":e,"data-user-id":r._openid},on:{error:function(r){arguments[0]=r=n.$handleEvent(r),n.onAvatarError.apply(void 0,arguments)},load:function(r){arguments[0]=r=n.$handleEvent(r),n.onAvatarLoad.apply(void 0,arguments)},click:function(r){r.stopPropagation(),r.preventDefault(),arguments[0]=r=n.$handleEvent(r),n.navigateToUserProfile.apply(void 0,arguments)}}}):n._e(),t("v-uni-text",{staticClass:"author-name"},[n._v(n._s(r.authorName))])],1),t("v-uni-navigator",{staticClass:"post-content-navigator",attrs:{url:"/pages/post-detail/post-detail?id="+r._id,"hover-class":"navigator-hover"}},[t("v-uni-view",{staticClass:"post-item"},[t("v-uni-view",{staticClass:"post-title"},[n._v(n._s(r.title))]),r.isPoem&&r.author?t("v-uni-view",{staticClass:"poem-author"},[n._v(n._s(r.author))]):n._e(),r.imageUrls&&r.imageUrls.length>0?t("v-uni-view",{staticClass:"image-container-wrapper",style:r.imageStyle,attrs:{"data-src":r.imageUrls[0],"data-original-image-urls":r.originalImageUrls||r.imageUrls},on:{click:function(r){r.stopPropagation(),r.preventDefault(),arguments[0]=r=n.$handleEvent(r),n.handlePreview.apply(void 0,arguments)}}},[1===r.imageUrls.length?[t("v-uni-image",{staticClass:"post-image",attrs:{id:"single-image-"+r._id,src:r.imageUrls[0],mode:"aspectFill","lazy-load":!0,"data-postid":r._id,"data-postindex":e,"data-imgindex":"0","data-type":"single"},on:{error:function(r){arguments[0]=r=n.$handleEvent(r),n.onImageError.apply(void 0,arguments)},load:function(r){arguments[0]=r=n.$handleEvent(r),n.onImageLoad.apply(void 0,arguments)}}})]:r.imageUrls.length>1?[t("v-uni-swiper",{staticClass:"image-swiper",style:"height: "+(n.swiperHeights[e]?n.swiperHeights[e]+"px":"220px")+";",attrs:{id:"swiper-"+r._id,"indicator-dots":!0,circular:!0}},[n._l(r.imageUrls,(function(a,o){return[t("v-uni-swiper-item",[t("v-uni-image",{staticClass:"post-image",attrs:{src:a,mode:"aspectFill","lazy-load":!0,"data-src":a,"data-original-image-urls":r.originalImageUrls||r.imageUrls,"data-postid":r._id,"data-postindex":e,"data-imgindex":o,"data-type":"multi"},on:{error:function(r){arguments[0]=r=n.$handleEvent(r),n.onImageError.apply(void 0,arguments)},load:function(r){arguments[0]=r=n.$handleEvent(r),n.onImageLoad.apply(void 0,arguments)},click:function(r){r.stopPropagation(),r.preventDefault(),arguments[0]=r=n.$handleEvent(r),n.handlePreview.apply(void 0,arguments)}}})],1)]}))],2)]:n._e()],2):n._e(),r.content?t("v-uni-view",{staticClass:"post-content",staticStyle:{"white-space":"pre-wrap"}},[n._v(n._s(r.content))]):n._e(),r.tags&&r.tags.length>0?t("v-uni-view",{staticClass:"post-tags"},n._l(r.tags,(function(r,e){return t("v-uni-text",{key:e,staticClass:"post-tag",attrs:{"data-tag":r},on:{click:function(r){r.stopPropagation(),r.preventDefault(),arguments[0]=r=n.$handleEvent(r),n.onTagClick.apply(void 0,arguments)}}},[n._v("#"+n._s(r))])})),1):n._e()],1)],1),t("v-uni-view",{staticClass:"delete-section"},[t("v-uni-view",{staticClass:"time-left"},[t("v-uni-text",{staticClass:"favorite-time"},[n._v("收藏于"+n._s(r.formattedFavoriteTime||"未知时间"))])],1),t("v-uni-view",{staticClass:"button-group"},[t("v-uni-button",{staticClass:"remove-favorite-btn",attrs:{size:"mini","data-favorite-id":r.favoriteId,"data-index":e},on:{click:function(r){r.stopPropagation(),r.preventDefault(),arguments[0]=r=n.$handleEvent(r),n.removeFavorite.apply(void 0,arguments)}}},[n._v("取消收藏")])],1)],1)],1)})),t("v-uni-view",{staticClass:"loading-footer"},[n.favoriteLoading?[t("v-uni-text",[n._v("正在加载...")])]:!n.favoriteHasMore&&n.favoriteList.length>0?[t("v-uni-text",[n._v("--- 我是有底线的 ---")])]:n._e()],2),t("v-uni-view",{staticStyle:{height:"200rpx"}})]:t("v-uni-view",{staticClass:"empty-tip"},[t("v-uni-text",[n._v("你还没有收藏过内容哦～")])],1)],2):n._e(),"portfolio"===n.currentTab?t("v-uni-view",{staticClass:"portfolio-section"},[t("v-uni-view",{staticClass:"empty-tip"},[t("v-uni-text",[n._v("作品集页面还没建好，先留空")])],1)],1):n._e()],1)],1)],1),t("app-tab-bar",{ref:"customTabBar"})],1)},o=[]},ac8d:function(n,r,t){var e=t("d1b0");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);var a=t("967d").default;a("471ee932",e,!0,{sourceMap:!1,shadowMode:!1})},acbf:function(n,r,t){var e=t("5014").default,a=t("d189").default,o=t("883d").default,i=t("4db6").default;t("bf0f"),t("f3f7"),t("18f7"),t("de6c"),t("c223"),t("2797"),t("aa9c"),t("8f71"),t("fd3c"),t("dc8a"),t("9db6"),t("9327");var s=t("7ef8").default,l=t("38db"),c=l.cloudCall;function d(n){return s.namespace("follow:".concat(n),{persistent:!0,maxItems:4e3})}var f=function(){"use strict";function n(){o(this,n),this.loadingFollows=new Set}return i(n,[{key:"callCloudFunction",value:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(n,r,{pageTag:"followCache",requireAuth:!0})}},{key:"getFollowStatus",value:function(n,r){if(!n||!r||n===r)return Promise.resolve(null);var t=d(n).get(r);return t?(console.log("【关注缓存】命中缓存: ".concat(n," -> ").concat(r)),Promise.resolve(t)):this.loadingFollows.has("".concat(n,"_").concat(r))?(console.log("【关注缓存】正在加载中，等待: ".concat(n," -> ").concat(r)),this.waitForFollowLoad(n,r)):this.loadFollowStatus(n,r)}},{key:"waitForFollowLoad",value:function(n,r){var t=this;return new Promise((function(e){var a="".concat(n,"_").concat(r),o=setInterval((function(){if(!t.loadingFollows.has(a)){clearInterval(o);var i=d(n).get(r);e(i)}}),100);setTimeout((function(){clearInterval(o),t.loadingFollows.delete(a),e(null)}),3e3)}))}},{key:"loadFollowStatus",value:function(n,r){var t=this,e="".concat(n,"_").concat(r);return this.loadingFollows.add(e),console.log("【关注缓存】开始加载关注状态: ".concat(n," -> ").concat(r)),new Promise((function(a){t.callCloudFunction("follow",{action:"checkFollow",targetOpenid:r}).then((function(t){if(t.result&&t.result.success){var e={isFollowing:!!t.result.isFollowing,isFollowedByAuthor:!!t.result.isFollower,isMutualFollow:!!t.result.isMutual,lastUpdated:Date.now()};d(n).set(r,e,{ttlMs:36e5}),console.log("【关注缓存】加载并缓存成功: ".concat(n," -> ").concat(r),e),a(e)}else console.warn("【关注缓存】获取关注状态失败: ".concat(n," -> ").concat(r),t.result),a(null)})).catch((function(t){console.error("【关注缓存】加载关注状态失败: ".concat(n," -> ").concat(r),t),a(null)})).finally((function(){t.loadingFollows.delete(e)}))}))}},{key:"getBatchFollowStatus",value:function(n,r){var t=this;if(!n||!r||0===r.length)return Promise.resolve({});var e={},a=[];return r.forEach((function(r){if(r!==n){var t=d(n).get(r);t?e[r]=t:a.push(r)}})),a.length>0?(console.log("【关注缓存】批量加载关注状态: ".concat(a.length,"个")),new Promise((function(r){t.callCloudFunction("getBatchFollowStatus",{currentUserId:n,targetUserIds:a}).then((function(t){t.result&&t.result.success&&t.result.followStatuses&&t.result.followStatuses.forEach((function(r){if(r&&r.targetUserId){var t={isFollowing:!!r.isFollowing,isFollowedByAuthor:!!r.isFollowedByAuthor,isMutualFollow:!!r.isMutualFollow,lastUpdated:Date.now()};e[r.targetUserId]=t,d(n).set(r.targetUserId,t,{ttlMs:36e5})}})),r(e)})).catch((function(n){console.error("【关注缓存】批量加载失败:",n),r(e)}))}))):Promise.resolve(e)}},{key:"preloadFollowStatusFromPosts",value:function(n,r){var t=this;if(n&&0!==n.length&&r){var e=a(new Set(n.map((function(n){return n._openid})).filter((function(n){return n&&n!==r}))));0!==e.length&&setTimeout((function(){t.getBatchFollowStatus(r,e).then((function(n){console.log("【关注缓存】预加载完成: ".concat(Object.keys(n).length,"个关注状态"))}))}),100)}}},{key:"updateFollowStatus",value:function(n,r,t){if(!n||!r||!t)return!1;var a=e(e({},t),{},{lastUpdated:Date.now()});try{return d(n).set(r,a,{ttlMs:36e5}),!0}catch(o){return!1}}},{key:"toggleFollowStatus",value:function(n,r){var t=this;return n&&r&&n!==r?new Promise((function(e){t.callCloudFunction("follow",{action:"toggleFollow",targetOpenid:r}).then((function(a){if(a.result&&a.result.success){var o={isFollowing:!!a.result.isFollowing,isFollowedByAuthor:!!a.result.isFollower,isMutualFollow:!!a.result.isMutual,lastUpdated:Date.now()};t.updateFollowStatus(n,r,o),console.log("【关注缓存】切换关注状态成功: ".concat(n," -> ").concat(r),o),e(o)}else console.warn("【关注缓存】切换关注状态失败: ".concat(n," -> ").concat(r),a.result),e(null)})).catch((function(t){console.error("【关注缓存】切换关注状态失败: ".concat(n," -> ").concat(r),t),e(null)}))})):Promise.resolve(null)}},{key:"clearUserFollowCache",value:function(n){if(!n)return!1;try{return d(n).clear(),!0}catch(r){return console.log("CatchClause",r),console.log("CatchClause",r),console.error("清理用户关注缓存失败:",r),!1}}},{key:"clearAllFollowCache",value:function(){try{var n=uni.getStorageInfoSync&&uni.getStorageInfoSync(),r=n&&n.keys||[];return r.forEach((function(n){if("string"===typeof n&&n.startsWith("__cm__:follow:")&&n.endsWith(":__keys__")){var r=n.substring("__cm__:".length,n.length-":__keys__".length);try{s.namespace(r,{persistent:!0}).clear()}catch(t){}}})),!0}catch(t){return console.log("CatchClause",t),console.log("CatchClause",t),console.error("清理所有关注缓存失败:",t),!1}}}]),n}(),u=new f;n.exports=u},c03a:function(n,r,t){"use strict";t("6a54"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={data:function(){return{}},props:{},methods:{},created:function(){}}},d1b0:function(n,r,t){var e=t("c86c");r=e(!1),r.push([n.i,".tab-bar[data-v-846b9078]{position:fixed;bottom:0;left:0;width:100%;height:%?120?%;display:flex;align-items:center;justify-content:space-around;z-index:1000;background:#fff}.tab-bar-item[data-v-846b9078]{display:flex;flex-direction:column;align-items:center;justify-content:center;flex:1;height:100%}.icon-wrap[data-v-846b9078]{width:%?88?%;height:%?88?%;border-radius:%?24?%;background:#f8f8f8;overflow:hidden;box-shadow:0 %?18?% %?32?% rgba(0,0,0,.16);transition:box-shadow .22s ease}.icon-wrap.pressed[data-v-846b9078]{box-shadow:0 %?6?% %?12?% rgba(0,0,0,.08)}.icon-inner[data-v-846b9078]{width:100%;height:100%;background:#fff;box-shadow:none;transition:box-shadow .22s ease,-webkit-transform .22s ease;transition:transform .22s ease,box-shadow .22s ease;transition:transform .22s ease,box-shadow .22s ease,-webkit-transform .22s ease}.icon-inner.active[data-v-846b9078]{box-shadow:inset 0 %?10?% %?20?% rgba(0,0,0,.22);-webkit-transform:translateY(%?3?%) scale(.97);transform:translateY(%?3?%) scale(.97)}.icon-img[data-v-846b9078]{width:100%;height:100%;display:block}.tab-bar-text[data-v-846b9078]{font-size:%?22?%;color:transparent;height:0;overflow:hidden}",""]),n.exports=r},d2dd:function(n,r,t){"use strict";t("6a54");var e=t("f5bd").default;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=e(t("2634")),o=e(t("2fdc")),i=e(t("5de6")),s=e(t("39d8"));t("bf0f"),t("fd3c"),t("2797"),t("c223"),t("8f71"),t("bd06"),t("9db6"),t("18f7"),t("de6c");var l=e(t("724b")),c=t("b577"),d=t("7a3b"),f=(getApp(),t("962f")),u=f.formatRelativeTime,g=t("edf3"),v=g.previewImage,h=t("38db"),p=h.cloudCall,m=t("9c8b"),b={components:{AppTabBar:l.default},mixins:[m],data:function(){return{isLoading:!0,userInfo:{avatarUrl:"",nickName:"",bio:"",birthday:!1,age:!1},isSidebarOpen:!1,myPosts:[],page:0,hasMore:!0,PAGE_SIZE:5,swiperHeights:{},imageClampHeights:{},hasFirstShow_var:!1,unreadCount:0,currentTab:"posts",favoriteList:[],favoritePage:0,favoriteHasMore:!0,favoriteLoading:!1,currentUserOpenid:"",isAdmin:!1,swiperFixedHeight:"",selected:0,newFollowerCount:"",isLoadingMore:!1,isViewingSelf:!1,imgindex:0,img:"",followingCount:0,followerCount:0}},onLoad:function(n){var r=uni.getSystemInfoSync().windowWidth,t=Math.round(4*r/3);this.setData({swiperFixedHeight:t}),this.getProfileData()},onShow:function(){try{uni.hideTabBar({animation:!1})}catch(e){}try{this.$refs.customTabBar&&this.$refs.customTabBar.syncSelected&&this.$refs.customTabBar.syncSelected()}catch(e){}var n=t("26a8"),r=n.updateTabBarStatus;r(this,3),this._hasFirstShow?(console.log("【profile】onShow触发,开始刷新数据"),this.refreshProfileData()):(console.log("【profile】首次显示,标记已显示"),this.setData({hasFirstShow_var:!0}))},onPullDownRefresh:function(){var n=this;console.log("【profile】⬇️ ⬇️ ⬇️ 下拉刷新触发！"),console.log("【profile】📊 当前标签:",this.currentTab),console.log("【profile】📋 刷新前myPosts长度:",this.myPosts.length),console.log("【profile】📋 刷新前favoriteList长度:",this.favoriteList.length),"posts"===this.currentTab?(console.log("【profile】🔄 重置帖子数据状态"),this.setData({myPosts:[],page:0,hasMore:!0,swiperHeights:{},imageClampHeights:{}}),console.log("【profile】🔄 开始加载帖子数据（强制云端）"),this.loadMyPosts((function(){console.log("【profile】✅ 下拉刷新完成，停止刷新动画"),console.log("【profile】📊 刷新后myPosts长度:",n.myPosts.length),uni.stopPullDownRefresh()}),!0)):"favorites"===this.currentTab&&(console.log("【profile】🔄 重置收藏数据状态"),this.setData({favoriteList:[],favoritePage:0,favoriteHasMore:!0,swiperHeights:{},imageClampHeights:{}}),console.log("【profile】🔄 开始加载收藏数据"),this.loadFavorites((function(){console.log("【profile】✅ 收藏下拉刷新完成，停止刷新动画"),console.log("【profile】📊 刷新后favoriteList长度:",n.favoriteList.length),uni.stopPullDownRefresh()})))},onReachBottom:function(){if(console.log("【profile】触底加载触发, currentTab:",this.currentTab),"posts"===this.currentTab){if(console.log("【profile】触底加载我的帖子, hasMore:",this.hasMore,"isLoading:",this.isLoading,"当前页:",this.page),!this.hasMore||this.isLoading)return;this.loadMyPosts()}else if("favorites"===this.currentTab){if(console.log("【profile】触底加载收藏, favoriteHasMore:",this.favoriteHasMore,"favoriteLoading:",this.favoriteLoading),!this.favoriteHasMore||this.favoriteLoading)return;this.loadFavorites()}},methods:{getProfileData:function(){this.checkLoginAndFetchData()},invalidateProfileCacheAndReload:function(){console.log("【profile】🧹 开始清除个人主页缓存"),console.log("【profile】📊 当前标签页:",this.currentTab),console.log("【profile】📋 当前myPosts长度:",this.myPosts.length);try{console.log("【profile】🗑️ 调用invalidateMyPosts()"),(0,c.invalidateMyPosts)(),console.log("【profile】🗑️ 调用invalidateMyInfo()"),(0,c.invalidateMyInfo)(),"favorites"===this.currentTab&&(console.log("【profile】🗑️ 调用invalidateMyFavorites()"),(0,c.invalidateMyFavorites)()),console.log("【profile】✅ 个人主页缓存清除完成"),console.log("【profile】🔍 缓存清除后myPosts长度:",this.myPosts.length)}catch(n){console.warn("【profile】❌ 清除缓存失败:",n)}},refreshProfileData:function(){console.log("【profile】🔄 开始刷新个人资料数据，当前标签:",this.currentTab);var n=uni.getStorageSync("shouldRefreshIndex"),r=uni.getStorageSync("shouldRefreshProfile"),t=uni.getStorageSync("shouldRefreshPoem"),e=uni.getStorageSync("shouldRefreshMountain");console.log("【profile】🔍 检查刷新标记:",{shouldRefreshIndex:n,shouldRefreshProfile:r,shouldRefreshPoem:t,shouldRefreshMountain:e}),n||r||t||e?(console.log("【profile】✅ 检测到需要刷新标记，开始刷新个人主页数据"),uni.removeStorageSync("shouldRefreshIndex"),uni.removeStorageSync("shouldRefreshProfile"),uni.removeStorageSync("shouldRefreshPoem"),uni.removeStorageSync("shouldRefreshMountain"),console.log("【profile】🗑️ 已清除所有刷新标记"),this.invalidateProfileCacheAndReload()):console.log("【profile】⏭️ 无刷新标记，跳过缓存清理"),this.userInfo&&this.userInfo._openid&&(this.fetchUserProfileFast(),this.fetchFollowCounts()),"posts"===this.currentTab?(this.setData({myPosts:[],page:0,hasMore:!0,swiperHeights:{},imageClampHeights:{}}),this.loadMyPosts((function(){console.log("【profile】🔄 onShow刷新帖子数据完成（强制云端）")}),!0)):"favorites"===this.currentTab&&(this.setData({favoriteList:[],favoritePage:0,favoriteHasMore:!0,swiperHeights:{},imageClampHeights:{}}),this.loadFavorites((function(){console.log("【profile】🔄 onShow刷新收藏数据完成")}))),this.checkUnreadMessages();try{this.fetchFollowCounts&&this.fetchFollowCounts()}catch(a){}},forceRefresh:function(){console.log("强制刷新数据"),this.setData({userInfo:{},myPosts:[],isLoading:!0,swiperHeights:{},imageClampHeights:{}}),this.checkLoginAndFetchData()},checkLoginAndFetchData:function(){var n=this;if(!this._cacheEventsBound){this._cacheEventsBound=!0;try{uni.$on&&uni.$on("avatar-updated",(function(r){var t=getApp(),e=t&&t.globalData&&t.globalData.openid;r&&r.userId===e&&((0,c.invalidateMyInfo)(),(0,c.getMyInfo)(n).then((function(r){return n.setData({userInfo:r||{}})})).catch((function(){})))})),uni.$on&&uni.$on("post-created",(function(r){var t=getApp(),e=t&&t.globalData&&t.globalData.openid;r&&r.userId===e&&((0,c.invalidateMyPosts)(),n.setData({myPosts:[],page:0,hasMore:!0}),n.loadMyPosts())})),uni.$on&&uni.$on("favorite-changed",(function(r){var t=getApp(),e=t&&t.globalData&&t.globalData.openid;r&&r.userId===e&&((0,c.invalidateMyFavorites)(),"favorites"===n.currentTab&&(n.setData({favoriteList:[],favoritePage:0,favoriteHasMore:!0}),n.loadFavorites()))}))}catch(a){}}var r=getApp(),t=r.globalData&&r.globalData.userInfo,e=r.globalData&&r.globalData._loginProcessCompleted;console.log("🔍 [profile] 检查登录状态:",{hasUserInfo:!!t,hasOpenid:!(!t||!t._openid),loginProcessCompleted:e}),t&&t._openid?(this.fetchUserProfileFast(),this.loadMyPosts()):e?(this.setData({isLoading:!1}),console.log("⚠️ [profile] 登录流程已完成但无用户信息，用户未登录")):(console.log("⏳ [profile] 登录流程未完成，等待中..."),this.waitForLoginProcess())},waitForLoginProcess:function(){var n=this,r=setInterval((function(){var t=getApp(),e=t.globalData&&t.globalData._loginProcessCompleted;e&&(clearInterval(r),console.log("✅ [profile] 登录流程已完成，重新检查登录状态"),n.checkLoginAndFetchData())}),100);setTimeout((function(){clearInterval(r),console.log("⚠️ [profile] 等待登录流程超时，继续执行"),n.checkLoginAndFetchData()}),5e3)},fetchUserProfileFast:function(){var n=this;(0,c.getMyInfo)(this).then((function(r){r&&r.birthday?r.age=n.calculateAge(r.birthday):r&&(r.age=""),n.setData({userInfo:r||{},isLoading:!1})})).catch((function(r){console.error("获取用户资料失败（缓存封装）:",r),n.setData({isLoading:!1});var t=uni.getStorageSync("userInfo");t?(t.birthday&&(t.age=n.calculateAge(t.birthday)),n.setData({userInfo:t})):uni.showToast({title:"获取数据失败",icon:"none"})}))},loadMyPosts:function(n){var r=this,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=this.page,a=this.PAGE_SIZE;console.log("【profile】🔍 开始loadMyPosts, 页面信息:",{page:e,PAGE_SIZE:a,skip:e*a,limit:a,isPullDownRefresh:0===e,forceRefresh:t,currentMyPostsLength:this.myPosts.length}),0===e&&(console.log("【profile】📱 重置数据状态",t?"(强制刷新模式)":"(正常模式)"),this.setData({isLoading:!0}));var o=getApp(),i=o&&o.globalData&&o.globalData.openid;if(console.log("【profile】👤 当前用户openid:",i),0===e||t)return console.log("【profile】🔥 下拉刷新/强制刷新，直接从云端获取最新数据"),this.loadMyPostsDirectly(e,a,i,n);console.log("【profile】🚀 使用缓存API获取帖子（分页加载）");try{return(0,c.getMyPosts)({page:e,pageSize:a,context:this}).then((function(n){console.log("【profile】✅ 缓存API成功返回帖子数量:",n.length),console.log("【profile】📋 缓存API返回的帖子ID列表:",n.map((function(n){return n._id}))),n.forEach((function(n,t){n.createTime&&(n.formattedCreateTime=r.formatTime(n.createTime)),n.imageUrls&&n.imageUrls.length>0&&(n.imageStyle="height: 0; padding-bottom: 75%;"),console.log("【profile】📝 缓存帖子".concat(t+1,":"),{id:n._id,title:n.title,createTime:n.createTime,formattedTime:n.formattedCreateTime})}));var t=0===e?n:r.myPosts.concat(n);return console.log("【profile】📊 缓存API更新myPosts数据:",{beforeLength:r.myPosts.length,afterLength:t.length,page:e+1,hasMore:n.length===a}),r.setData({myPosts:t,page:e+1,hasMore:n.length===a}),console.log("【profile】✅ 缓存API加载完成"),n})).catch((function(t){return console.error("【profile】❌ 缓存API获取帖子失败，回退到云函数:",t),r.loadMyPostsDirectly(e,a,i,n)})).finally((function(){r.setData({isLoading:!1}),"function"===typeof n&&(console.log("【profile】🎯 缓存API loadMyPosts完成，调用回调"),n())}))}catch(s){return console.error("【profile】❌ 缓存API调用异常，回退到云函数:",s),this.loadMyPostsDirectly(e,a,i,n)}},loadMyPostsDirectly:function(n,r,t,e){var a=this;console.log("【profile】🔥 直接调用云函数getMyProfileData"),console.log("【profile】📤 云函数参数:",{name:"getMyProfileData",data:{skip:n*r,limit:r,openid:t}}),this.$tcb.callFunction({name:"getMyProfileData",data:{skip:n*r,limit:r,openid:t}}).then((function(t){if(console.log("【profile】📥 云函数返回完整响应:",t),t.result&&t.result.success){var e=t.result.posts||[];console.log("【profile】✅ 云函数成功返回帖子数量:",e.length),console.log("【profile】📋 云函数返回的帖子ID列表:",e.map((function(n){return n._id}))),e.forEach((function(n,r){n.createTime&&(n.formattedCreateTime=a.formatTime(n.createTime)),n.imageUrls&&n.imageUrls.length>0&&(n.imageStyle="height: 0; padding-bottom: 75%;"),console.log("【profile】📝 云函数帖子".concat(r+1,":"),{id:n._id,title:n.title,createTime:n.createTime,formattedTime:n.formattedCreateTime})}));var o=0===n?e:a.myPosts.concat(e);console.log("【profile】📊 云函数更新myPosts数据:",{beforeLength:a.myPosts.length,afterLength:o.length,page:n+1,hasMore:e.length===r}),a.setData({myPosts:o,page:n+1,hasMore:e.length===r})}else{var i;console.error("【profile】❌ 云函数返回失败:",t.result),uni.showToast({title:(null===(i=t.result)||void 0===i?void 0:i.message)||"获取数据失败",icon:"none"})}})).catch((function(n){console.error("【profile】❌ 云函数调用失败:",n),uni.showToast({title:"网络错误",icon:"none"})})).finally((function(){a.setData({isLoading:!1}),"function"===typeof e&&(console.log("【profile】🎯 云函数loadMyPosts完成，调用回调"),e())}))},calculateAge:function(n){if(!n)return"";try{var r=new Date(n);if(isNaN(r.getTime()))return"";var t=new Date,e=t.getFullYear()-r.getFullYear(),a=t.getMonth()-r.getMonth();return(a<0||0===a&&t.getDate()<r.getDate())&&e--,e>0?e:""}catch(o){return console.log("CatchClause",o),console.log("CatchClause",o),console.error("计算年龄失败:",o),""}},formatTime:function(n){return u(n)},navigateToPostDetail:function(n){var r=n.currentTarget.dataset.id;uni.navigateTo({url:"/pages/post-detail/post-detail?id=".concat(r)})},onDelete:function(n){var r=n.currentTarget.dataset.postid,t=n.currentTarget.dataset.index,e=this;uni.showModal({title:"删除帖子",content:"您确定要删除这条帖子吗？",confirmText:"删除",cancelText:"保存草稿",confirmColor:"#ff4d4f",success:function(n){n.confirm?e.deletePost(r,t):e.saveToDraftBox(r,t)}})},deletePost:function(n,r){var t=this;uni.showLoading({title:"删除中..."}),this.$tcb.callFunction({name:"deletePost",data:{postId:n}}).then((function(r){if(uni.hideLoading(),r.result&&r.result.success){uni.showToast({title:"删除成功"});var e=t.myPosts.filter((function(r){return r._id!==n}));t.setData({myPosts:e});try{uni.setStorageSync("shouldRefreshIndex",!0)}catch(a){console.log("CatchClause",a),console.log("CatchClause",a)}}else uni.showToast({title:"删除失败",icon:"none"})})).catch((function(n){uni.hideLoading(),uni.showToast({title:"调用失败",icon:"none"})}))},saveToDraftBox:function(n,r){var t=this,e=this;uni.showLoading({title:"保存中..."}),this.$tcb.callFunction({name:"getPostDetail",data:{postId:n}}).then((function(n){if(n.result&&n.result.post){var r=n.result.post,e={title:r.title||"",content:r.content||"",imageList:r.imageUrls?r.imageUrls.map((function(n){return{previewUrl:n,compressedPath:n,originalPath:n,needCompression:!1}})):[],publishMode:r.isPoem?"poem":"normal",isOriginal:r.isOriginal||!1,selectedTags:r.tags||[],customTag:"",author:r.author||"",saveTime:new Date},a=getApp(),o=a&&a.globalData&&a.globalData.openid;return t.$tcb.callFunction({name:"getMyProfileData",data:{action:"saveDraft",draftData:e,openid:o}})}return uni.hideLoading(),uni.showToast({title:"获取帖子信息失败",icon:"none"}),Promise.reject("获取帖子信息失败")})).then((function(t){var a;(uni.hideLoading(),t.result&&t.result.success)?(uni.showToast({title:"已保存到草稿箱",icon:"success"}),e.deletePost(n,r)):uni.showToast({title:(null===(a=t.result)||void 0===a?void 0:a.message)||"保存草稿失败",icon:"none"})})).catch((function(n){uni.hideLoading(),console.error("保存草稿失败:",n),uni.showToast({title:"保存草稿失败",icon:"none"})}))},updatePostCommentCount:function(n,r){var t=this.myPosts.findIndex((function(r){return r._id===n}));t>-1&&this.setData((0,s.default)({},"myPosts[".concat(t,"].commentCount"),r))},handlePreview:function(n){return v(n)},stopPropagation:function(){},onAvatarError:function(n){console.error("头像加载失败:",n)},onImageError:function(n){console.error("图片加载失败:",n.detail);var r=n.detail.src;console.error("失败的图片URL:",r);var t=n.currentTarget.dataset,e=t.postindex,a=t.imgindex;if(void 0!==e&&void 0!==a){var o=this.myPosts[e];console.error("图片加载失败的上下文:",{postId:o?o._id:"unknown",postTitle:o?o.title:"unknown",imageIndex:a,imageUrl:r})}console.error("图片加载失败详情:",{error:n.detail,src:r,dataset:n.currentTarget.dataset})},testImageUrls:function(){console.log("=== 开始测试图片URL有效性 ==="),this.myPosts.forEach((function(n,r){console.log("帖子".concat(r+1," (").concat(n._id,"):")),console.log("  - 标题:",n.title),console.log("  - 作者头像:",n.authorAvatar),console.log("  - 图片URLs:",n.imageUrls),console.log("  - 原图URLs:",n.originalImageUrls),n.imageUrls&&n.imageUrls.length>0?n.imageUrls.forEach((function(n,r){console.log("  - 图片".concat(r+1,":"),n),n&&n.startsWith("http")?console.log("    ✅ 格式正确 (HTTP URL)"):n&&n.startsWith("cloud://")?console.log("    ⚠️ 格式为cloud:// (需要转换)"):n?console.log("    ? 未知格式: ".concat(n)):console.log("    ❌ URL为空")})):console.log("  - 无图片"),console.log("---")})),console.log("=== 图片URL测试完成 ===")},toggleSidebar:function(){this.setData({isSidebarOpen:!this.isSidebarOpen})},navigateToMyLikes:function(){uni.navigateTo({url:"/pages/my-likes/my-likes"})},navigateToFollowing:function(){uni.navigateTo({url:"/pages/following/following"})},navigateToFans:function(){uni.navigateTo({url:"/pages/fans/fans"})},navigateToEditProfile:function(){uni.navigateTo({url:"/pages/profile-edit/profile-edit"})},navigateToFavoriteFolders:function(){uni.navigateTo({url:"/pages/favorite-folders/favorite-folders"})},navigateToPortfolio:function(){uni.navigateTo({url:"/pages/portfolio/portfolio"})},navigateToDraftBox:function(){uni.navigateTo({url:"/pages/draft-box/draft-box"})},navigateToMessages:function(){uni.navigateTo({url:"/pages/messages/messages"})},checkUnreadMessages:function(){var n=this;this.$tcb.callFunction({name:"getUnreadMessageCount"}).then((function(r){r.result&&r.result.success&&n.setData({unreadCount:r.result.count||0})})).catch((function(n){console.error("获取未读消息失败:",n)})),this.$tcb.callFunction({name:"follow",data:{action:"getNewFollowerCount"}}).then((function(r){r.result&&r.result.success&&n.setData({newFollowerCount:r.result.count||0})})).catch((function(n){console.error("获取新粉丝数量失败:",n)}))},fetchFollowCounts:function(){var n=this;try{var r=this.$tcb.callFunction({name:"follow",data:{action:"getFollowingList",skip:0,limit:1}}),t=this.$tcb.callFunction({name:"follow",data:{action:"getFollowerList",skip:0,limit:1}});Promise.all([r,t]).then((function(r){var t=(0,i.default)(r,2),e=t[0],a=t[1],o=e&&e.result&&e.result.total||0,s=a&&a.result&&a.result.total||0;n.setData({followingCount:o,followerCount:s})})).catch((function(n){console.error("fetch follow stats failed:",n)}))}catch(e){console.error("fetchFollowCounts error:",e)}},switchTab:function(n){var r=n.currentTarget.dataset.tab;console.log("【profile】切换到标签:",r),r!==this.currentTab&&(this.setData({currentTab:r}),"favorites"===r&&0===this.favoriteList.length&&this.loadFavorites())},loadFavorites:function(n){var r=this,t=this.favoritePage,e=this.PAGE_SIZE;console.log("【profile】请求收藏分页参数:",{favoritePage:t,PAGE_SIZE:e,skip:t*e,limit:e}),this.setData({favoriteLoading:!0});try{return(0,c.getMyFavorites)({page:t,pageSize:e,context:this}).then((function(n){(n||[]).forEach((function(n){n.favoriteTime&&(n.formattedFavoriteTime=r.formatTime(n.favoriteTime)),n.imageUrls&&n.imageUrls.length>0&&(n.imageStyle="height: 0; padding-bottom: 75%;")}));var a=0===t?n:r.favoriteList.concat(n||[]);r.setData({favoriteList:a,favoritePage:t+1,favoriteHasMore:(n||[]).length===e})})).catch((function(n){console.error("profile 获取收藏失败:",n),uni.showToast({title:"网络异常",icon:"none"})})).finally((function(){r.setData({favoriteLoading:!1}),"function"===typeof n&&n()}))}catch(i){}var a=getApp(),o=a&&a.globalData&&a.globalData.openid;this.$tcb.callFunction({name:"getMyProfileData",data:{action:"getAllFavorites",skip:t*e,limit:e,openid:o}}).then((function(n){if(console.log("【profile】获取收藏返回:",n),n.result&&n.result.success){var a=n.result.favorites||[];console.log("【profile】本次返回收藏数量:",a.length),a.forEach((function(n){n.favoriteTime&&(n.formattedFavoriteTime=r.formatTime(n.favoriteTime)),n.imageUrls&&n.imageUrls.length>0&&(n.imageStyle="height: 0; padding-bottom: 75%;")}));var o=0===t?a:r.favoriteList.concat(a);console.log("【profile】更新后收藏列表长度:",o.length,"favoriteHasMore:",a.length===e,"favoritePage:",t+1),r.setData({favoriteList:o,favoritePage:t+1,favoriteHasMore:a.length===e})}else{var i;uni.showToast({title:(null===(i=n.result)||void 0===i?void 0:i.message)||"加载收藏失败",icon:"none"})}})).catch((function(n){console.error("【profile】获取收藏失败:",n),uni.showToast({title:"网络错误",icon:"none"})})).finally((function(){r.setData({favoriteLoading:!1}),"function"===typeof n&&n()}))},navigateToFavoriteDetail:function(n){var r=n.currentTarget.dataset.id;uni.navigateTo({url:"/pages/post-detail/post-detail?id=".concat(r)})},removeFavorite:function(n){var r=n.currentTarget.dataset.favoriteId,e=n.currentTarget.dataset.index,a=this;uni.showModal({title:"确认取消收藏",content:"确定要取消收藏这个内容吗？",success:function(o){if(o.confirm){uni.showLoading({title:"取消收藏中..."});var i=getApp(),s=i&&i.globalData&&i.globalData.openid;a.callCloudFunction("getMyProfileData",{action:"removeFromFavorite",favoriteId:r,openid:s}).then((function(r){if(uni.hideLoading(),r.result&&r.result.success){uni.showToast({title:"已取消收藏"});var o=a.favoriteList.filter((function(n,r){return r!==e}));a.setData({favoriteList:o});try{var i=getApp(),s=i&&i.globalData&&i.globalData.openid,l=a.favoriteList[e],c=l&&(l._id||l.postId),d=t("2729"),f=d.emitFavoriteChanged;f({userId:s,postId:c,favored:!1})}catch(n){}}else uni.showToast({title:"取消收藏失败",icon:"none"})})).catch((function(n){uni.hideLoading(),uni.showToast({title:"操作失败",icon:"none"})}))}}})},navigateBack:function(){uni.navigateBack()},navigateToImageManager:function(){uni.navigateTo({url:"/pages/image-manager/image-manager"})},navigateToFeedback:function(){uni.navigateTo({url:"/pages/feedback/feedback"})},navigateToFeedbackAdmin:function(){uni.navigateTo({url:"/pages/feedback-admin/feedback-admin"})},showLogoutConfirm:function(){var n=this;this.isSidebarOpen&&(this.isSidebarOpen=!1),setTimeout((function(){uni.showModal({title:"退出登录",content:"确定要退出登录吗？",confirmText:"退出",cancelText:"取消",confirmColor:"#ff6b6b",success:function(r){r.confirm&&n.performLogout()}})}),100)},performLogout:function(){var n=(0,o.default)((0,a.default)().mark((function n(){var r;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("🔍 [退出登录] 开始执行退出登录流程"),n.prev=1,n.prev=2,n.next=5,(0,d.resetAllCachesOnAccountChange)({});case 5:n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](2),console.warn("cache reset on logout failed",n.t0);case 10:uni.removeStorageSync("userInfo"),uni.removeStorageSync("userOpenId"),r=getApp(),r&&r.globalData&&(r.globalData.userInfo=null,r.globalData.openid=null,r.globalData._loginProcessCompleted=!1),this.setData({userInfo:null,myPosts:[],favoriteList:[],isLoading:!1,isSidebarOpen:!1}),console.log("✅ [退出登录] 本地数据清除完成"),this.reinitializeAnonymousOpenid(),uni.showToast({title:"已退出登录",icon:"success",duration:1500}),setTimeout((function(){uni.redirectTo({url:"/pages/login/login"})}),1500),n.next=25;break;case 21:n.prev=21,n.t1=n["catch"](1),console.error("❌ [退出登录] 退出登录失败:",n.t1),uni.showToast({title:"退出失败，请重试",icon:"none"});case 25:case"end":return n.stop()}}),n,this,[[1,21],[2,7]])})));return function(){return n.apply(this,arguments)}}(),reinitializeAnonymousOpenid:function(){console.log("🔄 [退出登录] 重新初始化匿名openid"),this.$tcb.callFunction({name:"login"}).then((function(n){console.log("✅ [退出登录] 匿名openid初始化成功:",n);var r=null;if(n.result&&n.result.openid?r=n.result.openid:n.openid?r=n.openid:n.result&&n.result.uid&&(r=n.result.uid),r){var t=getApp();t&&t.globalData&&(t.globalData.openid=r,console.log("✅ [退出登录] 匿名openid已设置:",r)),uni.setStorageSync("userOpenId",r)}else console.error("❌ [退出登录] 无法获取匿名openid")})).catch((function(n){console.error("❌ [退出登录] 匿名openid初始化失败:",n)}))},onScrollToLower:function(){var n=this;console.log("【profile】滚动到底部，当前标签:",this.currentTab),"posts"===this.currentTab?!this.hasMore||this.isLoadingMore||this.isLoading||(console.log("【profile】开始加载更多帖子"),this.setData({isLoadingMore:!0}),this.loadMyPosts((function(){n.setData({isLoadingMore:!1}),console.log("【profile】加载更多帖子完成")}))):"favorites"===this.currentTab&&this.favoriteHasMore&&!this.favoriteLoading&&(console.log("【profile】开始加载更多收藏"),this.loadFavorites((function(){console.log("【profile】加载更多收藏完成")})))},onAvatarLoad:function(){console.log("占位：函数 onAvatarLoad 未声明")},navigateToUserProfile:function(){console.log("占位：函数 navigateToUserProfile 未声明")},onTagClick:function(){console.log("占位：函数 onTagClick 未声明")},callCloudFunction:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return p(n,r,Object.assign({pageTag:"profile",context:this,requireAuth:!0},t))}}};r.default=b}}]);